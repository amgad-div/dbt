[0m00:49:52.956909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F84AEED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F852A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F84AE7D0>]}


============================== 00:49:52.960910 | f40fae7f-484b-4d37-b805-ad5016ef0f2c ==============================
[0m00:49:52.960910 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:49:52.961909 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m00:49:52.979007 [info ] [MainThread]: dbt version: 1.11.2
[0m00:49:52.980009 [info ] [MainThread]: python version: 3.11.9
[0m00:49:52.981009 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:49:52.982007 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m00:49:52.985007 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m00:49:52.986007 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m00:49:52.987013 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m00:49:53.086443 [info ] [MainThread]: Configuration:
[0m00:49:53.087450 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:49:53.088456 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:49:53.089442 [info ] [MainThread]: Required dependencies:
[0m00:49:53.090442 [debug] [MainThread]: Executing "git --help"
[0m00:49:53.129501 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:49:53.130498 [debug] [MainThread]: STDERR: "b''"
[0m00:49:53.131498 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:49:53.131498 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:49:53.132501 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:49:53.133498 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbt_train'


[0m00:49:53.134498 [debug] [MainThread]: Command `dbt debug` failed at 00:49:53.134498 after 0.29 seconds
[0m00:49:53.135499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F8546E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F8544D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F4061350>]}
[0m00:49:53.135499 [debug] [MainThread]: Flushing usage events
[0m00:49:53.793202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:05.554005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015047AAE2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015047AADB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015047AAE3D0>]}


============================== 00:51:05.557047 | 1ac2f86b-1166-4f39-a032-d5954d597cca ==============================
[0m00:51:05.557047 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:51:05.559049 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt debug', 'printer_width': '80', 'target_path': 'None'}
[0m00:51:05.574848 [info ] [MainThread]: dbt version: 1.11.2
[0m00:51:05.575856 [info ] [MainThread]: python version: 3.11.9
[0m00:51:05.576859 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:51:05.577893 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m00:51:05.606426 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m00:51:05.607426 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m00:51:05.608427 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m00:51:05.710709 [info ] [MainThread]: Configuration:
[0m00:51:05.711719 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:51:05.712719 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:51:05.712719 [info ] [MainThread]: Required dependencies:
[0m00:51:05.713718 [debug] [MainThread]: Executing "git --help"
[0m00:51:05.754748 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:51:05.755791 [debug] [MainThread]: STDERR: "b''"
[0m00:51:05.755791 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:51:05.756880 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:51:05.756880 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:51:05.757878 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_train", target "dev" invalid: Runtime Error
    Got duplicate keys: (pass) all map to "password"


[0m00:51:05.759878 [debug] [MainThread]: Command `dbt debug` failed at 00:51:05.758878 after 0.33 seconds
[0m00:51:05.759878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150416682D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015041668310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015045AFFA10>]}
[0m00:51:05.760880 [debug] [MainThread]: Flushing usage events
[0m00:51:06.459477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:25.707183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E30ACE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E1E35690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E1E35810>]}


============================== 00:51:25.711192 | ad0f2230-7458-475e-a579-c278057080f9 ==============================
[0m00:51:25.711192 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:51:25.713209 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m00:51:25.729830 [info ] [MainThread]: dbt version: 1.11.2
[0m00:51:25.730828 [info ] [MainThread]: python version: 3.11.9
[0m00:51:25.730828 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:51:25.732281 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m00:51:25.762621 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m00:51:25.763669 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m00:51:25.764193 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m00:51:25.867792 [info ] [MainThread]: Configuration:
[0m00:51:25.868792 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:51:25.869792 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:51:25.870793 [info ] [MainThread]: Required dependencies:
[0m00:51:25.871791 [debug] [MainThread]: Executing "git --help"
[0m00:51:25.909724 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:51:25.909724 [debug] [MainThread]: STDERR: "b''"
[0m00:51:25.910726 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:51:25.910726 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:51:25.911725 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:51:25.912725 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_train", target "dev" invalid: Runtime Error
    Got duplicate keys: (pass) all map to "password"


[0m00:51:25.913724 [debug] [MainThread]: Command `dbt debug` failed at 00:51:25.913724 after 0.31 seconds
[0m00:51:25.914732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E3281410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E3283410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E31EE6D0>]}
[0m00:51:25.914732 [debug] [MainThread]: Flushing usage events
[0m00:51:26.517012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:52:27.991646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203047AE890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020304447210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203047F88D0>]}


============================== 00:52:27.995914 | f3b0d980-00e9-4bfa-95b8-be7db5432b89 ==============================
[0m00:52:27.995914 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:52:27.995914 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m00:52:28.013178 [info ] [MainThread]: dbt version: 1.11.2
[0m00:52:28.014172 [info ] [MainThread]: python version: 3.11.9
[0m00:52:28.014172 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m00:52:28.015656 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m00:52:28.061676 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m00:52:28.063087 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m00:52:28.064102 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m00:52:28.065101 [info ] [MainThread]: adapter type: postgres
[0m00:52:28.066101 [info ] [MainThread]: adapter version: 1.10.0
[0m00:52:28.169026 [info ] [MainThread]: Configuration:
[0m00:52:28.170028 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:52:28.171183 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:52:28.171183 [info ] [MainThread]: Required dependencies:
[0m00:52:28.172616 [debug] [MainThread]: Executing "git --help"
[0m00:52:28.215024 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:52:28.216026 [debug] [MainThread]: STDERR: "b''"
[0m00:52:28.217027 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:52:28.218028 [info ] [MainThread]: Connection:
[0m00:52:28.218028 [info ] [MainThread]:   host: localhost
[0m00:52:28.219407 [info ] [MainThread]:   port: 5432
[0m00:52:28.219407 [info ] [MainThread]:   user: amgad
[0m00:52:28.220408 [info ] [MainThread]:   database: web_scraper
[0m00:52:28.220408 [info ] [MainThread]:   schema: books
[0m00:52:28.221552 [info ] [MainThread]:   connect_timeout: 10
[0m00:52:28.222705 [info ] [MainThread]:   role: None
[0m00:52:28.222705 [info ] [MainThread]:   search_path: None
[0m00:52:28.223706 [info ] [MainThread]:   keepalives_idle: 0
[0m00:52:28.223706 [info ] [MainThread]:   sslmode: None
[0m00:52:28.224706 [info ] [MainThread]:   sslcert: None
[0m00:52:28.224706 [info ] [MainThread]:   sslkey: None
[0m00:52:28.225707 [info ] [MainThread]:   sslrootcert: None
[0m00:52:28.226710 [info ] [MainThread]:   application_name: dbt
[0m00:52:28.226710 [info ] [MainThread]:   retries: 1
[0m00:52:28.227704 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:52:28.589776 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:52:28.671044 [debug] [MainThread]: Using postgres connection "debug"
[0m00:52:28.671044 [debug] [MainThread]: On debug: select 1 as id
[0m00:52:28.672044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:52:28.722827 [debug] [MainThread]: SQL status: SELECT 1 in 0.050 seconds
[0m00:52:28.723828 [debug] [MainThread]: On debug: Close
[0m00:52:28.723828 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:52:28.724829 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:52:28.727198 [debug] [MainThread]: Command `dbt debug` succeeded at 00:52:28.727198 after 0.84 seconds
[0m00:52:28.727198 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:52:28.728194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030482BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020302907490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037BFB8610>]}
[0m00:52:28.728194 [debug] [MainThread]: Flushing usage events
[0m00:52:29.433343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:54:51.734801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015910CAC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015910CAC210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015910CAF1D0>]}


============================== 00:54:51.738813 | 0b07a106-22eb-404b-a6b6-81e351699025 ==============================
[0m00:54:51.738813 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:54:51.739823 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m00:54:52.124762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b07a106-22eb-404b-a6b6-81e351699025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015910CAFDD0>]}
[0m00:54:52.187278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b07a106-22eb-404b-a6b6-81e351699025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001590B8DC450>]}
[0m00:54:52.189286 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:54:52.580786 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:54:52.581778 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:54:52.582778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b07a106-22eb-404b-a6b6-81e351699025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015910CACF10>]}
[0m00:54:55.580700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b07a106-22eb-404b-a6b6-81e351699025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015912416150>]}
[0m00:54:55.640317 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m00:54:55.648510 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m00:54:55.751972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b07a106-22eb-404b-a6b6-81e351699025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015912816950>]}
[0m00:54:55.753487 [info ] [MainThread]: Found 2 models, 4 data tests, 463 macros
[0m00:54:55.753487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b07a106-22eb-404b-a6b6-81e351699025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015912823550>]}
[0m00:54:55.755608 [info ] [MainThread]: 
[0m00:54:55.756616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:54:55.757624 [info ] [MainThread]: 
[0m00:54:55.758622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:54:55.761634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m00:54:55.847165 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m00:54:55.848164 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m00:54:55.848164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:55.902318 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.055 seconds
[0m00:54:55.904515 [debug] [ThreadPool]: On list_web_scraper: Close
[0m00:54:55.905516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_books)
[0m00:54:55.905516 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books"
"
[0m00:54:55.910605 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books"
[0m00:54:55.910605 [debug] [ThreadPool]: On create_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books"} */
create schema if not exists "books"
[0m00:54:55.910605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:55.963583 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.053 seconds
[0m00:54:55.964582 [debug] [ThreadPool]: On create_web_scraper_books: COMMIT
[0m00:54:55.965582 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books"
[0m00:54:55.965582 [debug] [ThreadPool]: On create_web_scraper_books: COMMIT
[0m00:54:55.966590 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m00:54:55.966590 [debug] [ThreadPool]: On create_web_scraper_books: Close
[0m00:54:55.968595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m00:54:55.973095 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m00:54:55.974102 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m00:54:55.974102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:56.027102 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.053 seconds
[0m00:54:56.028102 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m00:54:56.029112 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m00:54:56.033105 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:56.033105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:54:56.034117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:54:56.084949 [debug] [MainThread]: SQL status: SELECT 0 in 0.051 seconds
[0m00:54:56.086953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b07a106-22eb-404b-a6b6-81e351699025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015912823FD0>]}
[0m00:54:56.086953 [debug] [MainThread]: On master: ROLLBACK
[0m00:54:56.087958 [debug] [MainThread]: On master: COMMIT
[0m00:54:56.088947 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:56.088947 [debug] [MainThread]: On master: COMMIT
[0m00:54:56.089954 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:54:56.089954 [debug] [MainThread]: On master: Close
[0m00:54:56.128030 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m00:54:56.129037 [info ] [Thread-1 (]: 1 of 2 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m00:54:56.129748 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.my_first_dbt_model'
[0m00:54:56.130975 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m00:54:56.136980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m00:54:56.138976 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m00:54:56.166403 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m00:54:56.168791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m00:54:56.169794 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m00:54:56.169794 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:54:56.227949 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.058 seconds
[0m00:54:56.235279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m00:54:56.236278 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m00:54:56.237284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:56.249279 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m00:54:56.250278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m00:54:56.250278 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m00:54:56.252279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:54:56.257279 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m00:54:56.261289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m00:54:56.261289 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m00:54:56.262284 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m00:54:56.264283 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m00:54:56.274804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b07a106-22eb-404b-a6b6-81e351699025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015912B4F890>]}
[0m00:54:56.276099 [info ] [Thread-1 (]: 1 of 2 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.14s]
[0m00:54:56.276099 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m00:54:56.278126 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m00:54:56.278126 [info ] [Thread-1 (]: 2 of 2 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m00:54:56.279128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.my_second_dbt_model)
[0m00:54:56.280138 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m00:54:56.282397 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m00:54:56.283390 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m00:54:56.297391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m00:54:56.299391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m00:54:56.299391 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m00:54:56.299391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:56.356737 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.056 seconds
[0m00:54:56.359823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m00:54:56.359823 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m00:54:56.360818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:56.361818 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m00:54:56.362818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m00:54:56.362818 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m00:54:56.363828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:54:56.365938 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m00:54:56.368932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m00:54:56.368932 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m00:54:56.370071 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:54:56.371094 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m00:54:56.372095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b07a106-22eb-404b-a6b6-81e351699025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015912B97110>]}
[0m00:54:56.372095 [info ] [Thread-1 (]: 2 of 2 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m00:54:56.373095 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m00:54:56.375131 [debug] [MainThread]: On master: COMMIT
[0m00:54:56.375131 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:56.375131 [debug] [MainThread]: On master: COMMIT
[0m00:54:56.376128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:54:56.422973 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m00:54:56.423974 [debug] [MainThread]: On master: Close
[0m00:54:56.424977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:56.424977 [debug] [MainThread]: Connection 'create_web_scraper_books' was properly closed.
[0m00:54:56.424977 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m00:54:56.425977 [debug] [MainThread]: Connection 'model.dbt_train.my_second_dbt_model' was properly closed.
[0m00:54:56.425977 [info ] [MainThread]: 
[0m00:54:56.426979 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m00:54:56.427982 [debug] [MainThread]: Command end result
[0m00:54:56.512153 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m00:54:56.515147 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m00:54:56.522319 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m00:54:56.522319 [info ] [MainThread]: 
[0m00:54:56.523322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:54:56.524454 [info ] [MainThread]: 
[0m00:54:56.525463 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m00:54:56.526490 [debug] [MainThread]: Command `dbt run` succeeded at 00:54:56.526490 after 4.88 seconds
[0m00:54:56.526490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001590A8C8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001590A8C8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001590A8C82D0>]}
[0m00:54:56.527489 [debug] [MainThread]: Flushing usage events
[0m00:54:57.240482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:23.855659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE34AFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE34AE210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE34AE390>]}


============================== 01:00:23.859657 | 8d1d96c2-a6c5-478f-99e1-5ce25772a11b ==============================
[0m01:00:23.859657 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:00:23.860657 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m01:00:24.090087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d1d96c2-a6c5-478f-99e1-5ce25772a11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDF080B50>]}
[0m01:00:24.153592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d1d96c2-a6c5-478f-99e1-5ce25772a11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDF0EDA10>]}
[0m01:00:24.154597 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:00:24.504989 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:00:24.669554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:00:24.670552 [debug] [MainThread]: Partial parsing: added file: dbt_train://models\example\available_quantity.sql
[0m01:00:24.967214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d1d96c2-a6c5-478f-99e1-5ce25772a11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE3CEF450>]}
[0m01:00:25.023219 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:00:25.026223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:00:25.046393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d1d96c2-a6c5-478f-99e1-5ce25772a11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE3B04850>]}
[0m01:00:25.047569 [info ] [MainThread]: Found 3 models, 4 data tests, 463 macros
[0m01:00:25.048569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d1d96c2-a6c5-478f-99e1-5ce25772a11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE3A04C50>]}
[0m01:00:25.050572 [info ] [MainThread]: 
[0m01:00:25.051572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:00:25.051572 [info ] [MainThread]: 
[0m01:00:25.052572 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:25.056603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m01:00:25.145122 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m01:00:25.145122 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m01:00:25.146119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:25.199073 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.053 seconds
[0m01:00:25.200567 [debug] [ThreadPool]: On list_web_scraper: Close
[0m01:00:25.201567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m01:00:25.207121 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m01:00:25.207121 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m01:00:25.208124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:25.258504 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.051 seconds
[0m01:00:25.260494 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m01:00:25.261499 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m01:00:25.266492 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:25.266492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:00:25.267490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:25.315971 [debug] [MainThread]: SQL status: SELECT 1 in 0.048 seconds
[0m01:00:25.317590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d1d96c2-a6c5-478f-99e1-5ce25772a11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE3AFDB10>]}
[0m01:00:25.317590 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:25.318602 [debug] [MainThread]: On master: COMMIT
[0m01:00:25.318602 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:25.320067 [debug] [MainThread]: On master: COMMIT
[0m01:00:25.320067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:25.321086 [debug] [MainThread]: On master: Close
[0m01:00:25.325135 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m01:00:25.325135 [info ] [Thread-1 (]: 1 of 3 START sql view model books.available_quantity ........................... [RUN]
[0m01:00:25.327212 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m01:00:25.327212 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m01:00:25.332276 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m01:00:25.335276 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m01:00:25.361487 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m01:00:25.363487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:00:25.363487 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  create view "web_scraper"."books"."available_quantity__dbt_tmp"
    
    
  as (
    select *
from books
where id = 4011;
  );
[0m01:00:25.364511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:25.409926 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 9: where id = 4011;
                       ^

[0m01:00:25.410929 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: ROLLBACK
[0m01:00:25.411970 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m01:00:25.498590 [debug] [Thread-1 (]: Database Error in model available_quantity (models\example\available_quantity.sql)
  syntax error at or near ";"
  LINE 9: where id = 4011;
                         ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m01:00:25.500590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d1d96c2-a6c5-478f-99e1-5ce25772a11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE3C8A2D0>]}
[0m01:00:25.500590 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model books.available_quantity .................. [[31mERROR[0m in 0.17s]
[0m01:00:25.501591 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m01:00:25.502593 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m01:00:25.502593 [debug] [Thread-4 (]: Marking all children of 'model.dbt_train.available_quantity' to be skipped because of status 'error'.  Reason: Database Error in model available_quantity (models\example\available_quantity.sql)
  syntax error at or near ";"
  LINE 9: where id = 4011;
                         ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql.
[0m01:00:25.503591 [info ] [Thread-1 (]: 2 of 3 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m01:00:25.504592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.my_first_dbt_model)
[0m01:00:25.505592 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m01:00:25.507589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m01:00:25.508591 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m01:00:25.525606 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m01:00:25.526605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:25.526605 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:00:25.527605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:25.576121 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.049 seconds
[0m01:00:25.584122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:25.584122 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:00:25.585122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:25.589118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:25.589118 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:00:25.590116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:25.603124 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m01:00:25.603124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:25.604120 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m01:00:25.605121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:25.612120 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m01:00:25.616127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:25.616127 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m01:00:25.623138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m01:00:25.625138 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m01:00:25.625138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d1d96c2-a6c5-478f-99e1-5ce25772a11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE51D9BD0>]}
[0m01:00:25.626137 [info ] [Thread-1 (]: 2 of 3 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.12s]
[0m01:00:25.627141 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m01:00:25.629136 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m01:00:25.629136 [info ] [Thread-1 (]: 3 of 3 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m01:00:25.630137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.my_second_dbt_model)
[0m01:00:25.630137 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m01:00:25.632660 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m01:00:25.633661 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m01:00:25.637661 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m01:00:25.638657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:00:25.638657 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m01:00:25.638657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:25.690950 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.053 seconds
[0m01:00:25.694464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:00:25.695489 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:00:25.696518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:25.697510 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m01:00:25.698507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:00:25.698507 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m01:00:25.699503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:25.701906 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m01:00:25.703907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:00:25.704906 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m01:00:25.705904 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:00:25.706906 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m01:00:25.706906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d1d96c2-a6c5-478f-99e1-5ce25772a11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE5200A10>]}
[0m01:00:25.708572 [info ] [Thread-1 (]: 3 of 3 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m01:00:25.709592 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m01:00:25.711082 [debug] [MainThread]: On master: COMMIT
[0m01:00:25.711082 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:25.712084 [debug] [MainThread]: On master: COMMIT
[0m01:00:25.712084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:25.757613 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m01:00:25.758991 [debug] [MainThread]: On master: Close
[0m01:00:25.759993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:25.759993 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m01:00:25.760993 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m01:00:25.760993 [debug] [MainThread]: Connection 'model.dbt_train.my_second_dbt_model' was properly closed.
[0m01:00:25.761994 [info ] [MainThread]: 
[0m01:00:25.762990 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m01:00:25.763992 [debug] [MainThread]: Command end result
[0m01:00:25.780989 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:00:25.783990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:00:25.788989 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m01:00:25.788989 [info ] [MainThread]: 
[0m01:00:25.789991 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:00:25.790992 [info ] [MainThread]: 
[0m01:00:25.790992 [error] [MainThread]: [31mFailure in model available_quantity (models\example\available_quantity.sql)[0m
[0m01:00:25.791993 [error] [MainThread]:   Database Error in model available_quantity (models\example\available_quantity.sql)
  syntax error at or near ";"
  LINE 9: where id = 4011;
                         ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m01:00:25.792992 [info ] [MainThread]: 
[0m01:00:25.793992 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\available_quantity.sql
[0m01:00:25.793992 [info ] [MainThread]: 
[0m01:00:25.794990 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m01:00:25.795992 [debug] [MainThread]: Command `dbt run` failed at 01:00:25.795992 after 2.03 seconds
[0m01:00:25.796989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE34AE7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EE1D06950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDD0485D0>]}
[0m01:00:25.796989 [debug] [MainThread]: Flushing usage events
[0m01:00:26.529786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:51.682919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFA6ACF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFA347410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFA347750>]}


============================== 01:00:51.686917 | fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8 ==============================
[0m01:00:51.686917 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:00:51.687926 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt run', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m01:00:51.916415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFA993510>]}
[0m01:00:51.980932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AF62ECD90>]}
[0m01:00:51.981933 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:00:52.325452 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:00:52.476471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:00:52.477476 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\available_quantity.sql
[0m01:00:52.771698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFAE5B6D0>]}
[0m01:00:52.825285 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:00:52.827650 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:00:52.846777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFAE7DD50>]}
[0m01:00:52.847780 [info ] [MainThread]: Found 3 models, 4 data tests, 463 macros
[0m01:00:52.848779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFAD6AF90>]}
[0m01:00:52.850161 [info ] [MainThread]: 
[0m01:00:52.851176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:00:52.852179 [info ] [MainThread]: 
[0m01:00:52.853177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:52.857175 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m01:00:52.943552 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m01:00:52.943552 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m01:00:52.944552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:52.998066 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.054 seconds
[0m01:00:53.000071 [debug] [ThreadPool]: On list_web_scraper: Close
[0m01:00:53.002136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m01:00:53.006128 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m01:00:53.007130 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m01:00:53.007130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:53.060372 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.053 seconds
[0m01:00:53.062377 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m01:00:53.062377 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m01:00:53.068431 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:53.068431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:00:53.069438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:53.123431 [debug] [MainThread]: SQL status: SELECT 1 in 0.054 seconds
[0m01:00:53.125431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFAC36190>]}
[0m01:00:53.125431 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:53.126436 [debug] [MainThread]: On master: COMMIT
[0m01:00:53.126436 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:53.127437 [debug] [MainThread]: On master: COMMIT
[0m01:00:53.127437 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:53.128624 [debug] [MainThread]: On master: Close
[0m01:00:53.132127 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m01:00:53.132127 [info ] [Thread-1 (]: 1 of 3 START sql view model books.available_quantity ........................... [RUN]
[0m01:00:53.133129 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m01:00:53.134129 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m01:00:53.139135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m01:00:53.140135 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m01:00:53.165666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m01:00:53.166663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:00:53.166663 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  create view "web_scraper"."books"."available_quantity__dbt_tmp"
    
    
  as (
    select *
from books
where id = 4011
  );
[0m01:00:53.167665 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:53.221258 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.053 seconds
[0m01:00:53.226256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:00:53.227257 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity__dbt_tmp" rename to "available_quantity"
[0m01:00:53.228262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:53.238262 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m01:00:53.239265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:00:53.239265 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m01:00:53.246463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:00:53.251474 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."available_quantity__dbt_backup"
[0m01:00:53.255474 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:00:53.255474 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
drop view if exists "web_scraper"."books"."available_quantity__dbt_backup" cascade
[0m01:00:53.256485 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:00:53.259636 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m01:00:53.260645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFAE1B650>]}
[0m01:00:53.261642 [info ] [Thread-1 (]: 1 of 3 OK created sql view model books.available_quantity ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m01:00:53.262643 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m01:00:53.263644 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m01:00:53.264642 [info ] [Thread-1 (]: 2 of 3 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m01:00:53.265149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.my_first_dbt_model)
[0m01:00:53.266161 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m01:00:53.268159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m01:00:53.269161 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m01:00:53.285158 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m01:00:53.287161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:53.287161 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:00:53.288287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:53.338036 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.050 seconds
[0m01:00:53.345037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:53.346037 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:00:53.347041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:00:53.349037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:53.350045 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:00:53.351041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:53.353252 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m01:00:53.354266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:53.354266 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m01:00:53.357271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:00:53.360266 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m01:00:53.362265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:00:53.362265 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m01:00:53.366785 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:00:53.368790 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m01:00:53.368790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFAE580D0>]}
[0m01:00:53.369789 [info ] [Thread-1 (]: 2 of 3 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.10s]
[0m01:00:53.371149 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m01:00:53.372155 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m01:00:53.373148 [info ] [Thread-1 (]: 3 of 3 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m01:00:53.373148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.my_second_dbt_model)
[0m01:00:53.374148 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m01:00:53.376147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m01:00:53.377149 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m01:00:53.380148 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m01:00:53.381149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:00:53.382149 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m01:00:53.382149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:53.430459 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m01:00:53.433463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:00:53.433463 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:00:53.434466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:53.436460 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m01:00:53.436460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:00:53.437460 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m01:00:53.438461 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:53.440788 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m01:00:53.441797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:00:53.441797 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m01:00:53.442797 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:00:53.443797 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m01:00:53.444802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb0c4592-4dd7-4211-aeb0-8f1a5c58a3e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFC39B490>]}
[0m01:00:53.445798 [info ] [Thread-1 (]: 3 of 3 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m01:00:53.445798 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m01:00:53.448025 [debug] [MainThread]: On master: COMMIT
[0m01:00:53.449018 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:53.449018 [debug] [MainThread]: On master: COMMIT
[0m01:00:53.449018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:53.492809 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m01:00:53.493809 [debug] [MainThread]: On master: Close
[0m01:00:53.494814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:53.494814 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m01:00:53.494814 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m01:00:53.495812 [debug] [MainThread]: Connection 'model.dbt_train.my_second_dbt_model' was properly closed.
[0m01:00:53.495812 [info ] [MainThread]: 
[0m01:00:53.496812 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m01:00:53.497816 [debug] [MainThread]: Command end result
[0m01:00:53.515869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:00:53.517862 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:00:53.523864 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m01:00:53.523864 [info ] [MainThread]: 
[0m01:00:53.524864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:53.524864 [info ] [MainThread]: 
[0m01:00:53.525865 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:00:53.526861 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:53.526861 after 1.93 seconds
[0m01:00:53.526861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFA731150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFA7330D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFA6A2610>]}
[0m01:00:53.527864 [debug] [MainThread]: Flushing usage events
[0m01:00:54.116909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:45.228012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210450AE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210450AE010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210450AD890>]}


============================== 01:02:45.231014 | e4540a3a-2aa6-4ef4-82b0-8b7a605495c5 ==============================
[0m01:02:45.231014 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:02:45.233014 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m01:02:45.462157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4540a3a-2aa6-4ef4-82b0-8b7a605495c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104515D390>]}
[0m01:02:45.525674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4540a3a-2aa6-4ef4-82b0-8b7a605495c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103FCECE10>]}
[0m01:02:45.527676 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:02:45.867884 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:02:46.005795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:46.005795 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:02:46.006799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:46.036914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4540a3a-2aa6-4ef4-82b0-8b7a605495c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210457561D0>]}
[0m01:02:46.092417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:02:46.095420 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:02:46.150696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4540a3a-2aa6-4ef4-82b0-8b7a605495c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021045987E90>]}
[0m01:02:46.151694 [info ] [MainThread]: Found 3 models, 4 data tests, 463 macros
[0m01:02:46.151694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4540a3a-2aa6-4ef4-82b0-8b7a605495c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210452A42D0>]}
[0m01:02:46.153693 [info ] [MainThread]: 
[0m01:02:46.154695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:46.155706 [info ] [MainThread]: 
[0m01:02:46.156710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:46.159711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m01:02:46.306070 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m01:02:46.306070 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m01:02:46.307066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:46.361871 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.055 seconds
[0m01:02:46.362871 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m01:02:46.363874 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m01:02:46.368505 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:46.368505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:46.369515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:46.422269 [debug] [MainThread]: SQL status: SELECT 2 in 0.053 seconds
[0m01:02:46.424269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4540a3a-2aa6-4ef4-82b0-8b7a605495c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104206ECD0>]}
[0m01:02:46.425268 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:46.425268 [debug] [MainThread]: On master: COMMIT
[0m01:02:46.426268 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:46.427267 [debug] [MainThread]: On master: COMMIT
[0m01:02:46.427267 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:46.428268 [debug] [MainThread]: On master: Close
[0m01:02:46.431270 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:02:46.432267 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m01:02:46.433269 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710'
[0m01:02:46.434267 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:02:46.447745 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:02:46.449747 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:02:46.462852 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:02:46.465856 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:02:46.467177 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."books"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.467177 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:46.516734 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.049 seconds
[0m01:02:46.520738 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m01:02:46.521735 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m01:02:46.521735 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.09s]
[0m01:02:46.523734 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:02:46.524734 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m01:02:46.524734 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m01:02:46.525734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_train.not_null_my_second_dbt_model_id.151b76d778)
[0m01:02:46.526734 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m01:02:46.529811 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m01:02:46.533117 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m01:02:46.535507 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m01:02:46.536501 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m01:02:46.537515 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."books"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.537515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.584793 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m01:02:46.586793 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m01:02:46.586793 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: Close
[0m01:02:46.588795 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
[0m01:02:46.589794 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m01:02:46.590794 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m01:02:46.590794 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m01:02:46.591800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_train.unique_my_first_dbt_model_id.16e066b321)
[0m01:02:46.591800 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m01:02:46.597793 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m01:02:46.601302 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m01:02:46.604303 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m01:02:46.606301 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m01:02:46.607302 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."books"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:46.607302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.649519 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.042 seconds
[0m01:02:46.651520 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m01:02:46.651520 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: Close
[0m01:02:46.652520 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
[0m01:02:46.653519 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m01:02:46.653519 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m01:02:46.654521 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m01:02:46.655520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_my_first_dbt_model_id.16e066b321, now test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493)
[0m01:02:46.656526 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m01:02:46.660562 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m01:02:46.661574 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m01:02:46.663603 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m01:02:46.664630 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m01:02:46.665645 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."books"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:46.665645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.713254 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m01:02:46.715446 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m01:02:46.716485 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m01:02:46.717917 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
[0m01:02:46.719256 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m01:02:46.720259 [debug] [MainThread]: On master: COMMIT
[0m01:02:46.720259 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:46.721255 [debug] [MainThread]: On master: COMMIT
[0m01:02:46.721255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:46.764602 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m01:02:46.765798 [debug] [MainThread]: On master: Close
[0m01:02:46.766303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:46.766303 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m01:02:46.767310 [debug] [MainThread]: Connection 'test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m01:02:46.767310 [info ] [MainThread]: 
[0m01:02:46.768309 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m01:02:46.770312 [debug] [MainThread]: Command end result
[0m01:02:46.787360 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:02:46.789370 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:02:46.795464 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m01:02:46.795464 [info ] [MainThread]: 
[0m01:02:46.796953 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:02:46.796953 [info ] [MainThread]: 
[0m01:02:46.798356 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m01:02:46.798356 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m01:02:46.799361 [info ] [MainThread]: 
[0m01:02:46.800363 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m01:02:46.801363 [info ] [MainThread]: 
[0m01:02:46.801363 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:02:46.803362 [debug] [MainThread]: Command `dbt test` failed at 01:02:46.802368 after 1.67 seconds
[0m01:02:46.803362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103ECD81D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210450A3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210450A34D0>]}
[0m01:02:46.804361 [debug] [MainThread]: Flushing usage events
[0m01:02:47.529145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:07:13.518381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A0A2F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A0F5ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A0F6110>]}


============================== 01:07:13.521888 | 1adc0362-b3ad-4df9-be72-8b9d955b91fc ==============================
[0m01:07:13.521888 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:07:13.522897 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m01:07:13.754355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1adc0362-b3ad-4df9-be72-8b9d955b91fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A2BE1D0>]}
[0m01:07:13.818364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1adc0362-b3ad-4df9-be72-8b9d955b91fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018034D1C850>]}
[0m01:07:13.819363 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:07:14.160496 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:07:14.276025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:07:14.276025 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\available_quantity.sql
[0m01:07:14.569590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1adc0362-b3ad-4df9-be72-8b9d955b91fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A752D90>]}
[0m01:07:14.624108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:07:14.627114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:07:14.647110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1adc0362-b3ad-4df9-be72-8b9d955b91fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A75C450>]}
[0m01:07:14.648526 [info ] [MainThread]: Found 3 models, 4 data tests, 463 macros
[0m01:07:14.648526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1adc0362-b3ad-4df9-be72-8b9d955b91fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A3F0D90>]}
[0m01:07:14.651532 [info ] [MainThread]: 
[0m01:07:14.651532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:07:14.652533 [info ] [MainThread]: 
[0m01:07:14.653725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:07:14.657989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m01:07:14.743507 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m01:07:14.744510 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m01:07:14.744510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:14.795775 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.051 seconds
[0m01:07:14.796774 [debug] [ThreadPool]: On list_web_scraper: Close
[0m01:07:14.798787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m01:07:14.804319 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m01:07:14.804825 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m01:07:14.804825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:14.857419 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.052 seconds
[0m01:07:14.858434 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m01:07:14.859436 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m01:07:14.864435 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:14.865438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:07:14.865438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:07:14.916289 [debug] [MainThread]: SQL status: SELECT 2 in 0.050 seconds
[0m01:07:14.917289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1adc0362-b3ad-4df9-be72-8b9d955b91fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A2AE7D0>]}
[0m01:07:14.918291 [debug] [MainThread]: On master: ROLLBACK
[0m01:07:14.919290 [debug] [MainThread]: On master: COMMIT
[0m01:07:14.919290 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:14.920289 [debug] [MainThread]: On master: COMMIT
[0m01:07:14.920289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:07:14.921288 [debug] [MainThread]: On master: Close
[0m01:07:14.925817 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m01:07:14.926812 [info ] [Thread-1 (]: 1 of 3 START sql table model books.available_quantity .......................... [RUN]
[0m01:07:14.927817 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m01:07:14.928813 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m01:07:14.933968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m01:07:14.934967 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m01:07:14.964000 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m01:07:14.965007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:07:14.965007 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    


select *
from books
where id = 4011
  );
  
[0m01:07:14.966000 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:07:15.025517 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.060 seconds
[0m01:07:15.033514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:07:15.033514 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity" rename to "available_quantity__dbt_backup"
[0m01:07:15.035515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:15.037517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:07:15.037517 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity__dbt_tmp" rename to "available_quantity"
[0m01:07:15.039516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:15.051515 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m01:07:15.051515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:07:15.052519 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m01:07:15.053515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:07:15.059515 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."available_quantity__dbt_backup"
[0m01:07:15.063515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:07:15.063515 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
drop view if exists "web_scraper"."books"."available_quantity__dbt_backup" cascade
[0m01:07:15.066515 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:07:15.068516 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m01:07:15.070515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1adc0362-b3ad-4df9-be72-8b9d955b91fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A81F090>]}
[0m01:07:15.071562 [info ] [Thread-1 (]: 1 of 3 OK created sql table model books.available_quantity ..................... [[32mSELECT 1[0m in 0.14s]
[0m01:07:15.072561 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m01:07:15.072561 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m01:07:15.072561 [info ] [Thread-1 (]: 2 of 3 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m01:07:15.073954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.my_first_dbt_model)
[0m01:07:15.073954 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m01:07:15.077008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m01:07:15.078037 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m01:07:15.082038 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m01:07:15.083040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:07:15.084040 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:07:15.084040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:15.134636 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.050 seconds
[0m01:07:15.138805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:07:15.139330 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:07:15.140437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:15.142691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:07:15.143222 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:07:15.144284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:07:15.145343 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m01:07:15.145343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:07:15.146353 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m01:07:15.149350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:07:15.152351 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m01:07:15.154351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m01:07:15.155354 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m01:07:15.158814 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:07:15.159874 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m01:07:15.160873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1adc0362-b3ad-4df9-be72-8b9d955b91fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A8B3350>]}
[0m01:07:15.160873 [info ] [Thread-1 (]: 2 of 3 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.09s]
[0m01:07:15.162263 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m01:07:15.163392 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m01:07:15.164413 [info ] [Thread-1 (]: 3 of 3 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m01:07:15.164413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.my_second_dbt_model)
[0m01:07:15.165412 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m01:07:15.167671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m01:07:15.168705 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m01:07:15.183722 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m01:07:15.185726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:07:15.185726 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m01:07:15.185726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:15.235537 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m01:07:15.239619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:07:15.239619 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:07:15.240719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:15.242190 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m01:07:15.242190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:07:15.243703 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m01:07:15.244714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:07:15.248109 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m01:07:15.248109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m01:07:15.249107 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m01:07:15.250130 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:07:15.252170 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m01:07:15.252170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1adc0362-b3ad-4df9-be72-8b9d955b91fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803AD71310>]}
[0m01:07:15.253169 [info ] [Thread-1 (]: 3 of 3 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m01:07:15.254175 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m01:07:15.255679 [debug] [MainThread]: On master: COMMIT
[0m01:07:15.255679 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:15.256801 [debug] [MainThread]: On master: COMMIT
[0m01:07:15.256801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:07:15.297804 [debug] [MainThread]: SQL status: COMMIT in 0.041 seconds
[0m01:07:15.298802 [debug] [MainThread]: On master: Close
[0m01:07:15.298802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:15.299802 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m01:07:15.299802 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m01:07:15.300802 [debug] [MainThread]: Connection 'model.dbt_train.my_second_dbt_model' was properly closed.
[0m01:07:15.300802 [info ] [MainThread]: 
[0m01:07:15.301802 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m01:07:15.303225 [debug] [MainThread]: Command end result
[0m01:07:15.320499 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:07:15.323012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:07:15.328316 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m01:07:15.329310 [info ] [MainThread]: 
[0m01:07:15.329310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:07:15.330315 [info ] [MainThread]: 
[0m01:07:15.330315 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:07:15.332312 [debug] [MainThread]: Command `dbt run` succeeded at 01:07:15.332312 after 1.90 seconds
[0m01:07:15.332312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A1330D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018038234910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A131110>]}
[0m01:07:15.333312 [debug] [MainThread]: Flushing usage events
[0m01:07:16.047007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:09:02.306748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B5CA2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B5CF5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B5CF4850>]}


============================== 01:09:02.310749 | ef338659-44fd-45d9-a6a2-61aa4d879561 ==============================
[0m01:09:02.310749 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:09:02.311755 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt run --select available_quantity', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m01:09:02.540037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef338659-44fd-45d9-a6a2-61aa4d879561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B5E9C890>]}
[0m01:09:02.604889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef338659-44fd-45d9-a6a2-61aa4d879561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B084CB50>]}
[0m01:09:02.605888 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:09:02.948368 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:09:03.081952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:09:03.081952 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:09:03.082952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:09:03.111946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef338659-44fd-45d9-a6a2-61aa4d879561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B72FCD10>]}
[0m01:09:03.166960 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:09:03.169959 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:09:03.189486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef338659-44fd-45d9-a6a2-61aa4d879561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B5E9D810>]}
[0m01:09:03.190635 [info ] [MainThread]: Found 3 models, 4 data tests, 463 macros
[0m01:09:03.190635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef338659-44fd-45d9-a6a2-61aa4d879561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B5D27B50>]}
[0m01:09:03.191645 [info ] [MainThread]: 
[0m01:09:03.192643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:09:03.193644 [info ] [MainThread]: 
[0m01:09:03.193644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:09:03.194995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m01:09:03.336863 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m01:09:03.336863 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m01:09:03.338359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:03.387258 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.049 seconds
[0m01:09:03.388261 [debug] [ThreadPool]: On list_web_scraper: Close
[0m01:09:03.392388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m01:09:03.397381 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m01:09:03.397381 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m01:09:03.398390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:03.452110 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.054 seconds
[0m01:09:03.453109 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m01:09:03.454114 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m01:09:03.459110 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:03.460110 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:09:03.460110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:09:03.513589 [debug] [MainThread]: SQL status: SELECT 1 in 0.053 seconds
[0m01:09:03.515589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef338659-44fd-45d9-a6a2-61aa4d879561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B563C4D0>]}
[0m01:09:03.516589 [debug] [MainThread]: On master: ROLLBACK
[0m01:09:03.516589 [debug] [MainThread]: On master: COMMIT
[0m01:09:03.517594 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:03.517594 [debug] [MainThread]: On master: COMMIT
[0m01:09:03.518588 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:09:03.518588 [debug] [MainThread]: On master: Close
[0m01:09:03.523234 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m01:09:03.524246 [info ] [Thread-1 (]: 1 of 1 START sql table model books.available_quantity .......................... [RUN]
[0m01:09:03.525261 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m01:09:03.526281 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m01:09:03.532278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m01:09:03.533281 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m01:09:03.561783 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m01:09:03.562781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:09:03.562781 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    


select *
from books
where id = 4011
  );
  
[0m01:09:03.563907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:09:03.624879 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.062 seconds
[0m01:09:03.632879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:09:03.633879 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity" rename to "available_quantity__dbt_backup"
[0m01:09:03.634879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:09:03.636883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:09:03.637880 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity__dbt_tmp" rename to "available_quantity"
[0m01:09:03.638879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:09:03.651075 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m01:09:03.652075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:09:03.652075 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m01:09:03.654070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:09:03.659070 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."available_quantity__dbt_backup"
[0m01:09:03.663192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m01:09:03.663192 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
drop table if exists "web_scraper"."books"."available_quantity__dbt_backup" cascade
[0m01:09:03.669222 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:09:03.671222 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m01:09:03.673222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef338659-44fd-45d9-a6a2-61aa4d879561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B7710F90>]}
[0m01:09:03.674222 [info ] [Thread-1 (]: 1 of 1 OK created sql table model books.available_quantity ..................... [[32mSELECT 1[0m in 0.15s]
[0m01:09:03.675225 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m01:09:03.676224 [debug] [MainThread]: On master: COMMIT
[0m01:09:03.676224 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:03.677223 [debug] [MainThread]: On master: COMMIT
[0m01:09:03.677223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:09:03.721228 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m01:09:03.722223 [debug] [MainThread]: On master: Close
[0m01:09:03.722223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:03.722223 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m01:09:03.723228 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m01:09:03.723228 [debug] [MainThread]: Connection 'model.dbt_train.available_quantity' was properly closed.
[0m01:09:03.723228 [info ] [MainThread]: 
[0m01:09:03.724433 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m01:09:03.725706 [debug] [MainThread]: Command end result
[0m01:09:03.743100 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:09:03.745093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:09:03.750118 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m01:09:03.751124 [info ] [MainThread]: 
[0m01:09:03.752119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:09:03.753119 [info ] [MainThread]: 
[0m01:09:03.753119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:09:03.755270 [debug] [MainThread]: Command `dbt run` succeeded at 01:09:03.754119 after 1.54 seconds
[0m01:09:03.755270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B5D44CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B5CF5DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6B71BFF50>]}
[0m01:09:03.756298 [debug] [MainThread]: Flushing usage events
[0m01:09:04.485636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:36:11.574770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB10A2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB11250D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB1127550>]}


============================== 01:36:11.579278 | b85d5998-fc63-4c37-b725-db738fa3391c ==============================
[0m01:36:11.579278 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:36:11.580281 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs generate', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m01:36:11.822785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b85d5998-fc63-4c37-b725-db738fa3391c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB13727D0>]}
[0m01:36:11.887052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b85d5998-fc63-4c37-b725-db738fa3391c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EABCAC950>]}
[0m01:36:11.888051 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:36:12.234454 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:36:12.352938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:36:12.352938 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:36:12.353940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:36:12.383402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b85d5998-fc63-4c37-b725-db738fa3391c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EAFCC8210>]}
[0m01:36:12.446216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b85d5998-fc63-4c37-b725-db738fa3391c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB1623D50>]}
[0m01:36:12.447222 [info ] [MainThread]: Found 3 models, 4 data tests, 463 macros
[0m01:36:12.447222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b85d5998-fc63-4c37-b725-db738fa3391c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB167A0D0>]}
[0m01:36:12.449217 [info ] [MainThread]: 
[0m01:36:12.450239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:36:12.451232 [info ] [MainThread]: 
[0m01:36:12.452229 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:36:12.455232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m01:36:12.574763 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m01:36:12.574763 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m01:36:12.575768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:12.632654 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.057 seconds
[0m01:36:12.633654 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m01:36:12.633654 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m01:36:12.695364 [debug] [MainThread]: Using postgres connection "master"
[0m01:36:12.695364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:36:12.696364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:36:12.750887 [debug] [MainThread]: SQL status: SELECT 1 in 0.054 seconds
[0m01:36:12.751896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b85d5998-fc63-4c37-b725-db738fa3391c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB18A86D0>]}
[0m01:36:12.752896 [debug] [MainThread]: On master: ROLLBACK
[0m01:36:12.753899 [debug] [MainThread]: On master: Close
[0m01:36:12.757898 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m01:36:12.757898 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m01:36:12.758896 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m01:36:12.764896 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m01:36:12.765896 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m01:36:12.765896 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m01:36:12.767240 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m01:36:12.767240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.my_first_dbt_model)
[0m01:36:12.768257 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m01:36:12.770296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m01:36:12.771515 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m01:36:12.771515 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m01:36:12.772666 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m01:36:12.772666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.my_second_dbt_model)
[0m01:36:12.773974 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m01:36:12.775982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m01:36:12.776986 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m01:36:12.777984 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m01:36:12.777984 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:36:12.778983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710)
[0m01:36:12.778983 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:36:12.788043 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:36:12.789043 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:36:12.790046 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:36:12.791044 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m01:36:12.791044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_train.unique_my_first_dbt_model_id.16e066b321)
[0m01:36:12.792055 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m01:36:12.797059 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m01:36:12.798066 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m01:36:12.799062 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m01:36:12.799062 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m01:36:12.800067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_my_first_dbt_model_id.16e066b321, now test.dbt_train.not_null_my_second_dbt_model_id.151b76d778)
[0m01:36:12.800067 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m01:36:12.804059 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m01:36:12.805062 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m01:36:12.805062 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m01:36:12.806061 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m01:36:12.806061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493)
[0m01:36:12.806061 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m01:36:12.810070 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m01:36:12.811067 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m01:36:12.811067 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m01:36:12.812371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:12.813387 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m01:36:12.813387 [debug] [MainThread]: Connection 'test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m01:36:12.814385 [debug] [MainThread]: Command end result
[0m01:36:12.872047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:36:12.875387 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:36:12.880389 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m01:36:13.443202 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m01:36:13.444206 [info ] [MainThread]: Building catalog
[0m01:36:13.451206 [debug] [ThreadPool]: Acquiring new postgres connection 'web_scraper.information_schema'
[0m01:36:13.457526 [debug] [ThreadPool]: Using postgres connection "web_scraper.information_schema"
[0m01:36:13.458530 [debug] [ThreadPool]: On web_scraper.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "web_scraper.information_schema"} */

    
    

    select
        'web_scraper' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('available_quantity')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_second_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m01:36:13.458530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:13.516011 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.057 seconds
[0m01:36:13.518021 [debug] [ThreadPool]: On web_scraper.information_schema: ROLLBACK
[0m01:36:13.518021 [debug] [ThreadPool]: On web_scraper.information_schema: Close
[0m01:36:13.527649 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m01:36:13.544650 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m01:36:13.546751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m01:36:13.547769 [info ] [MainThread]: Catalog written to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m01:36:13.549771 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:36:13.548771 after 2.06 seconds
[0m01:36:13.549771 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:36:13.549771 [debug] [MainThread]: Connection 'web_scraper.information_schema' was properly closed.
[0m01:36:13.550769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EABB5A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EAACD8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EAEFF6750>]}
[0m01:36:13.550769 [debug] [MainThread]: Flushing usage events
[0m01:36:14.274939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:28.791164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184FC4AFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184FC525450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184FC524C10>]}


============================== 01:37:28.795171 | c772c3fd-69ae-410e-82e0-21faea814905 ==============================
[0m01:37:28.795171 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:37:28.796174 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m01:37:29.026157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c772c3fd-69ae-410e-82e0-21faea814905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184FC4F9A10>]}
[0m01:37:29.090669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c772c3fd-69ae-410e-82e0-21faea814905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184F80ECC90>]}
[0m02:29:33.428823 [error] [MainThread]: Encountered an error:

[0m02:29:33.456227 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m02:29:33.461290 [debug] [MainThread]: Command `dbt docs serve` failed at 02:29:33.460288 after 3124.76 seconds
[0m02:29:33.463287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184FC524C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184FC525150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184FC4AF8D0>]}
[0m02:29:33.464286 [debug] [MainThread]: Flushing usage events
[0m02:29:34.231007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:31:09.889157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367A32D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367A32FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367A32F510>]}


============================== 02:31:09.893159 | ea805fd2-f38e-45fb-ba8b-158bf6068440 ==============================
[0m02:31:09.893159 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:31:09.894161 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m02:31:09.913184 [info ] [MainThread]: dbt version: 1.11.2
[0m02:31:09.914189 [info ] [MainThread]: python version: 3.11.9
[0m02:31:09.915186 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m02:31:09.915186 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m02:31:09.962367 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m02:31:09.963369 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m02:31:09.964368 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m02:31:09.966368 [info ] [MainThread]: adapter type: postgres
[0m02:31:09.967454 [info ] [MainThread]: adapter version: 1.10.0
[0m02:31:10.068783 [info ] [MainThread]: Configuration:
[0m02:31:10.069788 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:31:10.070788 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:31:10.071789 [info ] [MainThread]: Required dependencies:
[0m02:31:10.072790 [debug] [MainThread]: Executing "git --help"
[0m02:31:10.112312 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:31:10.113310 [debug] [MainThread]: STDERR: "b''"
[0m02:31:10.113310 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:31:10.114311 [info ] [MainThread]: Connection:
[0m02:31:10.115310 [info ] [MainThread]:   host: localhost
[0m02:31:10.115310 [info ] [MainThread]:   port: 5432
[0m02:31:10.116310 [info ] [MainThread]:   user: amgad
[0m02:31:10.116310 [info ] [MainThread]:   database: web_scraper
[0m02:31:10.117309 [info ] [MainThread]:   schema: books
[0m02:31:10.117309 [info ] [MainThread]:   connect_timeout: 10
[0m02:31:10.118313 [info ] [MainThread]:   role: None
[0m02:31:10.118313 [info ] [MainThread]:   search_path: None
[0m02:31:10.119307 [info ] [MainThread]:   keepalives_idle: 0
[0m02:31:10.120489 [info ] [MainThread]:   sslmode: None
[0m02:31:10.120489 [info ] [MainThread]:   sslcert: None
[0m02:31:10.121490 [info ] [MainThread]:   sslkey: None
[0m02:31:10.121490 [info ] [MainThread]:   sslrootcert: None
[0m02:31:10.122489 [info ] [MainThread]:   application_name: dbt
[0m02:31:10.123490 [info ] [MainThread]:   retries: 1
[0m02:31:10.124558 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:31:10.472047 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m02:31:10.579534 [debug] [MainThread]: Using postgres connection "debug"
[0m02:31:10.580541 [debug] [MainThread]: On debug: select 1 as id
[0m02:31:10.580541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:31:10.630048 [debug] [MainThread]: SQL status: SELECT 1 in 0.050 seconds
[0m02:31:10.631373 [debug] [MainThread]: On debug: Close
[0m02:31:10.632412 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:31:10.633409 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:31:10.634490 [debug] [MainThread]: Command `dbt debug` succeeded at 02:31:10.634490 after 0.86 seconds
[0m02:31:10.635504 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:31:10.635504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367A346B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367A75D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367A578A90>]}
[0m02:31:10.636553 [debug] [MainThread]: Flushing usage events
[0m02:31:11.318387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:31:37.166265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE21AD950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE0E956D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE2227DD0>]}


============================== 02:31:37.170275 | d9cf089f-264c-446c-8a22-4db42d526780 ==============================
[0m02:31:37.170275 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:31:37.171276 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m02:31:37.422407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE239CA50>]}
[0m02:31:37.489808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFDCD9D990>]}
[0m02:31:37.490811 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:31:37.837615 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:31:37.908061 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:31:37.909075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE02B1D90>]}
[0m02:31:38.996980 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'stg_books' in
package 'dbt_train' (models\staging\stg_books.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m02:31:38.997993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE2C15690>]}
[0m02:31:39.100630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_books.marts
- models.dbt_books.staging
[0m02:31:39.108639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE270A350>]}
[0m02:31:39.172770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:31:39.174924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:31:39.198156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE2CBC450>]}
[0m02:31:39.198156 [info ] [MainThread]: Found 6 models, 7 data tests, 1 source, 463 macros
[0m02:31:39.199165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE2DC4710>]}
[0m02:31:39.202153 [info ] [MainThread]: 
[0m02:31:39.202153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:31:39.203157 [info ] [MainThread]: 
[0m02:31:39.203157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:31:39.208163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m02:31:39.294034 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m02:31:39.294034 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m02:31:39.295033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:39.348039 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.053 seconds
[0m02:31:39.350036 [debug] [ThreadPool]: On list_web_scraper: Close
[0m02:31:39.352078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m02:31:39.357077 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m02:31:39.357077 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m02:31:39.358079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:39.414056 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.056 seconds
[0m02:31:39.416055 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m02:31:39.416055 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m02:31:39.421064 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:39.421064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:31:39.422296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:31:39.475775 [debug] [MainThread]: SQL status: SELECT 1 in 0.054 seconds
[0m02:31:39.477779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE41C0A10>]}
[0m02:31:39.478775 [debug] [MainThread]: On master: ROLLBACK
[0m02:31:39.478775 [debug] [MainThread]: On master: COMMIT
[0m02:31:39.480089 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:39.480089 [debug] [MainThread]: On master: COMMIT
[0m02:31:39.481140 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:31:39.481140 [debug] [MainThread]: On master: Close
[0m02:31:39.486153 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m02:31:39.486153 [info ] [Thread-1 (]: 1 of 6 START sql table model books.available_quantity .......................... [RUN]
[0m02:31:39.487154 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m02:31:39.488154 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m02:31:39.494410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m02:31:39.495412 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m02:31:39.523255 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m02:31:39.525262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:31:39.525262 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    


select *
from books
where id = 4011
  );
  
[0m02:31:39.526363 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:31:39.581238 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.055 seconds
[0m02:31:39.590235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:31:39.591238 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity" rename to "available_quantity__dbt_backup"
[0m02:31:39.592241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:39.664526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:31:39.664526 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity__dbt_tmp" rename to "available_quantity"
[0m02:31:39.665523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:39.678527 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m02:31:39.679525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:31:39.679525 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m02:31:39.682523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:31:39.688624 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."available_quantity__dbt_backup"
[0m02:31:39.692095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:31:39.693091 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
drop table if exists "web_scraper"."books"."available_quantity__dbt_backup" cascade
[0m02:31:39.699089 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m02:31:39.702085 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m02:31:39.704090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE2AB5BD0>]}
[0m02:31:39.704090 [info ] [Thread-1 (]: 1 of 6 OK created sql table model books.available_quantity ..................... [[32mSELECT 1[0m in 0.21s]
[0m02:31:39.706099 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m02:31:39.707226 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m02:31:39.708223 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m02:31:39.708223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.my_first_dbt_model)
[0m02:31:39.709223 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m02:31:39.711222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m02:31:39.712221 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m02:31:39.716221 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m02:31:39.717225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:31:39.717225 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m02:31:39.718424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:39.770171 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.052 seconds
[0m02:31:39.774167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:31:39.774167 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:31:39.775174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:39.778167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:31:39.779167 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:31:39.779167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:31:39.781170 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m02:31:39.781170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:31:39.781170 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m02:31:39.784167 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:31:39.787167 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m02:31:39.788167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:31:39.788167 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m02:31:39.793167 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:31:39.794167 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m02:31:39.795167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE2BA44D0>]}
[0m02:31:39.795167 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.09s]
[0m02:31:39.796172 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m02:31:39.797169 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m02:31:39.797169 [info ] [Thread-1 (]: 3 of 6 START sql view model books.stg_books .................................... [RUN]
[0m02:31:39.798608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m02:31:39.798608 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m02:31:39.801788 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m02:31:39.803790 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m02:31:39.818793 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m02:31:39.820298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:31:39.821307 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = 1 then 'One'
        when rating = 2 then 'Two'
        when rating = 3 then 'Three'
        when rating = 4 then 'Four'
        when rating = 5 then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m02:31:39.821307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:39.869897 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: character varying = integer
LINE 12:         when rating = 1 then 'One'
                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m02:31:39.869897 [debug] [Thread-1 (]: On model.dbt_train.stg_books: ROLLBACK
[0m02:31:39.870913 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m02:31:39.876433 [debug] [Thread-1 (]: Database Error in model stg_books (models\staging\stg_books.sql)
  operator does not exist: character varying = integer
  LINE 12:         when rating = 1 then 'One'
                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_train\models\staging\stg_books.sql
[0m02:31:39.877431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFDCFA3B90>]}
[0m02:31:39.877431 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model books.stg_books ........................... [[31mERROR[0m in 0.08s]
[0m02:31:39.878659 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m02:31:39.879661 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m02:31:39.879661 [debug] [Thread-4 (]: Marking all children of 'model.dbt_train.stg_books' to be skipped because of status 'error'.  Reason: Database Error in model stg_books (models\staging\stg_books.sql)
  operator does not exist: character varying = integer
  LINE 12:         when rating = 1 then 'One'
                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_train\models\staging\stg_books.sql.
[0m02:31:39.880655 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m02:31:39.881658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m02:31:39.882652 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m02:31:39.884731 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m02:31:39.885731 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m02:31:39.888731 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m02:31:39.889731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:31:39.890738 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m02:31:39.890738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:39.943264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m02:31:39.946259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:31:39.946259 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:31:39.947260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:31:39.948259 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m02:31:39.949267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:31:39.949267 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m02:31:39.952340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:31:39.955340 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m02:31:39.957342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:31:39.958340 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m02:31:39.959343 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m02:31:39.960347 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m02:31:39.961341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cf089f-264c-446c-8a22-4db42d526780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE277D110>]}
[0m02:31:39.962344 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m02:31:39.962344 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m02:31:39.963342 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m02:31:39.964340 [info ] [Thread-1 (]: 5 of 6 SKIP relation books.dim_books ........................................... [[33mSKIP[0m]
[0m02:31:39.964340 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m02:31:39.964340 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m02:31:39.965625 [info ] [Thread-1 (]: 6 of 6 SKIP relation books.fact_books_inventory ................................ [[33mSKIP[0m]
[0m02:31:39.965625 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m02:31:39.966754 [debug] [MainThread]: On master: COMMIT
[0m02:31:39.968226 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:39.968226 [debug] [MainThread]: On master: COMMIT
[0m02:31:39.968226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:31:40.016421 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m02:31:40.017412 [debug] [MainThread]: On master: Close
[0m02:31:40.018417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:40.018417 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m02:31:40.018417 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m02:31:40.019415 [debug] [MainThread]: Connection 'model.dbt_train.my_second_dbt_model' was properly closed.
[0m02:31:40.019415 [info ] [MainThread]: 
[0m02:31:40.019415 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m02:31:40.021941 [debug] [MainThread]: Command end result
[0m02:31:40.040957 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:31:40.042950 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:31:40.048992 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m02:31:40.048992 [info ] [MainThread]: 
[0m02:31:40.049999 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:31:40.049999 [info ] [MainThread]: 
[0m02:31:40.050995 [error] [MainThread]: [31mFailure in model stg_books (models\staging\stg_books.sql)[0m
[0m02:31:40.051997 [error] [MainThread]:   Database Error in model stg_books (models\staging\stg_books.sql)
  operator does not exist: character varying = integer
  LINE 12:         when rating = 1 then 'One'
                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_train\models\staging\stg_books.sql
[0m02:31:40.051997 [info ] [MainThread]: 
[0m02:31:40.052996 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\staging\stg_books.sql
[0m02:31:40.054002 [info ] [MainThread]: 
[0m02:31:40.054996 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=6
[0m02:31:40.054996 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:31:40.057003 [debug] [MainThread]: Command `dbt run` failed at 02:31:40.057003 after 2.98 seconds
[0m02:31:40.057996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFDBD88290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFDBD885D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE2E3BD10>]}
[0m02:31:40.058994 [debug] [MainThread]: Flushing usage events
[0m02:31:40.683371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:32:39.870990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5D1AF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5BB146D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5D1AF650>]}


============================== 02:32:39.875169 | eae04968-9084-4abd-abdb-592d148fbb42 ==============================
[0m02:32:39.875169 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:32:39.876170 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m02:32:40.110061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5BB3F790>]}
[0m02:32:40.178961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D57E218D0>]}
[0m02:32:40.180973 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:32:40.536484 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:32:40.700175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:32:40.701365 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\staging\stg_books.sql
[0m02:32:41.098862 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'stg_books' in
package 'dbt_train' (models\staging\stg_books.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m02:32:41.099870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5DA15CD0>]}
[0m02:32:41.162113 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_books.staging
- models.dbt_books.marts
[0m02:32:41.173111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5947D910>]}
[0m02:32:41.241744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:32:41.244744 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:32:41.263807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5DB15E90>]}
[0m02:32:41.265073 [info ] [MainThread]: Found 6 models, 7 data tests, 1 source, 463 macros
[0m02:32:41.266068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5D1D36D0>]}
[0m02:32:41.268580 [info ] [MainThread]: 
[0m02:32:41.268580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:32:41.269588 [info ] [MainThread]: 
[0m02:32:41.270581 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:32:41.274582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m02:32:41.364454 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m02:32:41.364454 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m02:32:41.365454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:32:41.415560 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m02:32:41.416565 [debug] [ThreadPool]: On list_web_scraper: Close
[0m02:32:41.419560 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m02:32:41.423676 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m02:32:41.424667 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m02:32:41.424667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:32:41.477785 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.053 seconds
[0m02:32:41.479787 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m02:32:41.480792 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m02:32:41.485861 [debug] [MainThread]: Using postgres connection "master"
[0m02:32:41.485861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:32:41.486866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:32:41.542470 [debug] [MainThread]: SQL status: SELECT 1 in 0.056 seconds
[0m02:32:41.544467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5B2AEB90>]}
[0m02:32:41.544467 [debug] [MainThread]: On master: ROLLBACK
[0m02:32:41.545839 [debug] [MainThread]: On master: COMMIT
[0m02:32:41.545839 [debug] [MainThread]: Using postgres connection "master"
[0m02:32:41.546840 [debug] [MainThread]: On master: COMMIT
[0m02:32:41.546840 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:32:41.547840 [debug] [MainThread]: On master: Close
[0m02:32:41.551261 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m02:32:41.552264 [info ] [Thread-1 (]: 1 of 6 START sql table model books.available_quantity .......................... [RUN]
[0m02:32:41.554261 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m02:32:41.554261 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m02:32:41.560265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m02:32:41.561261 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m02:32:41.589476 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m02:32:41.590485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:32:41.590485 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    


select *
from books
where id = 4011
  );
  
[0m02:32:41.591477 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:32:41.648008 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.056 seconds
[0m02:32:41.656416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:32:41.656416 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity" rename to "available_quantity__dbt_backup"
[0m02:32:41.657417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:41.660422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:32:41.660422 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity__dbt_tmp" rename to "available_quantity"
[0m02:32:41.661415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:32:41.674421 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m02:32:41.675419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:32:41.675419 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m02:32:41.677423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:32:41.682432 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."available_quantity__dbt_backup"
[0m02:32:41.686587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:32:41.687596 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
drop table if exists "web_scraper"."books"."available_quantity__dbt_backup" cascade
[0m02:32:41.691587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:32:41.693587 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m02:32:41.695592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5DB15F50>]}
[0m02:32:41.696098 [info ] [Thread-1 (]: 1 of 6 OK created sql table model books.available_quantity ..................... [[32mSELECT 1[0m in 0.14s]
[0m02:32:41.697611 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m02:32:41.697611 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m02:32:41.698609 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m02:32:41.698609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.my_first_dbt_model)
[0m02:32:41.699621 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m02:32:41.702623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m02:32:41.703619 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m02:32:41.706622 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m02:32:41.707620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:32:41.707620 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m02:32:41.708627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:41.759620 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.051 seconds
[0m02:32:41.763744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:32:41.764762 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:32:41.765762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:32:41.767761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:32:41.768761 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:32:41.769764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:32:41.770972 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m02:32:41.770972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:32:41.771985 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m02:32:41.773290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:32:41.775297 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m02:32:41.775297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:32:41.776299 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m02:32:41.779412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:32:41.781418 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m02:32:41.781418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5F077AD0>]}
[0m02:32:41.782420 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.08s]
[0m02:32:41.783422 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m02:32:41.783422 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m02:32:41.784547 [info ] [Thread-1 (]: 3 of 6 START sql view model books.stg_books .................................... [RUN]
[0m02:32:41.784547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m02:32:41.785873 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m02:32:41.788369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m02:32:41.789377 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m02:32:41.802894 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m02:32:41.803894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:32:41.803894 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = "1" then 'One'
        when rating = "2" then 'Two'
        when rating = "3" then 'Three'
        when rating = "4" then 'Four'
        when rating = "5" then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m02:32:41.804896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:41.850623 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "1" does not exist
LINE 12:         when rating = "1" then 'One'
                               ^

[0m02:32:41.851624 [debug] [Thread-1 (]: On model.dbt_train.stg_books: ROLLBACK
[0m02:32:41.851624 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m02:32:41.856927 [debug] [Thread-1 (]: Database Error in model stg_books (models\staging\stg_books.sql)
  column "1" does not exist
  LINE 12:         when rating = "1" then 'One'
                                 ^
  compiled code at target\run\dbt_train\models\staging\stg_books.sql
[0m02:32:41.857937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5DF92850>]}
[0m02:32:41.857937 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model books.stg_books ........................... [[31mERROR[0m in 0.07s]
[0m02:32:41.858939 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m02:32:41.858939 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m02:32:41.860378 [debug] [Thread-4 (]: Marking all children of 'model.dbt_train.stg_books' to be skipped because of status 'error'.  Reason: Database Error in model stg_books (models\staging\stg_books.sql)
  column "1" does not exist
  LINE 12:         when rating = "1" then 'One'
                                 ^
  compiled code at target\run\dbt_train\models\staging\stg_books.sql.
[0m02:32:41.860378 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m02:32:41.862409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m02:32:41.862409 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m02:32:41.865410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m02:32:41.866410 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m02:32:41.869577 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m02:32:41.870584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:32:41.870584 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m02:32:41.871593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:41.921129 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m02:32:41.924136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:32:41.924136 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:32:41.925130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:32:41.927130 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m02:32:41.927130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:32:41.928129 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m02:32:41.931131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:32:41.933135 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m02:32:41.936284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:32:41.936284 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m02:32:41.937401 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m02:32:41.938401 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m02:32:41.939396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae04968-9084-4abd-abdb-592d148fbb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5F166C10>]}
[0m02:32:41.940406 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m02:32:41.941401 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m02:32:41.941401 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m02:32:41.942396 [info ] [Thread-1 (]: 5 of 6 SKIP relation books.dim_books ........................................... [[33mSKIP[0m]
[0m02:32:41.943409 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m02:32:41.943409 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m02:32:41.944406 [info ] [Thread-1 (]: 6 of 6 SKIP relation books.fact_books_inventory ................................ [[33mSKIP[0m]
[0m02:32:41.944406 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m02:32:41.946518 [debug] [MainThread]: On master: COMMIT
[0m02:32:41.946518 [debug] [MainThread]: Using postgres connection "master"
[0m02:32:41.946518 [debug] [MainThread]: On master: COMMIT
[0m02:32:41.947519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:32:41.992522 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m02:32:41.993536 [debug] [MainThread]: On master: Close
[0m02:32:41.993536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:32:41.994527 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m02:32:41.994527 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m02:32:41.994527 [debug] [MainThread]: Connection 'model.dbt_train.my_second_dbt_model' was properly closed.
[0m02:32:41.994527 [info ] [MainThread]: 
[0m02:32:41.996036 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m02:32:41.997210 [debug] [MainThread]: Command end result
[0m02:32:42.016387 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:32:42.018384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:32:42.023761 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m02:32:42.024775 [info ] [MainThread]: 
[0m02:32:42.024775 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:32:42.025760 [info ] [MainThread]: 
[0m02:32:42.026765 [error] [MainThread]: [31mFailure in model stg_books (models\staging\stg_books.sql)[0m
[0m02:32:42.026765 [error] [MainThread]:   Database Error in model stg_books (models\staging\stg_books.sql)
  column "1" does not exist
  LINE 12:         when rating = "1" then 'One'
                                 ^
  compiled code at target\run\dbt_train\models\staging\stg_books.sql
[0m02:32:42.027856 [info ] [MainThread]: 
[0m02:32:42.027856 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\staging\stg_books.sql
[0m02:32:42.029194 [info ] [MainThread]: 
[0m02:32:42.029194 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=6
[0m02:32:42.030221 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:32:42.031221 [debug] [MainThread]: Command `dbt run` failed at 02:32:42.031221 after 2.25 seconds
[0m02:32:42.031221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5D225D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D5B3CCF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D56E081D0>]}
[0m02:32:42.032220 [debug] [MainThread]: Flushing usage events
[0m02:32:42.783186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:34:12.499192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BCBADFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BCBAE650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BCBAF850>]}


============================== 02:34:12.502335 | 0507f8b6-6776-4bc9-b2a8-81809e0ab2c8 ==============================
[0m02:34:12.502335 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:34:12.503845 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m02:34:12.735757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BCC63390>]}
[0m02:34:12.799397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B7781210>]}
[0m02:34:12.800397 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:34:13.160654 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:34:13.332131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:34:13.333131 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\staging\stg_books.sql
[0m02:34:13.749455 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'stg_books' in
package 'dbt_train' (models\staging\stg_books.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m02:34:13.751463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BE4FC950>]}
[0m02:34:13.813312 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_books.staging
- models.dbt_books.marts
[0m02:34:13.824317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BE391B50>]}
[0m02:34:13.891171 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:34:13.894176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:34:13.914981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BE4EBE90>]}
[0m02:34:13.915987 [info ] [MainThread]: Found 6 models, 7 data tests, 1 source, 463 macros
[0m02:34:13.916991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BE391A90>]}
[0m02:34:13.918985 [info ] [MainThread]: 
[0m02:34:13.918985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:34:13.919987 [info ] [MainThread]: 
[0m02:34:13.920988 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:34:13.924982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m02:34:14.011130 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m02:34:14.011130 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m02:34:14.012127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:14.062363 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.051 seconds
[0m02:34:14.064363 [debug] [ThreadPool]: On list_web_scraper: Close
[0m02:34:14.066481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m02:34:14.071485 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m02:34:14.071485 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m02:34:14.071485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:14.123621 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.051 seconds
[0m02:34:14.125621 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m02:34:14.125621 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m02:34:14.131005 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:14.131005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:34:14.132018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:34:14.186037 [debug] [MainThread]: SQL status: SELECT 1 in 0.054 seconds
[0m02:34:14.187773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BE640390>]}
[0m02:34:14.188780 [debug] [MainThread]: On master: ROLLBACK
[0m02:34:14.189284 [debug] [MainThread]: On master: COMMIT
[0m02:34:14.189787 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:14.189787 [debug] [MainThread]: On master: COMMIT
[0m02:34:14.190840 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:34:14.191836 [debug] [MainThread]: On master: Close
[0m02:34:14.194832 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m02:34:14.195989 [info ] [Thread-1 (]: 1 of 6 START sql table model books.available_quantity .......................... [RUN]
[0m02:34:14.197997 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m02:34:14.198988 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m02:34:14.205503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m02:34:14.206497 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m02:34:14.235922 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m02:34:14.236986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:34:14.237506 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    


select *
from books
where id = 4011
  );
  
[0m02:34:14.238035 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:34:14.295179 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.058 seconds
[0m02:34:14.303804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:34:14.304804 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity" rename to "available_quantity__dbt_backup"
[0m02:34:14.305804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:34:14.307804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:34:14.308810 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity__dbt_tmp" rename to "available_quantity"
[0m02:34:14.309804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:34:14.321804 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m02:34:14.322812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:34:14.322812 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m02:34:14.324806 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:34:14.329808 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."available_quantity__dbt_backup"
[0m02:34:14.333934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:34:14.333934 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
drop table if exists "web_scraper"."books"."available_quantity__dbt_backup" cascade
[0m02:34:14.338934 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m02:34:14.341934 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m02:34:14.343935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BE95FED0>]}
[0m02:34:14.345048 [info ] [Thread-1 (]: 1 of 6 OK created sql table model books.available_quantity ..................... [[32mSELECT 1[0m in 0.15s]
[0m02:34:14.346188 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m02:34:14.346188 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m02:34:14.347195 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m02:34:14.348410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.my_first_dbt_model)
[0m02:34:14.348410 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m02:34:14.351417 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m02:34:14.352412 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m02:34:14.355417 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m02:34:14.356420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:34:14.356420 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m02:34:14.357421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:14.409192 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.052 seconds
[0m02:34:14.413199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:34:14.413199 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:34:14.414193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:34:14.417192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:34:14.417192 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:34:14.418192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:34:14.419195 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m02:34:14.419195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:34:14.420493 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m02:34:14.423653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:34:14.425653 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m02:34:14.426661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:34:14.426661 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m02:34:14.431653 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:34:14.433661 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m02:34:14.434657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BEA72190>]}
[0m02:34:14.434657 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.09s]
[0m02:34:14.435656 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m02:34:14.436803 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m02:34:14.436803 [info ] [Thread-1 (]: 3 of 6 START sql view model books.stg_books .................................... [RUN]
[0m02:34:14.438002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m02:34:14.439014 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m02:34:14.442015 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m02:34:14.443011 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m02:34:14.457023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m02:34:14.458024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:34:14.458024 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m02:34:14.459290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:14.516162 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m02:34:14.519166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:34:14.520165 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books"."stg_books__dbt_tmp" rename to "stg_books"
[0m02:34:14.521165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:34:14.522163 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m02:34:14.523356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:34:14.524373 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m02:34:14.525368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:34:14.528382 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."stg_books__dbt_backup"
[0m02:34:14.530383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:34:14.530383 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books"."stg_books__dbt_backup" cascade
[0m02:34:14.532384 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m02:34:14.533383 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m02:34:14.534383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BE9558D0>]}
[0m02:34:14.534383 [info ] [Thread-1 (]: 3 of 6 OK created sql view model books.stg_books ............................... [[32mCREATE VIEW[0m in 0.10s]
[0m02:34:14.536390 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m02:34:14.536390 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m02:34:14.537386 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m02:34:14.537386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m02:34:14.538382 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m02:34:14.540383 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m02:34:14.541680 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m02:34:14.544696 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m02:34:14.545691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:34:14.546749 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m02:34:14.546749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:14.596331 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m02:34:14.598334 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:34:14.599335 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:34:14.600575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:34:14.602571 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m02:34:14.602571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:34:14.602571 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m02:34:14.608574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m02:34:14.613245 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m02:34:14.613245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:34:14.614268 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m02:34:14.614268 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:34:14.615573 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m02:34:14.616935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BEAE8690>]}
[0m02:34:14.617948 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m02:34:14.617948 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m02:34:14.618948 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m02:34:14.618948 [info ] [Thread-1 (]: 5 of 6 START sql view model books.dim_books .................................... [RUN]
[0m02:34:14.619947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m02:34:14.619947 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m02:34:14.622947 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m02:34:14.624951 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m02:34:14.627950 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m02:34:14.629950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m02:34:14.629950 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books"."stg_books"
  );
[0m02:34:14.630948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:14.681842 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m02:34:14.683844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m02:34:14.685077 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books"."dim_books__dbt_tmp" rename to "dim_books"
[0m02:34:14.686085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:34:14.688110 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m02:34:14.688110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m02:34:14.689110 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m02:34:14.696121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m02:34:14.699632 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."dim_books__dbt_backup"
[0m02:34:14.699632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m02:34:14.700642 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books"."dim_books__dbt_backup" cascade
[0m02:34:14.701639 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:34:14.702638 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m02:34:14.703638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BEADF110>]}
[0m02:34:14.703638 [info ] [Thread-1 (]: 5 of 6 OK created sql view model books.dim_books ............................... [[32mCREATE VIEW[0m in 0.08s]
[0m02:34:14.704641 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m02:34:14.705923 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m02:34:14.705923 [info ] [Thread-1 (]: 6 of 6 START sql view model books.fact_books_inventory ......................... [RUN]
[0m02:34:14.706931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m02:34:14.707935 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m02:34:14.710954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m02:34:14.710954 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m02:34:14.714431 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m02:34:14.715433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m02:34:14.716437 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books"."stg_books"
group by category
  );
[0m02:34:14.716437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:14.767987 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m02:34:14.770988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m02:34:14.770988 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m02:34:14.771988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:34:14.772988 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m02:34:14.773993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m02:34:14.773993 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m02:34:14.775988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:34:14.777992 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."fact_books_inventory__dbt_backup"
[0m02:34:14.778987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m02:34:14.778987 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books"."fact_books_inventory__dbt_backup" cascade
[0m02:34:14.779988 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:34:14.780992 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m02:34:14.781987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0507f8b6-6776-4bc9-b2a8-81809e0ab2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BCBEC410>]}
[0m02:34:14.781987 [info ] [Thread-1 (]: 6 of 6 OK created sql view model books.fact_books_inventory .................... [[32mCREATE VIEW[0m in 0.08s]
[0m02:34:14.783991 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m02:34:14.784996 [debug] [MainThread]: On master: COMMIT
[0m02:34:14.784996 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:14.785997 [debug] [MainThread]: On master: COMMIT
[0m02:34:14.785997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:34:14.829336 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m02:34:14.830327 [debug] [MainThread]: On master: Close
[0m02:34:14.831318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:34:14.832316 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m02:34:14.832316 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m02:34:14.832316 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m02:34:14.833317 [info ] [MainThread]: 
[0m02:34:14.834326 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m02:34:14.835318 [debug] [MainThread]: Command end result
[0m02:34:14.854324 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:34:14.856759 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:34:14.862135 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m02:34:14.863137 [info ] [MainThread]: 
[0m02:34:14.863137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:34:14.864138 [info ] [MainThread]: 
[0m02:34:14.865136 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m02:34:14.865136 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:34:14.867253 [debug] [MainThread]: Command `dbt run` succeeded at 02:34:14.867253 after 2.46 seconds
[0m02:34:14.867253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BCC30850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BCC334D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BCBA23D0>]}
[0m02:34:14.868250 [debug] [MainThread]: Flushing usage events
[0m02:34:15.705105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:37:21.326122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9807AE450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A980805610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9807AE3D0>]}


============================== 02:37:21.329428 | 404f97ca-45ca-4f50-bb3c-6baf54f04d2a ==============================
[0m02:37:21.329428 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:37:21.330544 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m02:37:21.562759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '404f97ca-45ca-4f50-bb3c-6baf54f04d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FE9E8A10>]}
[0m02:37:21.628348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '404f97ca-45ca-4f50-bb3c-6baf54f04d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FC40D390>]}
[0m02:37:21.629344 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:37:21.969264 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:37:22.069803 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:37:22.071807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '404f97ca-45ca-4f50-bb3c-6baf54f04d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FE951C50>]}
[0m02:37:23.129900 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\staging\stg_books.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('arguments', {'values': ['One', 'Two', 'Three', 'Four', 'Five']})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m02:37:23.131906 [debug] [MainThread]: Command `dbt run` failed at 02:37:23.131906 after 1.92 seconds
[0m02:37:23.132902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A980835810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A980834110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FE78A750>]}
[0m02:37:23.133903 [debug] [MainThread]: Flushing usage events
[0m02:37:23.901412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:38:00.208357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024702CAF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024702CAE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024702CAF410>]}


============================== 02:38:00.212370 | acedc202-8f34-404a-96af-4259298cfa8f ==============================
[0m02:38:00.212370 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:38:00.213380 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m02:38:00.442728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024702EA42D0>]}
[0m02:38:00.508735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477D930290>]}
[0m02:38:00.509736 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:38:00.858138 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:38:00.936584 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:38:00.938593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024702D1D790>]}
[0m02:38:02.079041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470456FC90>]}
[0m02:38:02.145774 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:38:02.148148 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:38:02.168520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024704934B50>]}
[0m02:38:02.169518 [info ] [MainThread]: Found 6 models, 7 data tests, 1 source, 463 macros
[0m02:38:02.170516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024704744990>]}
[0m02:38:02.172997 [info ] [MainThread]: 
[0m02:38:02.174023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:38:02.174023 [info ] [MainThread]: 
[0m02:38:02.175019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:38:02.179014 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m02:38:02.265795 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m02:38:02.265795 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m02:38:02.266795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:38:02.318298 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m02:38:02.319297 [debug] [ThreadPool]: On list_web_scraper: Close
[0m02:38:02.322131 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m02:38:02.322131 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m02:38:02.322637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:38:02.369425 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.046 seconds
[0m02:38:02.370423 [debug] [ThreadPool]: On list_web_scraper: Close
[0m02:38:02.372427 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m02:38:02.373443 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m02:38:02.373443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:38:02.419164 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.046 seconds
[0m02:38:02.420166 [debug] [ThreadPool]: On list_web_scraper: Close
[0m02:38:02.421168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_books_books)
[0m02:38:02.422166 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books_books"
"
[0m02:38:02.425896 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books"
[0m02:38:02.426898 [debug] [ThreadPool]: On create_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books_books"} */
create schema if not exists "books_books"
[0m02:38:02.426898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:38:02.467626 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.041 seconds
[0m02:38:02.468626 [debug] [ThreadPool]: On create_web_scraper_books_books: COMMIT
[0m02:38:02.469630 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books"
[0m02:38:02.469630 [debug] [ThreadPool]: On create_web_scraper_books_books: COMMIT
[0m02:38:02.470630 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m02:38:02.471629 [debug] [ThreadPool]: On create_web_scraper_books_books: Close
[0m02:38:02.471629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_web_scraper_books_books, now create_web_scraper_books_books_silver)
[0m02:38:02.472627 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books_books_silver"
"
[0m02:38:02.474632 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m02:38:02.474632 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books_books_silver"} */
create schema if not exists "books_books_silver"
[0m02:38:02.474632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:38:02.519069 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.044 seconds
[0m02:38:02.520078 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m02:38:02.521078 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m02:38:02.521078 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m02:38:02.522080 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m02:38:02.522080 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: Close
[0m02:38:02.524308 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m02:38:02.529354 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m02:38:02.529354 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m02:38:02.530354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:38:02.582089 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.052 seconds
[0m02:38:02.583104 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m02:38:02.584105 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m02:38:02.585105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m02:38:02.587106 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m02:38:02.588106 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m02:38:02.588106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:38:02.640436 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m02:38:02.642950 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m02:38:02.642950 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m02:38:02.643970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m02:38:02.646988 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m02:38:02.647987 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m02:38:02.647987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:38:02.699165 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.051 seconds
[0m02:38:02.701160 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m02:38:02.701160 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m02:38:02.706532 [debug] [MainThread]: Using postgres connection "master"
[0m02:38:02.706532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:38:02.707546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:38:02.758623 [debug] [MainThread]: SQL status: SELECT 4 in 0.052 seconds
[0m02:38:02.761625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247047E3950>]}
[0m02:38:02.761625 [debug] [MainThread]: On master: ROLLBACK
[0m02:38:02.762623 [debug] [MainThread]: On master: COMMIT
[0m02:38:02.762623 [debug] [MainThread]: Using postgres connection "master"
[0m02:38:02.763625 [debug] [MainThread]: On master: COMMIT
[0m02:38:02.763625 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:38:02.764628 [debug] [MainThread]: On master: Close
[0m02:38:02.768972 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m02:38:02.770171 [info ] [Thread-1 (]: 1 of 6 START sql table model books.available_quantity .......................... [RUN]
[0m02:38:02.771236 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m02:38:02.772233 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m02:38:02.777235 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m02:38:02.778234 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m02:38:02.807708 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m02:38:02.808708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:38:02.809714 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    


select *
from books
where id = 4011
  );
  
[0m02:38:02.809714 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:38:02.866618 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.056 seconds
[0m02:38:02.874610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:38:02.874610 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity" rename to "available_quantity__dbt_backup"
[0m02:38:02.875610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:38:02.878898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:38:02.878898 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity__dbt_tmp" rename to "available_quantity"
[0m02:38:02.879920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:38:02.891975 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m02:38:02.892968 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:38:02.892968 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m02:38:02.895090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:38:02.900102 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."available_quantity__dbt_backup"
[0m02:38:02.904099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m02:38:02.905099 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
drop table if exists "web_scraper"."books"."available_quantity__dbt_backup" cascade
[0m02:38:02.909613 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:38:02.911609 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m02:38:02.913612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024704BE07D0>]}
[0m02:38:02.913612 [info ] [Thread-1 (]: 1 of 6 OK created sql table model books.available_quantity ..................... [[32mSELECT 1[0m in 0.14s]
[0m02:38:02.914611 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m02:38:02.915621 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m02:38:02.915621 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m02:38:02.916635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.my_first_dbt_model)
[0m02:38:02.916635 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m02:38:02.922115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m02:38:02.923208 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m02:38:02.993040 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m02:38:02.994042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:38:02.994042 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m02:38:02.995039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:38:03.145452 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.151 seconds
[0m02:38:03.148497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:38:03.149509 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:38:03.150618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:38:03.153632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:38:03.153632 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:38:03.155045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:38:03.156046 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m02:38:03.156046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:38:03.157042 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m02:38:03.163147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m02:38:03.166147 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m02:38:03.166147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m02:38:03.167148 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m02:38:03.171153 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:38:03.172147 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m02:38:03.173358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470459C4D0>]}
[0m02:38:03.173358 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.26s]
[0m02:38:03.174353 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m02:38:03.175354 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m02:38:03.175354 [info ] [Thread-1 (]: 3 of 6 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m02:38:03.176852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m02:38:03.176852 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m02:38:03.179863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m02:38:03.180864 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m02:38:03.195289 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m02:38:03.196289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:38:03.197291 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m02:38:03.197291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:38:03.250321 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m02:38:03.253318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:38:03.253318 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m02:38:03.254326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:38:03.256322 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m02:38:03.256322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:38:03.256322 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m02:38:03.259319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:38:03.262320 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m02:38:03.265319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m02:38:03.265319 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m02:38:03.266321 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:38:03.268319 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m02:38:03.268319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024704D13410>]}
[0m02:38:03.269319 [info ] [Thread-1 (]: 3 of 6 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.09s]
[0m02:38:03.270327 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m02:38:03.270327 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m02:38:03.271325 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m02:38:03.272319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m02:38:03.272319 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m02:38:03.275322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m02:38:03.276320 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m02:38:03.280710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m02:38:03.281719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:38:03.282710 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m02:38:03.282710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:38:03.333038 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m02:38:03.336038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:38:03.336038 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:38:03.337041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:38:03.338068 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m02:38:03.339079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:38:03.339079 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m02:38:03.342590 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:38:03.345595 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m02:38:03.346595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m02:38:03.346595 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m02:38:03.347601 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:38:03.349596 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m02:38:03.349596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247042299D0>]}
[0m02:38:03.350599 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m02:38:03.351598 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m02:38:03.352598 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m02:38:03.352598 [info ] [Thread-1 (]: 5 of 6 START sql view model books_books.dim_books .............................. [RUN]
[0m02:38:03.353599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m02:38:03.354597 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m02:38:03.356597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m02:38:03.357596 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m02:38:03.361598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m02:38:03.362595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m02:38:03.363600 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m02:38:03.363600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:38:03.416480 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m02:38:03.419480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m02:38:03.419480 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m02:38:03.420482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:38:03.421653 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m02:38:03.421653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m02:38:03.422750 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m02:38:03.425746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:38:03.428144 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m02:38:03.429147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m02:38:03.429147 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m02:38:03.430152 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:38:03.431157 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m02:38:03.432152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024704502FD0>]}
[0m02:38:03.432152 [info ] [Thread-1 (]: 5 of 6 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m02:38:03.434155 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m02:38:03.434155 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m02:38:03.435151 [info ] [Thread-1 (]: 6 of 6 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m02:38:03.435151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m02:38:03.436153 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m02:38:03.438286 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m02:38:03.439299 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m02:38:03.441301 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m02:38:03.443325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m02:38:03.443325 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m02:38:03.444670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:38:03.494496 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m02:38:03.498496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m02:38:03.498496 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m02:38:03.499501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:38:03.500496 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m02:38:03.501496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m02:38:03.501496 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m02:38:03.503498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:38:03.507496 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m02:38:03.507496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m02:38:03.508496 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m02:38:03.509503 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m02:38:03.510549 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m02:38:03.511969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acedc202-8f34-404a-96af-4259298cfa8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247042C1E50>]}
[0m02:38:03.511969 [info ] [Thread-1 (]: 6 of 6 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.08s]
[0m02:38:03.513981 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m02:38:03.514978 [debug] [MainThread]: On master: COMMIT
[0m02:38:03.516318 [debug] [MainThread]: Using postgres connection "master"
[0m02:38:03.516318 [debug] [MainThread]: On master: COMMIT
[0m02:38:03.516318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:38:03.560339 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m02:38:03.561471 [debug] [MainThread]: On master: Close
[0m02:38:03.561471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:38:03.562483 [debug] [MainThread]: Connection 'create_web_scraper_books_books_silver' was properly closed.
[0m02:38:03.562483 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m02:38:03.562483 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m02:38:03.563484 [info ] [MainThread]: 
[0m02:38:03.564490 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m02:38:03.566485 [debug] [MainThread]: Command end result
[0m02:38:03.583783 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:38:03.586783 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:38:03.591783 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m02:38:03.591783 [info ] [MainThread]: 
[0m02:38:03.592786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:38:03.593792 [info ] [MainThread]: 
[0m02:38:03.594783 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m02:38:03.595787 [debug] [MainThread]: Command `dbt run` succeeded at 02:38:03.595787 after 3.48 seconds
[0m02:38:03.595787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477C9982D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477C998110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477C998390>]}
[0m02:38:03.597241 [debug] [MainThread]: Flushing usage events
[0m02:38:04.339441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:39:09.122718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1552AC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1552AE890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1552AE690>]}


============================== 02:39:09.126728 | 2cb4bef0-08eb-4aaa-a428-c17b12cc0b50 ==============================
[0m02:39:09.126728 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:39:09.127761 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt test', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m02:39:09.356730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cb4bef0-08eb-4aaa-a428-c17b12cc0b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1554A4D50>]}
[0m02:39:09.418697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cb4bef0-08eb-4aaa-a428-c17b12cc0b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E14FE5D1D0>]}
[0m02:39:09.420698 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:39:09.769039 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:39:09.913348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:39:09.914347 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m02:39:09.914347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:39:09.951392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cb4bef0-08eb-4aaa-a428-c17b12cc0b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E155330450>]}
[0m02:39:10.019623 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:39:10.022626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:39:10.106783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cb4bef0-08eb-4aaa-a428-c17b12cc0b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1555085D0>]}
[0m02:39:10.107309 [info ] [MainThread]: Found 6 models, 7 data tests, 1 source, 463 macros
[0m02:39:10.107309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb4bef0-08eb-4aaa-a428-c17b12cc0b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1555644D0>]}
[0m02:39:10.109322 [info ] [MainThread]: 
[0m02:39:10.110321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:39:10.110321 [info ] [MainThread]: 
[0m02:39:10.111714 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:39:10.115717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m02:39:10.204954 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m02:39:10.204954 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m02:39:10.205953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:10.259690 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.054 seconds
[0m02:39:10.261724 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m02:39:10.262737 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m02:39:10.262737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m02:39:10.264735 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m02:39:10.265734 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m02:39:10.265734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:39:10.315788 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m02:39:10.316944 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m02:39:10.317945 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m02:39:10.317945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books)
[0m02:39:10.321488 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m02:39:10.321488 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m02:39:10.321488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:39:10.374490 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.052 seconds
[0m02:39:10.375493 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m02:39:10.375493 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m02:39:10.380582 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:10.380582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:39:10.381581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:39:10.438018 [debug] [MainThread]: SQL status: SELECT 7 in 0.057 seconds
[0m02:39:10.441017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb4bef0-08eb-4aaa-a428-c17b12cc0b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E155E3E7D0>]}
[0m02:39:10.441017 [debug] [MainThread]: On master: ROLLBACK
[0m02:39:10.442019 [debug] [MainThread]: On master: COMMIT
[0m02:39:10.443021 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:10.444029 [debug] [MainThread]: On master: COMMIT
[0m02:39:10.444029 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:39:10.445021 [debug] [MainThread]: On master: Close
[0m02:39:10.449015 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:39:10.450435 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_books_rating__One__Two__Three__Four__Five  [RUN]
[0m02:39:10.450435 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5'
[0m02:39:10.451817 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:39:10.466037 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:39:10.467050 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:39:10.482142 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:39:10.484140 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:39:10.484140 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from "web_scraper"."books_books_silver"."stg_books"
    group by rating

)

select *
from all_values
where value_field not in (
    'One','Two','Three','Four','Five'
)



  
  
      
    ) dbt_internal_test
[0m02:39:10.485143 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:39:10.534824 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.050 seconds
[0m02:39:10.538216 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: ROLLBACK
[0m02:39:10.539217 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: Close
[0m02:39:10.540216 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_books_rating__One__Two__Three__Four__Five ...... [[32mPASS[0m in 0.09s]
[0m02:39:10.541242 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:39:10.541242 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:39:10.542708 [info ] [Thread-1 (]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m02:39:10.543711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710)
[0m02:39:10.543711 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:39:10.549709 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:39:10.550725 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:39:10.553725 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:39:10.554724 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:39:10.554724 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."books"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m02:39:10.555721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:10.600018 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m02:39:10.602020 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m02:39:10.602020 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m02:39:10.603022 [error] [Thread-1 (]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
[0m02:39:10.604224 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:39:10.604224 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:39:10.605240 [info ] [Thread-1 (]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m02:39:10.605240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_train.not_null_my_second_dbt_model_id.151b76d778)
[0m02:39:10.606244 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:39:10.609349 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m02:39:10.610353 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:39:10.612354 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m02:39:10.613351 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m02:39:10.614352 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."books"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m02:39:10.614352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:10.661754 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m02:39:10.663751 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m02:39:10.663751 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: Close
[0m02:39:10.665754 [info ] [Thread-1 (]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
[0m02:39:10.666785 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:39:10.666785 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:39:10.667790 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_books_book_id ................................... [RUN]
[0m02:39:10.667790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m02:39:10.668786 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:39:10.671799 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:39:10.674798 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:39:10.676802 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:39:10.677800 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:39:10.678800 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select book_id
from "web_scraper"."books_books_silver"."stg_books"
where book_id is null



  
  
      
    ) dbt_internal_test
[0m02:39:10.678800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:10.724390 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m02:39:10.726392 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: ROLLBACK
[0m02:39:10.726392 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: Close
[0m02:39:10.727391 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_books_book_id ......................................... [[32mPASS[0m in 0.06s]
[0m02:39:10.728393 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:39:10.729393 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:39:10.730392 [info ] [Thread-1 (]: 5 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m02:39:10.730392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.unique_my_first_dbt_model_id.16e066b321)
[0m02:39:10.731393 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:39:10.736392 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m02:39:10.737392 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:39:10.739394 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m02:39:10.740392 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m02:39:10.741391 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."books"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:39:10.741391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:10.788074 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m02:39:10.792083 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m02:39:10.792686 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: Close
[0m02:39:10.793223 [info ] [Thread-1 (]: 5 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
[0m02:39:10.794324 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:39:10.794324 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:39:10.794878 [info ] [Thread-1 (]: 6 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m02:39:10.795961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_my_first_dbt_model_id.16e066b321, now test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493)
[0m02:39:10.796515 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:39:10.800597 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:39:10.801601 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:39:10.803599 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:39:10.804602 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:39:10.804602 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."books"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:39:10.805601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:10.853259 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m02:39:10.855267 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m02:39:10.856271 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m02:39:10.857270 [info ] [Thread-1 (]: 6 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
[0m02:39:10.858272 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:39:10.859272 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:39:10.859272 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_books_book_id ..................................... [RUN]
[0m02:39:10.860272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m02:39:10.861273 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:39:10.864267 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:39:10.865272 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:39:10.867277 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:39:10.868271 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:39:10.869272 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_stg_books_book_id.ca28902f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    book_id as unique_field,
    count(*) as n_records

from "web_scraper"."books_books_silver"."stg_books"
where book_id is not null
group by book_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:39:10.869272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:10.916531 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m02:39:10.917533 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: ROLLBACK
[0m02:39:10.918530 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: Close
[0m02:39:10.918530 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_books_book_id ........................................... [[32mPASS[0m in 0.06s]
[0m02:39:10.919532 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:39:10.921532 [debug] [MainThread]: On master: COMMIT
[0m02:39:10.921532 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:10.921532 [debug] [MainThread]: On master: COMMIT
[0m02:39:10.922530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:39:10.964044 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m02:39:10.965043 [debug] [MainThread]: On master: Close
[0m02:39:10.966043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:39:10.966043 [debug] [MainThread]: Connection 'list_web_scraper_books_books' was properly closed.
[0m02:39:10.967045 [debug] [MainThread]: Connection 'test.dbt_train.unique_stg_books_book_id.ca28902f83' was properly closed.
[0m02:39:10.967045 [info ] [MainThread]: 
[0m02:39:10.968042 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m02:39:10.970042 [debug] [MainThread]: Command end result
[0m02:39:10.989267 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:39:10.992270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:39:10.998277 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m02:39:10.998277 [info ] [MainThread]: 
[0m02:39:10.999280 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:39:11.000599 [info ] [MainThread]: 
[0m02:39:11.000599 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m02:39:11.000599 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:39:11.002028 [info ] [MainThread]: 
[0m02:39:11.002028 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m02:39:11.003028 [info ] [MainThread]: 
[0m02:39:11.004036 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m02:39:11.005028 [debug] [MainThread]: Command `dbt test` failed at 02:39:11.005028 after 1.97 seconds
[0m02:39:11.006028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E155333290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E153BF2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E14EE481D0>]}
[0m02:39:11.006028 [debug] [MainThread]: Flushing usage events
[0m02:39:11.696404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:51:02.564566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4DCAFB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4DCAEF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4DCAF9D0>]}


============================== 02:51:02.568565 | 8f96dba0-bc69-4200-beed-658c295971bc ==============================
[0m02:51:02.568565 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:51:02.569567 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt test', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m02:51:02.803255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f96dba0-bc69-4200-beed-658c295971bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4DF23E90>]}
[0m02:51:02.868253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f96dba0-bc69-4200-beed-658c295971bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4887C490>]}
[0m02:51:02.870257 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:51:03.219789 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:51:03.350305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:51:03.350305 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m02:51:03.351307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:51:03.388443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f96dba0-bc69-4200-beed-658c295971bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4F2FEC50>]}
[0m02:51:03.456957 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:51:03.459169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:51:03.545689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f96dba0-bc69-4200-beed-658c295971bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4F227F10>]}
[0m02:51:03.546688 [info ] [MainThread]: Found 6 models, 7 data tests, 1 source, 463 macros
[0m02:51:03.547689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f96dba0-bc69-4200-beed-658c295971bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4F20A410>]}
[0m02:51:03.549689 [info ] [MainThread]: 
[0m02:51:03.550691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:51:03.551825 [info ] [MainThread]: 
[0m02:51:03.551825 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:51:03.555826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m02:51:03.644429 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m02:51:03.644429 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m02:51:03.645432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:03.704098 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.059 seconds
[0m02:51:03.706088 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m02:51:03.706088 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m02:51:03.707088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m02:51:03.709086 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m02:51:03.710089 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m02:51:03.710089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:03.762407 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m02:51:03.764411 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m02:51:03.765412 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m02:51:03.765412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books)
[0m02:51:03.769411 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m02:51:03.769411 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m02:51:03.769411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:03.823108 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.053 seconds
[0m02:51:03.824109 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m02:51:03.825123 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m02:51:03.830110 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:03.831112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:51:03.831112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:51:03.883017 [debug] [MainThread]: SQL status: SELECT 7 in 0.052 seconds
[0m02:51:03.886017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f96dba0-bc69-4200-beed-658c295971bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4F8C6750>]}
[0m02:51:03.887029 [debug] [MainThread]: On master: ROLLBACK
[0m02:51:03.887029 [debug] [MainThread]: On master: COMMIT
[0m02:51:03.888019 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:03.889018 [debug] [MainThread]: On master: COMMIT
[0m02:51:03.889018 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:51:03.890019 [debug] [MainThread]: On master: Close
[0m02:51:03.893021 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:51:03.894017 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_books_rating__One__Two__Three__Four__Five  [RUN]
[0m02:51:03.895016 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5'
[0m02:51:03.896018 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:51:03.910016 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:51:03.912021 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:51:03.927018 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:51:03.928016 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:51:03.929020 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from "web_scraper"."books_books_silver"."stg_books"
    group by rating

)

select *
from all_values
where value_field not in (
    'One','Two','Three','Four','Five'
)



  
  
      
    ) dbt_internal_test
[0m02:51:03.929020 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:51:03.977245 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m02:51:03.981091 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: ROLLBACK
[0m02:51:03.982093 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: Close
[0m02:51:03.983092 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_books_rating__One__Two__Three__Four__Five ...... [[32mPASS[0m in 0.09s]
[0m02:51:03.984091 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:51:03.985086 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:51:03.985086 [info ] [Thread-1 (]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m02:51:03.986095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710)
[0m02:51:03.986095 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:51:03.992522 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:51:03.993534 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:51:03.996232 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:51:03.997246 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:51:03.997754 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."books"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m02:51:03.998262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:04.040272 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m02:51:04.042274 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m02:51:04.042274 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m02:51:04.043272 [error] [Thread-1 (]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
[0m02:51:04.044275 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:51:04.045273 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:51:04.045273 [info ] [Thread-1 (]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m02:51:04.046274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_train.not_null_my_second_dbt_model_id.151b76d778)
[0m02:51:04.047272 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:51:04.050276 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m02:51:04.051277 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:51:04.054275 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m02:51:04.054275 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m02:51:04.055275 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."books"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m02:51:04.055275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:04.107725 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.052 seconds
[0m02:51:04.109721 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m02:51:04.109721 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: Close
[0m02:51:04.111722 [info ] [Thread-1 (]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
[0m02:51:04.112725 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:51:04.112725 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:51:04.113726 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_books_book_id ................................... [RUN]
[0m02:51:04.114722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m02:51:04.114722 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:51:04.118154 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:51:04.119243 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:51:04.121270 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:51:04.122267 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:51:04.123266 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select book_id
from "web_scraper"."books_books_silver"."stg_books"
where book_id is null



  
  
      
    ) dbt_internal_test
[0m02:51:04.123266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:04.166801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m02:51:04.167801 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: ROLLBACK
[0m02:51:04.169802 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: Close
[0m02:51:04.169802 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_books_book_id ......................................... [[32mPASS[0m in 0.06s]
[0m02:51:04.170805 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:51:04.170805 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:51:04.172021 [info ] [Thread-1 (]: 5 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m02:51:04.173040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.unique_my_first_dbt_model_id.16e066b321)
[0m02:51:04.173040 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:51:04.178603 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m02:51:04.179613 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:51:04.181616 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m02:51:04.182612 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m02:51:04.183614 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."books"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:51:04.183614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:04.232970 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.049 seconds
[0m02:51:04.235988 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m02:51:04.236988 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: Close
[0m02:51:04.237990 [info ] [Thread-1 (]: 5 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
[0m02:51:04.238991 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:51:04.239989 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:51:04.239989 [info ] [Thread-1 (]: 6 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m02:51:04.240991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_my_first_dbt_model_id.16e066b321, now test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493)
[0m02:51:04.240991 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:51:04.244987 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:51:04.245995 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:51:04.247989 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:51:04.248989 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:51:04.248989 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."books"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:51:04.249991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:04.296507 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m02:51:04.304507 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m02:51:04.304507 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m02:51:04.305511 [info ] [Thread-1 (]: 6 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
[0m02:51:04.306549 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:51:04.307697 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:51:04.307697 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_books_book_id ..................................... [RUN]
[0m02:51:04.308844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m02:51:04.308844 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:51:04.312859 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:51:04.312859 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:51:04.315861 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:51:04.316862 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:51:04.316862 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_stg_books_book_id.ca28902f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    book_id as unique_field,
    count(*) as n_records

from "web_scraper"."books_books_silver"."stg_books"
where book_id is not null
group by book_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:51:04.317861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:04.469341 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.152 seconds
[0m02:51:04.471342 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: ROLLBACK
[0m02:51:04.471342 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: Close
[0m02:51:04.472346 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_books_book_id ........................................... [[32mPASS[0m in 0.16s]
[0m02:51:04.473344 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:51:04.475348 [debug] [MainThread]: On master: COMMIT
[0m02:51:04.475348 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:04.476353 [debug] [MainThread]: On master: COMMIT
[0m02:51:04.476353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:51:04.521383 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m02:51:04.521383 [debug] [MainThread]: On master: Close
[0m02:51:04.522385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:04.522385 [debug] [MainThread]: Connection 'list_web_scraper_books_books' was properly closed.
[0m02:51:04.522385 [debug] [MainThread]: Connection 'test.dbt_train.unique_stg_books_book_id.ca28902f83' was properly closed.
[0m02:51:04.523385 [info ] [MainThread]: 
[0m02:51:04.524393 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m02:51:04.525385 [debug] [MainThread]: Command end result
[0m02:51:04.544384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:51:04.547386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:51:04.553385 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m02:51:04.553385 [info ] [MainThread]: 
[0m02:51:04.554385 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:51:04.555386 [info ] [MainThread]: 
[0m02:51:04.555386 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m02:51:04.556386 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:51:04.556386 [info ] [MainThread]: 
[0m02:51:04.557386 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m02:51:04.558388 [info ] [MainThread]: 
[0m02:51:04.558388 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m02:51:04.560385 [debug] [MainThread]: Command `dbt test` failed at 02:51:04.560385 after 2.09 seconds
[0m02:51:04.560385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4DD30190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4DD33950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD47868610>]}
[0m02:51:04.561383 [debug] [MainThread]: Flushing usage events
[0m02:51:05.291945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:51:40.479519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496A1AC150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496A1AE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496A1AEF50>]}


============================== 02:51:40.483525 | bbff0583-f933-4b83-86cf-ac084067aefb ==============================
[0m02:51:40.483525 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:51:40.484520 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'invocation_command': 'dbt test', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m02:51:40.722150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbff0583-f933-4b83-86cf-ac084067aefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496A3A8E10>]}
[0m02:51:40.789155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbff0583-f933-4b83-86cf-ac084067aefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024964DF1ED0>]}
[0m02:51:40.790155 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:51:41.132919 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:51:41.291540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:51:41.292536 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\my_first_dbt_model.sql
[0m02:51:41.292536 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\my_second_dbt_model.sql
[0m02:51:41.755626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbff0583-f933-4b83-86cf-ac084067aefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496A418B90>]}
[0m02:51:41.823149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:51:41.826146 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:51:41.854145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbff0583-f933-4b83-86cf-ac084067aefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496ACD8B10>]}
[0m02:51:41.855145 [info ] [MainThread]: Found 6 models, 7 data tests, 1 source, 463 macros
[0m02:51:41.856152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbff0583-f933-4b83-86cf-ac084067aefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496A9EA0D0>]}
[0m02:51:41.858149 [info ] [MainThread]: 
[0m02:51:41.859151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:51:41.859151 [info ] [MainThread]: 
[0m02:51:41.860144 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:51:41.865151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m02:51:41.953103 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m02:51:41.954103 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m02:51:41.954103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:42.012858 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.058 seconds
[0m02:51:42.014864 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m02:51:42.014864 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m02:51:42.015864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books)
[0m02:51:42.018864 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m02:51:42.018864 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m02:51:42.019864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:42.073857 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.054 seconds
[0m02:51:42.075855 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m02:51:42.075855 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m02:51:42.076854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books_books_silver)
[0m02:51:42.079259 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m02:51:42.080287 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m02:51:42.080287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:42.136205 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.055 seconds
[0m02:51:42.137206 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m02:51:42.138201 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m02:51:42.142201 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:42.142201 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:51:42.143210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:51:42.196459 [debug] [MainThread]: SQL status: SELECT 7 in 0.054 seconds
[0m02:51:42.199468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbff0583-f933-4b83-86cf-ac084067aefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496A709610>]}
[0m02:51:42.199468 [debug] [MainThread]: On master: ROLLBACK
[0m02:51:42.200465 [debug] [MainThread]: On master: COMMIT
[0m02:51:42.200465 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:42.200465 [debug] [MainThread]: On master: COMMIT
[0m02:51:42.201464 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:51:42.201464 [debug] [MainThread]: On master: Close
[0m02:51:42.206470 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:51:42.206470 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_books_rating__One__Two__Three__Four__Five  [RUN]
[0m02:51:42.207465 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5'
[0m02:51:42.208529 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:51:42.223157 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:51:42.224169 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:51:42.238190 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:51:42.240194 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:51:42.240194 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from "web_scraper"."books_books_silver"."stg_books"
    group by rating

)

select *
from all_values
where value_field not in (
    'One','Two','Three','Four','Five'
)



  
  
      
    ) dbt_internal_test
[0m02:51:42.241190 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:51:42.287532 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m02:51:42.291531 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: ROLLBACK
[0m02:51:42.291531 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: Close
[0m02:51:42.292532 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_books_rating__One__Two__Three__Four__Five ...... [[32mPASS[0m in 0.09s]
[0m02:51:42.294541 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:51:42.294541 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:51:42.295534 [info ] [Thread-1 (]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m02:51:42.296533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710)
[0m02:51:42.296533 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:51:42.302544 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:51:42.303544 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:51:42.306542 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:51:42.307544 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:51:42.307544 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."books"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m02:51:42.308543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:42.354910 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m02:51:42.355910 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m02:51:42.356910 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m02:51:42.358159 [error] [Thread-1 (]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
[0m02:51:42.358665 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:51:42.358665 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:51:42.360333 [info ] [Thread-1 (]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m02:51:42.361340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_train.not_null_my_second_dbt_model_id.151b76d778)
[0m02:51:42.361847 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:51:42.365366 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m02:51:42.366365 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:51:42.368359 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m02:51:42.369359 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"
[0m02:51:42.369359 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."books"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m02:51:42.370359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:42.417902 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m02:51:42.419907 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m02:51:42.420903 [debug] [Thread-1 (]: On test.dbt_train.not_null_my_second_dbt_model_id.151b76d778: Close
[0m02:51:42.420903 [info ] [Thread-1 (]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
[0m02:51:42.421903 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_my_second_dbt_model_id.151b76d778
[0m02:51:42.423373 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:51:42.423373 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_books_book_id ................................... [RUN]
[0m02:51:42.424390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m02:51:42.424390 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:51:42.428387 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:51:42.429385 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:51:42.431385 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:51:42.432385 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:51:42.433385 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select book_id
from "web_scraper"."books_books_silver"."stg_books"
where book_id is null



  
  
      
    ) dbt_internal_test
[0m02:51:42.433385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:42.484405 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.050 seconds
[0m02:51:42.485407 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: ROLLBACK
[0m02:51:42.486406 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: Close
[0m02:51:42.486406 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_books_book_id ......................................... [[32mPASS[0m in 0.06s]
[0m02:51:42.487406 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:51:42.488677 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:51:42.488677 [info ] [Thread-1 (]: 5 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m02:51:42.489929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.unique_my_first_dbt_model_id.16e066b321)
[0m02:51:42.489929 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:51:42.495106 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m02:51:42.497109 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:51:42.499334 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m02:51:42.500349 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"
[0m02:51:42.501344 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."books"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:51:42.501344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:42.546131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.044 seconds
[0m02:51:42.547745 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m02:51:42.548284 [debug] [Thread-1 (]: On test.dbt_train.unique_my_first_dbt_model_id.16e066b321: Close
[0m02:51:42.548284 [info ] [Thread-1 (]: 5 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
[0m02:51:42.549298 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_first_dbt_model_id.16e066b321
[0m02:51:42.550298 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:51:42.550298 [info ] [Thread-1 (]: 6 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m02:51:42.551300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_my_first_dbt_model_id.16e066b321, now test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493)
[0m02:51:42.551300 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:51:42.556747 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:51:42.557798 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:51:42.560602 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:51:42.561678 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:51:42.562233 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."books"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:51:42.562764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:42.609619 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m02:51:42.611623 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m02:51:42.611623 [debug] [Thread-1 (]: On test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m02:51:42.611623 [info ] [Thread-1 (]: 6 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
[0m02:51:42.613130 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493
[0m02:51:42.613130 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:51:42.614283 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_books_book_id ..................................... [RUN]
[0m02:51:42.615297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m02:51:42.616298 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:51:42.619296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:51:42.620297 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:51:42.623911 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:51:42.624904 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:51:42.625903 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_stg_books_book_id.ca28902f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    book_id as unique_field,
    count(*) as n_records

from "web_scraper"."books_books_silver"."stg_books"
where book_id is not null
group by book_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:51:42.625903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:42.677729 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.052 seconds
[0m02:51:42.679729 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: ROLLBACK
[0m02:51:42.679729 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: Close
[0m02:51:42.680729 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_books_book_id ........................................... [[32mPASS[0m in 0.07s]
[0m02:51:42.681735 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:51:42.682765 [debug] [MainThread]: On master: COMMIT
[0m02:51:42.682765 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:42.683759 [debug] [MainThread]: On master: COMMIT
[0m02:51:42.683759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:51:42.734176 [debug] [MainThread]: SQL status: COMMIT in 0.050 seconds
[0m02:51:42.735178 [debug] [MainThread]: On master: Close
[0m02:51:42.735178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:42.736173 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m02:51:42.736173 [debug] [MainThread]: Connection 'test.dbt_train.unique_stg_books_book_id.ca28902f83' was properly closed.
[0m02:51:42.737173 [info ] [MainThread]: 
[0m02:51:42.737173 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m02:51:42.739172 [debug] [MainThread]: Command end result
[0m02:51:42.756194 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:51:42.759196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:51:42.765199 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m02:51:42.765199 [info ] [MainThread]: 
[0m02:51:42.766195 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:51:42.767199 [info ] [MainThread]: 
[0m02:51:42.768200 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m02:51:42.768200 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:51:42.769195 [info ] [MainThread]: 
[0m02:51:42.770196 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m02:51:42.771195 [info ] [MainThread]: 
[0m02:51:42.772195 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m02:51:42.773195 [debug] [MainThread]: Command `dbt test` failed at 02:51:42.773195 after 2.38 seconds
[0m02:51:42.773195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496A235890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496A235B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024968318490>]}
[0m02:51:42.774195 [debug] [MainThread]: Flushing usage events
[0m02:51:43.342942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:52:39.236196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE55BAF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE55C27990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE55C25110>]}


============================== 02:52:39.240194 | d6e7ee54-1726-4db0-805d-9438b0d05737 ==============================
[0m02:52:39.240194 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:52:39.241196 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt test', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m02:52:39.476728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6e7ee54-1726-4db0-805d-9438b0d05737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE55BA3510>]}
[0m02:52:39.540880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6e7ee54-1726-4db0-805d-9438b0d05737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE5077C590>]}
[0m02:52:39.541878 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:52:39.890048 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:52:40.054576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:52:40.054576 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\schema.yml
[0m02:52:40.381648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6e7ee54-1726-4db0-805d-9438b0d05737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE53C89810>]}
[0m02:52:40.449649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:52:40.452649 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:52:40.482170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6e7ee54-1726-4db0-805d-9438b0d05737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE53458C10>]}
[0m02:52:40.483170 [info ] [MainThread]: Found 6 models, 3 data tests, 1 source, 463 macros
[0m02:52:40.483170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6e7ee54-1726-4db0-805d-9438b0d05737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE57145A90>]}
[0m02:52:40.485170 [info ] [MainThread]: 
[0m02:52:40.486170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:52:40.487172 [info ] [MainThread]: 
[0m02:52:40.488170 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:52:40.492171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m02:52:40.579179 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m02:52:40.580633 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m02:52:40.580633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:40.639694 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.059 seconds
[0m02:52:40.641701 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m02:52:40.641701 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m02:52:40.642734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m02:52:40.645834 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m02:52:40.646856 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m02:52:40.647519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:40.699246 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m02:52:40.701248 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m02:52:40.702249 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m02:52:40.703246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books)
[0m02:52:40.705245 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m02:52:40.705245 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m02:52:40.706247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:40.760246 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.054 seconds
[0m02:52:40.761247 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m02:52:40.762249 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m02:52:40.767256 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:40.768255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:52:40.768255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:52:40.822821 [debug] [MainThread]: SQL status: SELECT 7 in 0.054 seconds
[0m02:52:40.825822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6e7ee54-1726-4db0-805d-9438b0d05737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE55EF12D0>]}
[0m02:52:40.825822 [debug] [MainThread]: On master: ROLLBACK
[0m02:52:40.826821 [debug] [MainThread]: On master: COMMIT
[0m02:52:40.827821 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:40.827821 [debug] [MainThread]: On master: COMMIT
[0m02:52:40.828827 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:52:40.828827 [debug] [MainThread]: On master: Close
[0m02:52:40.832822 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:52:40.833823 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_stg_books_rating__One__Two__Three__Four__Five  [RUN]
[0m02:52:40.834822 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5'
[0m02:52:40.835821 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:52:40.848823 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:52:40.849823 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:52:40.863821 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:52:40.865826 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:52:40.865826 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from "web_scraper"."books_books_silver"."stg_books"
    group by rating

)

select *
from all_values
where value_field not in (
    'One','Two','Three','Four','Five'
)



  
  
      
    ) dbt_internal_test
[0m02:52:40.866829 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:52:40.914341 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m02:52:40.918341 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: ROLLBACK
[0m02:52:40.919350 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: Close
[0m02:52:40.919350 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_stg_books_rating__One__Two__Three__Four__Five ...... [[32mPASS[0m in 0.08s]
[0m02:52:40.921346 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:52:40.921346 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:52:40.922345 [info ] [Thread-1 (]: 2 of 3 START test not_null_stg_books_book_id ................................... [RUN]
[0m02:52:40.923344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m02:52:40.923344 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:52:40.929342 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:52:40.930343 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:52:40.932344 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:52:40.933343 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:52:40.933343 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select book_id
from "web_scraper"."books_books_silver"."stg_books"
where book_id is null



  
  
      
    ) dbt_internal_test
[0m02:52:40.934343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:40.980323 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m02:52:40.981327 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: ROLLBACK
[0m02:52:40.982323 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: Close
[0m02:52:40.983324 [info ] [Thread-1 (]: 2 of 3 PASS not_null_stg_books_book_id ......................................... [[32mPASS[0m in 0.06s]
[0m02:52:40.984324 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:52:40.985327 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:52:40.985327 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_books_book_id ..................................... [RUN]
[0m02:52:40.986330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m02:52:40.987324 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:52:40.992325 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:52:40.993323 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:52:40.997323 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:52:40.998324 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:52:40.999325 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_stg_books_book_id.ca28902f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    book_id as unique_field,
    count(*) as n_records

from "web_scraper"."books_books_silver"."stg_books"
where book_id is not null
group by book_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:52:40.999325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:41.049324 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.050 seconds
[0m02:52:41.052322 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: ROLLBACK
[0m02:52:41.052322 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: Close
[0m02:52:41.053325 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_books_book_id ........................................... [[32mPASS[0m in 0.07s]
[0m02:52:41.054324 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:52:41.056324 [debug] [MainThread]: On master: COMMIT
[0m02:52:41.057324 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:41.057324 [debug] [MainThread]: On master: COMMIT
[0m02:52:41.057324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:52:41.102867 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m02:52:41.103863 [debug] [MainThread]: On master: Close
[0m02:52:41.103863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:52:41.103863 [debug] [MainThread]: Connection 'list_web_scraper_books_books' was properly closed.
[0m02:52:41.104860 [debug] [MainThread]: Connection 'test.dbt_train.unique_stg_books_book_id.ca28902f83' was properly closed.
[0m02:52:41.104860 [info ] [MainThread]: 
[0m02:52:41.105857 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m02:52:41.106860 [debug] [MainThread]: Command end result
[0m02:52:41.123859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:52:41.126857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:52:41.132857 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m02:52:41.132857 [info ] [MainThread]: 
[0m02:52:41.133858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:52:41.134859 [info ] [MainThread]: 
[0m02:52:41.135857 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m02:52:41.136857 [debug] [MainThread]: Command `dbt test` succeeded at 02:52:41.136857 after 1.99 seconds
[0m02:52:41.137861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE55BF6AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE55BA2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE55BA2990>]}
[0m02:52:41.137861 [debug] [MainThread]: Flushing usage events
[0m02:52:41.840089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:52:59.563944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A08BAC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A08BAC650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A08BAD850>]}


============================== 02:52:59.567942 | 0f58ce28-bfb5-4be8-811f-44f99adac63e ==============================
[0m02:52:59.567942 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:52:59.568946 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'printer_width': '80', 'write_json': 'True'}
[0m02:52:59.803553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f58ce28-bfb5-4be8-811f-44f99adac63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A08E83DD0>]}
[0m02:52:59.867919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f58ce28-bfb5-4be8-811f-44f99adac63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A0374DA90>]}
[0m02:52:59.869911 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:53:00.221910 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:53:00.368874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:53:00.369874 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m02:53:00.369874 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:53:00.407400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f58ce28-bfb5-4be8-811f-44f99adac63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A0A2A15D0>]}
[0m02:53:00.430398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f58ce28-bfb5-4be8-811f-44f99adac63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A0A340290>]}
[0m02:53:00.431397 [info ] [MainThread]: Found 6 models, 3 data tests, 1 source, 463 macros
[0m02:53:00.431903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f58ce28-bfb5-4be8-811f-44f99adac63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A0A11F250>]}
[0m02:53:00.433991 [info ] [MainThread]: 
[0m02:53:00.434990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:00.435988 [info ] [MainThread]: 
[0m02:53:00.436991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:00.441495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m02:53:00.598478 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m02:53:00.598478 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m02:53:00.599479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:00.654544 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.055 seconds
[0m02:53:00.656019 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m02:53:00.657037 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m02:53:00.658038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books)
[0m02:53:00.660051 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m02:53:00.661051 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m02:53:00.661051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:00.711990 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.051 seconds
[0m02:53:00.713993 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m02:53:00.714989 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m02:53:00.715990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m02:53:00.717992 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m02:53:00.718991 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m02:53:00.718991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:00.768005 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.049 seconds
[0m02:53:00.770005 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m02:53:00.771006 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m02:53:00.776003 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:00.776003 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:53:00.777006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:00.828519 [debug] [MainThread]: SQL status: SELECT 7 in 0.051 seconds
[0m02:53:00.830519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f58ce28-bfb5-4be8-811f-44f99adac63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A0A13B9D0>]}
[0m02:53:00.831521 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:00.831521 [debug] [MainThread]: On master: Close
[0m02:53:00.835539 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m02:53:00.836521 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m02:53:00.836521 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m02:53:00.843521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m02:53:00.844520 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m02:53:00.844520 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m02:53:00.845525 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m02:53:00.845525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.my_first_dbt_model)
[0m02:53:00.846524 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m02:53:00.848519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m02:53:00.849521 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m02:53:00.850522 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m02:53:00.850522 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m02:53:00.851522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m02:53:00.851522 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m02:53:00.854521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m02:53:00.855522 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m02:53:00.855522 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m02:53:00.856523 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m02:53:00.857521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m02:53:00.857521 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m02:53:00.859520 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m02:53:00.860521 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m02:53:00.861521 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m02:53:00.861521 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m02:53:00.862522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m02:53:00.862522 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m02:53:00.865518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m02:53:00.866521 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m02:53:00.866521 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m02:53:00.867523 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m02:53:00.867523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m02:53:00.868519 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m02:53:00.870522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m02:53:00.871522 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m02:53:00.872523 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m02:53:00.872523 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:53:00.872523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.fact_books_inventory, now test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5)
[0m02:53:00.873523 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:53:00.885532 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m02:53:00.886530 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:53:00.886530 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m02:53:00.887530 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:53:00.887530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m02:53:00.888532 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:53:00.894662 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m02:53:00.895666 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:53:00.895666 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m02:53:00.897174 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:53:00.898186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m02:53:00.898186 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:53:00.903190 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m02:53:00.904185 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:53:00.905186 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m02:53:00.906185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:00.906185 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m02:53:00.907189 [debug] [MainThread]: Connection 'test.dbt_train.unique_stg_books_book_id.ca28902f83' was properly closed.
[0m02:53:00.908188 [debug] [MainThread]: Command end result
[0m02:53:00.975181 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:53:00.978188 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:53:00.984206 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m02:53:00.987204 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m02:53:00.987204 [info ] [MainThread]: Building catalog
[0m02:53:00.996203 [debug] [ThreadPool]: Acquiring new postgres connection 'web_scraper.information_schema'
[0m02:53:01.001713 [debug] [ThreadPool]: Using postgres connection "web_scraper.information_schema"
[0m02:53:01.002714 [debug] [ThreadPool]: On web_scraper.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "web_scraper.information_schema"} */

    
    

    select
        'web_scraper' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('books_books_silver') and
           upper(tbl.relname) = upper('stg_books')) or (upper(sch.nspname) = upper('books_books') and
           upper(tbl.relname) = upper('fact_books_inventory')) or (upper(sch.nspname) = upper('books_books') and
           upper(tbl.relname) = upper('dim_books')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('available_quantity')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_second_dbt_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('books')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m02:53:01.002714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:01.056808 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.053 seconds
[0m02:53:01.059809 [debug] [ThreadPool]: On web_scraper.information_schema: ROLLBACK
[0m02:53:01.059809 [debug] [ThreadPool]: On web_scraper.information_schema: Close
[0m02:53:01.069812 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m02:53:01.087815 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m02:53:01.089817 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m02:53:01.090817 [info ] [MainThread]: Catalog written to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m02:53:01.092820 [debug] [MainThread]: Command `dbt docs generate` succeeded at 02:53:01.092820 after 1.62 seconds
[0m02:53:01.092820 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m02:53:01.093815 [debug] [MainThread]: Connection 'web_scraper.information_schema' was properly closed.
[0m02:53:01.093815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A02926750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A02758050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A06A9A690>]}
[0m02:53:01.093815 [debug] [MainThread]: Flushing usage events
[0m02:53:01.690381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:53:54.709640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174939AD890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174939A3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174939A3490>]}


============================== 02:53:54.714379 | 5a3bc42d-0caf-4eba-ba29-ec2e0323abbc ==============================
[0m02:53:54.714379 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:53:54.715394 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'printer_width': '80', 'invocation_command': 'dbt docs serve', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m02:53:54.948237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a3bc42d-0caf-4eba-ba29-ec2e0323abbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017493BD6E50>]}
[0m02:53:55.012484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a3bc42d-0caf-4eba-ba29-ec2e0323abbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001748E5DDA50>]}
[0m03:03:17.476026 [error] [MainThread]: Encountered an error:

[0m03:03:17.480024 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m03:03:17.482021 [debug] [MainThread]: Command `dbt docs serve` failed at 03:03:17.482021 after 562.86 seconds
[0m03:03:17.482021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017493DE2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174939AD050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174939AF590>]}
[0m03:03:17.483025 [debug] [MainThread]: Flushing usage events
[0m03:03:18.199171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:03:22.389409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B14A2C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7AF783790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B152A090>]}


============================== 03:03:22.393406 | aa097644-9b9c-462a-b2dc-cc02041c1396 ==============================
[0m03:03:22.393406 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:03:22.394409 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt snapshot', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m03:03:22.627709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa097644-9b9c-462a-b2dc-cc02041c1396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B169C1D0>]}
[0m03:03:22.694233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa097644-9b9c-462a-b2dc-cc02041c1396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7AD0F1A50>]}
[0m03:03:22.695231 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:03:23.039454 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:03:23.116325 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:03:23.118333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa097644-9b9c-462a-b2dc-cc02041c1396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7AF651C50>]}
[0m03:03:24.534756 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:03:24.543755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa097644-9b9c-462a-b2dc-cc02041c1396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B1FA10D0>]}
[0m03:03:24.615641 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:03:24.618644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:03:24.656645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa097644-9b9c-462a-b2dc-cc02041c1396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B1D275D0>]}
[0m03:03:24.657646 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:03:24.658645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa097644-9b9c-462a-b2dc-cc02041c1396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B1F5D890>]}
[0m03:03:24.660171 [info ] [MainThread]: 
[0m03:03:24.661163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:03:24.661163 [info ] [MainThread]: 
[0m03:03:24.662165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:03:24.663165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:03:24.751173 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:03:24.752170 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:03:24.752170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:03:24.806019 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.053 seconds
[0m03:03:24.807022 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:03:24.808017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_snapshots)
[0m03:03:24.809016 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "snapshots"
"
[0m03:03:24.813016 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_snapshots"
[0m03:03:24.813016 [debug] [ThreadPool]: On create_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_snapshots"} */
create schema if not exists "snapshots"
[0m03:03:24.814016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:03:24.861533 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.048 seconds
[0m03:03:24.863532 [debug] [ThreadPool]: On create_web_scraper_snapshots: COMMIT
[0m03:03:24.863532 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_snapshots"
[0m03:03:24.863532 [debug] [ThreadPool]: On create_web_scraper_snapshots: COMMIT
[0m03:03:24.866533 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m03:03:24.867535 [debug] [ThreadPool]: On create_web_scraper_snapshots: Close
[0m03:03:24.872533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m03:03:24.877532 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:03:24.878534 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:03:24.878534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:03:24.931542 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.053 seconds
[0m03:03:24.932534 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:03:24.933534 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:03:24.934532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m03:03:24.937536 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:03:24.937536 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:03:24.938533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:03:24.985414 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.047 seconds
[0m03:03:24.987410 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:03:24.987410 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:03:24.988414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books)
[0m03:03:24.990410 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:03:24.990410 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:03:24.991415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:03:25.043409 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.052 seconds
[0m03:03:25.045418 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:03:25.045418 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:03:25.046417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:03:25.049415 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:03:25.049415 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:03:25.050416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:03:25.099932 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m03:03:25.101932 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:03:25.101932 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:03:25.107934 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:25.107934 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:03:25.108937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:03:25.158936 [debug] [MainThread]: SQL status: SELECT 7 in 0.050 seconds
[0m03:03:25.161448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa097644-9b9c-462a-b2dc-cc02041c1396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B33EE610>]}
[0m03:03:25.161448 [debug] [MainThread]: On master: ROLLBACK
[0m03:03:25.162447 [debug] [MainThread]: On master: COMMIT
[0m03:03:25.163449 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:25.163449 [debug] [MainThread]: On master: COMMIT
[0m03:03:25.164451 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:03:25.164451 [debug] [MainThread]: On master: Close
[0m03:03:25.169449 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m03:03:25.169449 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m03:03:25.170450 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m03:03:25.171450 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m03:03:25.178447 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m03:03:25.237934 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:03:25.238440 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m03:03:25.238440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:03:25.289056 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.050 seconds
[0m03:03:25.293359 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:03:25.293359 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:03:25.294359 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:03:25.295358 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m03:03:25.296358 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:03:25.297361 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      
  
    

  create  table "web_scraper"."snapshots"."books_price_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"

    ) sbq



  );
  
  
[0m03:03:25.339385 [debug] [Thread-1 (]: SQL status: SELECT 1057 in 0.042 seconds
[0m03:03:25.354394 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:03:25.354394 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:03:25.355397 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:03:25.357392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:03:25.359389 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m03:03:25.360905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa097644-9b9c-462a-b2dc-cc02041c1396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B3350F50>]}
[0m03:03:25.361903 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mSELECT 1057[0m in 0.19s]
[0m03:03:25.362907 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m03:03:25.364903 [debug] [MainThread]: On master: COMMIT
[0m03:03:25.364903 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:25.364903 [debug] [MainThread]: On master: COMMIT
[0m03:03:25.365908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:03:25.409910 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m03:03:25.410903 [debug] [MainThread]: On master: Close
[0m03:03:25.410903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:03:25.410903 [debug] [MainThread]: Connection 'create_web_scraper_snapshots' was properly closed.
[0m03:03:25.411905 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m03:03:25.411905 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m03:03:25.412909 [info ] [MainThread]: 
[0m03:03:25.412909 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m03:03:25.413906 [debug] [MainThread]: Command end result
[0m03:03:25.431906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:03:25.434905 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:03:25.439903 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:03:25.439903 [info ] [MainThread]: 
[0m03:03:25.440908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:03:25.441906 [info ] [MainThread]: 
[0m03:03:25.442905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:03:25.444917 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:03:25.444917 after 3.18 seconds
[0m03:03:25.444917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B1235A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B14A2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B14A3FD0>]}
[0m03:03:25.445915 [debug] [MainThread]: Flushing usage events
[0m03:03:26.075550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:03:36.238540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EA1AEE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E8F35BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EA1AEF10>]}


============================== 03:03:36.242534 | a6d69cbf-c7f1-4773-a66e-865633ca77c8 ==============================
[0m03:03:36.242534 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:03:36.243544 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m03:03:36.474825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6d69cbf-c7f1-4773-a66e-865633ca77c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EA483950>]}
[0m03:03:36.539307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6d69cbf-c7f1-4773-a66e-865633ca77c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E4DFC3D0>]}
[0m03:03:36.540307 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:03:36.879266 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:03:37.041492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:03:37.042829 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:03:37.042829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:03:37.047849 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:03:37.090742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6d69cbf-c7f1-4773-a66e-865633ca77c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EA2271D0>]}
[0m03:03:37.168189 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:03:37.170525 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:03:37.253214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6d69cbf-c7f1-4773-a66e-865633ca77c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EA42DC50>]}
[0m03:03:37.254598 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:03:37.255602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6d69cbf-c7f1-4773-a66e-865633ca77c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EA87AED0>]}
[0m03:03:37.257602 [info ] [MainThread]: 
[0m03:03:37.258612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:03:37.259618 [info ] [MainThread]: 
[0m03:03:37.260612 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:03:37.265610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m03:03:37.355235 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:03:37.355235 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:03:37.356232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:03:37.414005 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.058 seconds
[0m03:03:37.416010 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:03:37.416010 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:03:37.417008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:03:37.420008 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:03:37.420008 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:03:37.421014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:03:37.470902 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m03:03:37.471903 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:03:37.471903 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:03:37.473415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m03:03:37.476427 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:03:37.476427 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:03:37.477428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:03:37.526246 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.048 seconds
[0m03:03:37.527849 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:03:37.528957 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:03:37.528957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m03:03:37.530967 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:03:37.531964 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:03:37.531964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:03:37.581744 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m03:03:37.583746 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:03:37.583746 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:03:37.588756 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:37.589754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:03:37.589754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:03:37.647611 [debug] [MainThread]: SQL status: SELECT 7 in 0.058 seconds
[0m03:03:37.650615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6d69cbf-c7f1-4773-a66e-865633ca77c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EAD8E750>]}
[0m03:03:37.650615 [debug] [MainThread]: On master: ROLLBACK
[0m03:03:37.651615 [debug] [MainThread]: On master: COMMIT
[0m03:03:37.652614 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:37.652614 [debug] [MainThread]: On master: COMMIT
[0m03:03:37.653619 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:03:37.653619 [debug] [MainThread]: On master: Close
[0m03:03:37.658611 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:03:37.658611 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_stg_books_rating__One__Two__Three__Four__Five  [RUN]
[0m03:03:37.659621 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5'
[0m03:03:37.659621 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:03:37.673795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m03:03:37.675247 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:03:37.690260 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m03:03:37.691260 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m03:03:37.692261 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from "web_scraper"."books_books_silver"."stg_books"
    group by rating

)

select *
from all_values
where value_field not in (
    'One','Two','Three','Four','Five'
)



  
  
      
    ) dbt_internal_test
[0m03:03:37.692261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:03:37.740764 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m03:03:37.744765 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: ROLLBACK
[0m03:03:37.745767 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: Close
[0m03:03:37.745767 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_stg_books_rating__One__Two__Three__Four__Five ...... [[32mPASS[0m in 0.09s]
[0m03:03:37.746767 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:03:37.747764 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:03:37.747764 [info ] [Thread-1 (]: 2 of 3 START test not_null_stg_books_book_id ................................... [RUN]
[0m03:03:37.748764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m03:03:37.749764 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:03:37.754789 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m03:03:37.755787 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:03:37.758118 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m03:03:37.759130 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m03:03:37.760126 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select book_id
from "web_scraper"."books_books_silver"."stg_books"
where book_id is null



  
  
      
    ) dbt_internal_test
[0m03:03:37.760126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:03:37.808663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.049 seconds
[0m03:03:37.810661 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: ROLLBACK
[0m03:03:37.811674 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: Close
[0m03:03:37.811674 [info ] [Thread-1 (]: 2 of 3 PASS not_null_stg_books_book_id ......................................... [[32mPASS[0m in 0.06s]
[0m03:03:37.812662 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:03:37.813757 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:03:37.813757 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_books_book_id ..................................... [RUN]
[0m03:03:37.814757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m03:03:37.814757 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:03:37.819760 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m03:03:37.820757 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:03:37.822918 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m03:03:37.823923 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m03:03:37.824924 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_stg_books_book_id.ca28902f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    book_id as unique_field,
    count(*) as n_records

from "web_scraper"."books_books_silver"."stg_books"
where book_id is not null
group by book_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:03:37.824924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:03:37.876248 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.051 seconds
[0m03:03:37.877246 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: ROLLBACK
[0m03:03:37.878246 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: Close
[0m03:03:37.878246 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_books_book_id ........................................... [[32mPASS[0m in 0.06s]
[0m03:03:37.880253 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:03:37.881251 [debug] [MainThread]: On master: COMMIT
[0m03:03:37.882247 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:37.882247 [debug] [MainThread]: On master: COMMIT
[0m03:03:37.882247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:03:37.925893 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m03:03:37.926893 [debug] [MainThread]: On master: Close
[0m03:03:37.926893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:03:37.927894 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m03:03:37.927894 [debug] [MainThread]: Connection 'test.dbt_train.unique_stg_books_book_id.ca28902f83' was properly closed.
[0m03:03:37.927894 [info ] [MainThread]: 
[0m03:03:37.928896 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m03:03:37.930092 [debug] [MainThread]: Command end result
[0m03:03:37.950408 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:03:37.953757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:03:37.958763 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:03:37.959771 [info ] [MainThread]: 
[0m03:03:37.959771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:03:37.960871 [info ] [MainThread]: 
[0m03:03:37.961907 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m03:03:37.963901 [debug] [MainThread]: Command `dbt test` succeeded at 03:03:37.963901 after 1.81 seconds
[0m03:03:37.963901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E8F35850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EA230990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EA1A2350>]}
[0m03:03:37.964900 [debug] [MainThread]: Flushing usage events
[0m03:03:38.607125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:04:31.477631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B382BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B37AFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B37AFA90>]}


============================== 03:04:31.482632 | 554db328-0c32-4879-a949-a8c6de7034c4 ==============================
[0m03:04:31.482632 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:04:31.483630 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m03:04:31.718877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B3878490>]}
[0m03:04:31.783541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF3ED990>]}
[0m03:04:31.784540 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:04:32.131962 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:04:32.291351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:04:32.292351 [debug] [MainThread]: Partial parsing: added file: dbt_train://models\marts\dim_books_price_history.sql
[0m03:04:32.616003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:04:32.629217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B399AE10>]}
[0m03:04:32.709263 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:04:32.712263 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:04:32.734153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B39F0150>]}
[0m03:04:32.734153 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:04:32.735153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF2C5690>]}
[0m03:04:32.737209 [info ] [MainThread]: 
[0m03:04:32.738212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:04:32.739216 [info ] [MainThread]: 
[0m03:04:32.740213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:04:32.744214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:04:32.830827 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:04:32.831827 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:04:32.831827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:32.881282 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.049 seconds
[0m03:04:32.883282 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:04:32.885283 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:04:32.886283 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:04:32.886283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:32.934617 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.048 seconds
[0m03:04:32.935613 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:04:32.937613 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:04:32.938614 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:04:32.938614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:32.985682 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.047 seconds
[0m03:04:32.986682 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:04:32.988687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m03:04:32.993731 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:04:32.994731 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:04:32.994731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:33.046516 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.051 seconds
[0m03:04:33.047516 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:04:33.048516 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:04:33.049516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:04:33.052517 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:04:33.052517 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:04:33.053517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:33.105522 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m03:04:33.107517 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:04:33.107517 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:04:33.108516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m03:04:33.111517 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:04:33.111517 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:04:33.112521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:33.164098 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m03:04:33.166098 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:04:33.167098 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:04:33.168101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m03:04:33.170100 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:04:33.170100 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:04:33.171099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:33.225781 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.054 seconds
[0m03:04:33.226781 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:04:33.226781 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:04:33.232294 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:33.233303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:04:33.233303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:04:33.285852 [debug] [MainThread]: SQL status: SELECT 7 in 0.052 seconds
[0m03:04:33.288853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B314C550>]}
[0m03:04:33.288853 [debug] [MainThread]: On master: ROLLBACK
[0m03:04:33.289852 [debug] [MainThread]: On master: COMMIT
[0m03:04:33.290852 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:33.291852 [debug] [MainThread]: On master: COMMIT
[0m03:04:33.291852 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:04:33.292854 [debug] [MainThread]: On master: Close
[0m03:04:33.295852 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m03:04:33.296852 [info ] [Thread-1 (]: 1 of 7 START sql table model books.available_quantity .......................... [RUN]
[0m03:04:33.298854 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m03:04:33.299852 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m03:04:33.306852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m03:04:33.307856 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m03:04:33.336757 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m03:04:33.337758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m03:04:33.338761 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    


select *
from books
where id = 4011
  );
  
[0m03:04:33.338761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:04:33.399964 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.061 seconds
[0m03:04:33.408959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m03:04:33.408959 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity" rename to "available_quantity__dbt_backup"
[0m03:04:33.409959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:04:33.412962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m03:04:33.413959 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
alter table "web_scraper"."books"."available_quantity__dbt_tmp" rename to "available_quantity"
[0m03:04:33.414967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:04:33.427157 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m03:04:33.428661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m03:04:33.428661 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: COMMIT
[0m03:04:33.430668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:04:33.435673 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."available_quantity__dbt_backup"
[0m03:04:33.439679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m03:04:33.440936 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */
drop table if exists "web_scraper"."books"."available_quantity__dbt_backup" cascade
[0m03:04:33.443945 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:04:33.446954 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m03:04:33.448956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B115BCD0>]}
[0m03:04:33.449956 [info ] [Thread-1 (]: 1 of 7 OK created sql table model books.available_quantity ..................... [[32mSELECT 1[0m in 0.15s]
[0m03:04:33.449956 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m03:04:33.449956 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m03:04:33.451411 [info ] [Thread-1 (]: 2 of 7 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m03:04:33.451411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.dim_books_price_history)
[0m03:04:33.452422 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m03:04:33.454510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m03:04:33.456532 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m03:04:33.470746 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m03:04:33.472751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:04:33.472751 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m03:04:33.473746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:33.521908 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m03:04:33.524909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:04:33.525909 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m03:04:33.526912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:04:33.527909 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:04:33.528909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:04:33.529417 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:04:33.530429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:04:33.534434 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m03:04:33.536438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:04:33.536438 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m03:04:33.537434 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:04:33.538435 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m03:04:33.539434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B5547210>]}
[0m03:04:33.540434 [info ] [Thread-1 (]: 2 of 7 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.09s]
[0m03:04:33.541435 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m03:04:33.542436 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m03:04:33.542436 [info ] [Thread-1 (]: 3 of 7 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m03:04:33.543458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m03:04:33.544674 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m03:04:33.547128 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m03:04:33.548128 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m03:04:33.551130 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m03:04:33.552128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:04:33.552128 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- /*
--     Welcome to your first dbt model!
--     Did you know that you can also configure models directly within SQL files?
--     This will override configurations stated in dbt_project.yml

--     Try changing "table" to "view" below
-- */

-- 

-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

-- select *
-- from source_data

-- /*
--     Uncomment the line below to remove records with null `id` values
-- */

-- -- where id is not null
  );
  
[0m03:04:33.553133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:33.596640 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 38:   );
           ^

[0m03:04:33.597640 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: ROLLBACK
[0m03:04:33.597640 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m03:04:33.602673 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  syntax error at or near ")"
  LINE 38:   );
             ^
  compiled code at target\run\dbt_train\models\example\my_first_dbt_model.sql
[0m03:04:33.603671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B313DF50>]}
[0m03:04:33.604676 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model books.my_first_dbt_model ................. [[31mERROR[0m in 0.06s]
[0m03:04:33.605672 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m03:04:33.605672 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m03:04:33.606676 [debug] [Thread-4 (]: Marking all children of 'model.dbt_train.my_first_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  syntax error at or near ")"
  LINE 38:   );
             ^
  compiled code at target\run\dbt_train\models\example\my_first_dbt_model.sql.
[0m03:04:33.607671 [info ] [Thread-1 (]: 4 of 7 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m03:04:33.608671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m03:04:33.609671 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m03:04:33.611671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m03:04:33.612671 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m03:04:33.615684 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m03:04:33.616685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:04:33.617685 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m03:04:33.617685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:33.667701 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m03:04:33.671215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:04:33.671215 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m03:04:33.672214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:04:33.675214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:04:33.675214 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m03:04:33.677218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:04:33.679214 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:04:33.679214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:04:33.680214 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:04:33.683217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:04:33.685220 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m03:04:33.686221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:04:33.686221 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m03:04:33.689221 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:04:33.691220 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m03:04:33.691220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B39C45D0>]}
[0m03:04:33.692226 [info ] [Thread-1 (]: 4 of 7 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.08s]
[0m03:04:33.694220 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m03:04:33.694220 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m03:04:33.695223 [info ] [Thread-1 (]: 5 of 7 SKIP relation books.my_second_dbt_model ................................. [[33mSKIP[0m]
[0m03:04:33.696222 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m03:04:33.696222 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m03:04:33.697398 [info ] [Thread-1 (]: 6 of 7 START sql view model books_books.dim_books .............................. [RUN]
[0m03:04:33.697398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.dim_books)
[0m03:04:33.698563 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m03:04:33.701083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m03:04:33.702083 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m03:04:33.705087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m03:04:33.706110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:04:33.707106 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m03:04:33.707106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:33.860300 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.153 seconds
[0m03:04:33.863302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:04:33.863302 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m03:04:33.864300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:04:33.865300 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:04:33.867300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:04:33.868300 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:04:33.871300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:04:33.873300 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m03:04:33.874300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:04:33.874300 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m03:04:33.875305 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:04:33.876300 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m03:04:33.877304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B560B650>]}
[0m03:04:33.878444 [info ] [Thread-1 (]: 6 of 7 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.18s]
[0m03:04:33.878444 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m03:04:33.879503 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m03:04:33.879503 [info ] [Thread-1 (]: 7 of 7 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m03:04:33.880509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m03:04:33.881510 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m03:04:33.883504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m03:04:33.884511 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m03:04:33.887736 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m03:04:33.888735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:04:33.889735 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m03:04:33.889735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:33.940332 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m03:04:33.943326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:04:33.944327 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m03:04:33.945326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:04:33.946332 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:04:33.946332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:04:33.947327 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:04:33.953338 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m03:04:33.956342 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m03:04:33.957340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:04:33.957340 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m03:04:33.958340 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:04:33.960342 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m03:04:33.961344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '554db328-0c32-4879-a949-a8c6de7034c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B541AFD0>]}
[0m03:04:33.961344 [info ] [Thread-1 (]: 7 of 7 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.08s]
[0m03:04:33.962829 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m03:04:33.963957 [debug] [MainThread]: On master: COMMIT
[0m03:04:33.964955 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:33.964955 [debug] [MainThread]: On master: COMMIT
[0m03:04:33.964955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:04:34.010299 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m03:04:34.011294 [debug] [MainThread]: On master: Close
[0m03:04:34.011294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:04:34.012299 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:04:34.012299 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m03:04:34.012299 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m03:04:34.013296 [info ] [MainThread]: 
[0m03:04:34.013296 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m03:04:34.015301 [debug] [MainThread]: Command end result
[0m03:04:34.033733 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:04:34.036734 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:04:34.042733 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:04:34.042733 [info ] [MainThread]: 
[0m03:04:34.043738 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:04:34.044735 [info ] [MainThread]: 
[0m03:04:34.044735 [error] [MainThread]: [31mFailure in model my_first_dbt_model (models\example\my_first_dbt_model.sql)[0m
[0m03:04:34.045738 [error] [MainThread]:   Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  syntax error at or near ")"
  LINE 38:   );
             ^
  compiled code at target\run\dbt_train\models\example\my_first_dbt_model.sql
[0m03:04:34.045738 [info ] [MainThread]: 
[0m03:04:34.046734 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\my_first_dbt_model.sql
[0m03:04:34.046734 [info ] [MainThread]: 
[0m03:04:34.047733 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=7
[0m03:04:34.049733 [debug] [MainThread]: Command `dbt run` failed at 03:04:34.049733 after 2.66 seconds
[0m03:04:34.050737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B38342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B3834110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AAFA81D0>]}
[0m03:04:34.050737 [debug] [MainThread]: Flushing usage events
[0m03:04:34.893927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:05:13.501611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4C8AE910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4C8AEAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4C8AFC10>]}


============================== 03:05:13.505614 | d4fbd041-49db-4ad5-93fe-e7ab45620005 ==============================
[0m03:05:13.505614 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:05:13.506633 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'printer_width': '80', 'invocation_command': 'dbt run', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m03:05:13.740351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4C925E90>]}
[0m03:05:13.804880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F484F1FD0>]}
[0m03:05:13.805879 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:05:14.151912 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:05:14.336838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:05:14.336838 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\available_quantity.sql
[0m03:05:14.650814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:05:14.663782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4CAB3750>]}
[0m03:05:14.739808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:05:14.742810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:05:14.764330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E22EFD0>]}
[0m03:05:14.765328 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:05:14.765328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4C8A38D0>]}
[0m03:05:14.767332 [info ] [MainThread]: 
[0m03:05:14.768330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:14.769331 [info ] [MainThread]: 
[0m03:05:14.770330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:14.774330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:05:14.862949 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:05:14.863950 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:05:14.863950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:14.913287 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.050 seconds
[0m03:05:14.915286 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:05:14.917286 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:05:14.917286 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:05:14.918287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:14.962984 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.045 seconds
[0m03:05:14.965011 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:05:14.966015 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:05:14.967445 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:05:14.967445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:15.017799 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.050 seconds
[0m03:05:15.018799 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:05:15.020796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m03:05:15.025801 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:05:15.026797 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:05:15.026797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:15.081629 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.055 seconds
[0m03:05:15.083711 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:05:15.083711 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:05:15.084715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books)
[0m03:05:15.087712 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:05:15.088713 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:05:15.088713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:15.139353 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.050 seconds
[0m03:05:15.140352 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:05:15.141355 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:05:15.142352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:05:15.144352 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:05:15.144352 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:05:15.145642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:15.200582 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.055 seconds
[0m03:05:15.201624 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:05:15.202626 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:05:15.203628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m03:05:15.206080 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:05:15.207079 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:05:15.207079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:15.255877 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.049 seconds
[0m03:05:15.257877 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:05:15.257877 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:05:15.263115 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:15.263115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:05:15.264170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:05:15.317108 [debug] [MainThread]: SQL status: SELECT 8 in 0.053 seconds
[0m03:05:15.319124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E0EA710>]}
[0m03:05:15.320121 [debug] [MainThread]: On master: ROLLBACK
[0m03:05:15.320121 [debug] [MainThread]: On master: COMMIT
[0m03:05:15.321121 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:15.321121 [debug] [MainThread]: On master: COMMIT
[0m03:05:15.322122 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:15.322122 [debug] [MainThread]: On master: Close
[0m03:05:15.326322 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m03:05:15.326322 [info ] [Thread-1 (]: 1 of 7 START sql table model books.available_quantity .......................... [RUN]
[0m03:05:15.328363 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m03:05:15.328363 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m03:05:15.338360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m03:05:15.339365 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m03:05:15.372888 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m03:05:15.373888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m03:05:15.373888 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    -- 


-- select *
-- from web_scraper.books
-- where id = 4011
  );
  
[0m03:05:15.374898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:05:15.416888 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 18:   );
           ^

[0m03:05:15.417887 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: ROLLBACK
[0m03:05:15.418887 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m03:05:15.423885 [debug] [Thread-1 (]: Database Error in model available_quantity (models\example\available_quantity.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m03:05:15.425887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E5DCE10>]}
[0m03:05:15.425887 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model books.available_quantity ................. [[31mERROR[0m in 0.10s]
[0m03:05:15.427892 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m03:05:15.427892 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m03:05:15.427892 [debug] [Thread-4 (]: Marking all children of 'model.dbt_train.available_quantity' to be skipped because of status 'error'.  Reason: Database Error in model available_quantity (models\example\available_quantity.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql.
[0m03:05:15.428892 [info ] [Thread-1 (]: 2 of 7 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m03:05:15.429964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.dim_books_price_history)
[0m03:05:15.431129 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m03:05:15.433131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m03:05:15.434132 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m03:05:15.448206 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m03:05:15.449207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:15.450205 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m03:05:15.451207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:15.495903 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m03:05:15.500904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:15.501904 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m03:05:15.502903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:05:15.505906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:15.505906 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m03:05:15.506903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:05:15.519900 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:05:15.519900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:15.520906 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:05:15.526825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m03:05:15.532268 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m03:05:15.536266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:15.537572 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m03:05:15.539585 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:05:15.541584 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m03:05:15.541584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E4BFC10>]}
[0m03:05:15.542585 [info ] [Thread-1 (]: 2 of 7 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.11s]
[0m03:05:15.543582 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m03:05:15.544595 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m03:05:15.545583 [info ] [Thread-1 (]: 3 of 7 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m03:05:15.546585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m03:05:15.546585 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m03:05:15.549594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m03:05:15.550594 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m03:05:15.554594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m03:05:15.556595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:05:15.556595 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- /*
--     Welcome to your first dbt model!
--     Did you know that you can also configure models directly within SQL files?
--     This will override configurations stated in dbt_project.yml

--     Try changing "table" to "view" below
-- */

-- 

-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

-- select *
-- from source_data

-- /*
--     Uncomment the line below to remove records with null `id` values
-- */

-- -- where id is not null
  );
  
[0m03:05:15.557591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:15.600699 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 38:   );
           ^

[0m03:05:15.601700 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: ROLLBACK
[0m03:05:15.601700 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m03:05:15.604055 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  syntax error at or near ")"
  LINE 38:   );
             ^
  compiled code at target\run\dbt_train\models\example\my_first_dbt_model.sql
[0m03:05:15.605052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E6B7810>]}
[0m03:05:15.606055 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model books.my_first_dbt_model ................. [[31mERROR[0m in 0.06s]
[0m03:05:15.606055 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m03:05:15.607425 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m03:05:15.607425 [debug] [Thread-4 (]: Marking all children of 'model.dbt_train.my_first_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  syntax error at or near ")"
  LINE 38:   );
             ^
  compiled code at target\run\dbt_train\models\example\my_first_dbt_model.sql.
[0m03:05:15.608446 [info ] [Thread-1 (]: 4 of 7 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m03:05:15.609450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m03:05:15.609450 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m03:05:15.611818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m03:05:15.612832 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m03:05:15.615841 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m03:05:15.617845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:15.617845 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m03:05:15.618842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:15.675796 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m03:05:15.678795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:15.678795 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m03:05:15.679789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:05:15.682102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:15.683113 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m03:05:15.684117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:05:15.685158 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:05:15.686159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:15.686159 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:05:15.688156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:05:15.690296 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m03:05:15.691296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:15.691296 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m03:05:15.694301 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m03:05:15.696294 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m03:05:15.697298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E6B4AD0>]}
[0m03:05:15.698296 [info ] [Thread-1 (]: 4 of 7 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.09s]
[0m03:05:15.698296 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m03:05:15.699298 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m03:05:15.700297 [info ] [Thread-1 (]: 5 of 7 SKIP relation books.my_second_dbt_model ................................. [[33mSKIP[0m]
[0m03:05:15.700297 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m03:05:15.701297 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m03:05:15.701297 [info ] [Thread-1 (]: 6 of 7 START sql view model books_books.dim_books .............................. [RUN]
[0m03:05:15.702297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.dim_books)
[0m03:05:15.702297 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m03:05:15.705296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m03:05:15.706300 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m03:05:15.709382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m03:05:15.709382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:05:15.710523 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m03:05:15.710523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:15.757442 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m03:05:15.760493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:05:15.761492 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m03:05:15.761492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:05:15.763510 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:05:15.764523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:05:15.764523 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:05:15.769976 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m03:05:15.773164 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m03:05:15.773164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:05:15.774163 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m03:05:15.775193 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:05:15.776349 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m03:05:15.777363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E6B4A50>]}
[0m03:05:15.777363 [info ] [Thread-1 (]: 6 of 7 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m03:05:15.778393 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m03:05:15.779395 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m03:05:15.779395 [info ] [Thread-1 (]: 7 of 7 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m03:05:15.780425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m03:05:15.780425 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m03:05:15.784479 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m03:05:15.785469 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m03:05:15.788471 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m03:05:15.789469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:05:15.790470 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m03:05:15.790470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:15.845163 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m03:05:15.848160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:05:15.849164 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m03:05:15.850164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:05:15.851166 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:05:15.852169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:05:15.852169 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:05:15.853168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:05:15.856073 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m03:05:15.857071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:05:15.857071 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m03:05:15.858071 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:05:15.859070 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m03:05:15.860069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4fbd041-49db-4ad5-93fe-e7ab45620005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E6CBD50>]}
[0m03:05:15.860069 [info ] [Thread-1 (]: 7 of 7 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.08s]
[0m03:05:15.862090 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m03:05:15.863099 [debug] [MainThread]: On master: COMMIT
[0m03:05:15.863099 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:15.863099 [debug] [MainThread]: On master: COMMIT
[0m03:05:15.864536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:05:15.912513 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m03:05:15.913513 [debug] [MainThread]: On master: Close
[0m03:05:15.913513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:15.914518 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:05:15.914518 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m03:05:15.914518 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m03:05:15.915508 [info ] [MainThread]: 
[0m03:05:15.916510 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m03:05:15.917509 [debug] [MainThread]: Command end result
[0m03:05:15.935591 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:05:15.938590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:05:15.943590 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:05:15.943590 [info ] [MainThread]: 
[0m03:05:15.945038 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:05:15.946185 [info ] [MainThread]: 
[0m03:05:15.946185 [error] [MainThread]: [31mFailure in model available_quantity (models\example\available_quantity.sql)[0m
[0m03:05:15.947194 [error] [MainThread]:   Database Error in model available_quantity (models\example\available_quantity.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m03:05:15.948195 [info ] [MainThread]: 
[0m03:05:15.949202 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\available_quantity.sql
[0m03:05:15.949202 [info ] [MainThread]: 
[0m03:05:15.950200 [error] [MainThread]: [31mFailure in model my_first_dbt_model (models\example\my_first_dbt_model.sql)[0m
[0m03:05:15.950200 [error] [MainThread]:   Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  syntax error at or near ")"
  LINE 38:   );
             ^
  compiled code at target\run\dbt_train\models\example\my_first_dbt_model.sql
[0m03:05:15.951201 [info ] [MainThread]: 
[0m03:05:15.951201 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\my_first_dbt_model.sql
[0m03:05:15.952203 [info ] [MainThread]: 
[0m03:05:15.953202 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=7
[0m03:05:15.955202 [debug] [MainThread]: Command `dbt run` failed at 03:05:15.954200 after 2.55 seconds
[0m03:05:15.955202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4C925150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4C9271D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F464F8290>]}
[0m03:05:15.956204 [debug] [MainThread]: Flushing usage events
[0m03:05:16.741040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:05:48.950852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD22AFA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD2326DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD2325110>]}


============================== 03:05:48.953851 | 5c6a242e-b3ea-49d0-8481-869c8202dd19 ==============================
[0m03:05:48.953851 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:05:48.955967 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m03:05:49.189250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD24DAED0>]}
[0m03:05:49.253817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DCCE50450>]}
[0m03:05:49.255818 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:05:49.600292 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:05:49.782548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:05:49.783548 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\my_first_dbt_model.sql
[0m03:05:49.784547 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\available_quantity.sql
[0m03:05:49.785547 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\my_second_dbt_model.sql
[0m03:05:50.101779 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:05:50.113798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD2528FD0>]}
[0m03:05:50.190321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:05:50.192325 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:05:50.214370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD24AF510>]}
[0m03:05:50.214370 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:05:50.215368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD20FF750>]}
[0m03:05:50.217487 [info ] [MainThread]: 
[0m03:05:50.218497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:50.219502 [info ] [MainThread]: 
[0m03:05:50.219502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:50.225751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:05:50.314571 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:05:50.315571 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:05:50.315571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:50.375131 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.059 seconds
[0m03:05:50.376131 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:05:50.378132 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:05:50.379131 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:05:50.379131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:50.428872 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.049 seconds
[0m03:05:50.429868 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:05:50.431872 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:05:50.432868 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:05:50.432868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:50.478877 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.046 seconds
[0m03:05:50.480877 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:05:50.481882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m03:05:50.487177 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:05:50.487177 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:05:50.488173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:50.540185 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.052 seconds
[0m03:05:50.541180 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:05:50.542572 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:05:50.543586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:05:50.545883 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:05:50.547903 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:05:50.547903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:50.600922 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.053 seconds
[0m03:05:50.602922 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:05:50.603923 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:05:50.603923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m03:05:50.607779 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:05:50.607779 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:05:50.608776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:50.668856 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.061 seconds
[0m03:05:50.670856 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:05:50.671868 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:05:50.672862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m03:05:50.674856 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:05:50.674856 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:05:50.675859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:50.726408 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.051 seconds
[0m03:05:50.728409 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:05:50.728409 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:05:50.734698 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:50.734698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:05:50.735693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:05:50.787121 [debug] [MainThread]: SQL status: SELECT 8 in 0.051 seconds
[0m03:05:50.789121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD29000D0>]}
[0m03:05:50.790123 [debug] [MainThread]: On master: ROLLBACK
[0m03:05:50.790123 [debug] [MainThread]: On master: COMMIT
[0m03:05:50.790123 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:50.791128 [debug] [MainThread]: On master: COMMIT
[0m03:05:50.791128 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:50.792133 [debug] [MainThread]: On master: Close
[0m03:05:50.795130 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m03:05:50.796322 [info ] [Thread-1 (]: 1 of 7 START sql table model books.available_quantity .......................... [RUN]
[0m03:05:50.797351 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m03:05:50.797351 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m03:05:50.804349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m03:05:50.805345 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m03:05:50.835424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m03:05:50.836423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m03:05:50.836423 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    


select *
from web_scraper.books
where id = 4011
  );
  
[0m03:05:50.836423 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:05:50.883926 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "web_scraper.books" does not exist
LINE 16: from web_scraper.books
              ^

[0m03:05:50.884926 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: ROLLBACK
[0m03:05:50.886932 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m03:05:50.891744 [debug] [Thread-1 (]: Database Error in model available_quantity (models\example\available_quantity.sql)
  relation "web_scraper.books" does not exist
  LINE 16: from web_scraper.books
                ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m03:05:50.893754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD2F69990>]}
[0m03:05:50.893754 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model books.available_quantity ................. [[31mERROR[0m in 0.09s]
[0m03:05:50.895745 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m03:05:50.895745 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m03:05:50.896744 [debug] [Thread-4 (]: Marking all children of 'model.dbt_train.available_quantity' to be skipped because of status 'error'.  Reason: Database Error in model available_quantity (models\example\available_quantity.sql)
  relation "web_scraper.books" does not exist
  LINE 16: from web_scraper.books
                ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql.
[0m03:05:50.896744 [info ] [Thread-1 (]: 2 of 7 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m03:05:50.897754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.dim_books_price_history)
[0m03:05:50.898744 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m03:05:50.900746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m03:05:50.902048 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m03:05:50.916043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m03:05:50.917047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:50.918043 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m03:05:50.918043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:50.969883 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m03:05:50.974879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:50.975879 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m03:05:50.976882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:05:50.979880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:50.979880 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m03:05:50.980880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:05:50.993884 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:05:50.993884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:50.994896 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:05:50.997889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:05:51.002884 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m03:05:51.006401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:05:51.007401 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m03:05:51.009402 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:05:51.011404 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m03:05:51.012404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD2EF98D0>]}
[0m03:05:51.013405 [info ] [Thread-1 (]: 2 of 7 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.11s]
[0m03:05:51.013405 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m03:05:51.014402 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m03:05:51.014402 [info ] [Thread-1 (]: 3 of 7 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m03:05:51.015401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m03:05:51.015401 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m03:05:51.020406 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m03:05:51.021402 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m03:05:51.023768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m03:05:51.024800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:05:51.025803 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:05:51.025803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:51.074097 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.048 seconds
[0m03:05:51.080097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:05:51.080097 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:05:51.081099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:05:51.084196 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:05:51.084196 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:05:51.085196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:05:51.087201 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:05:51.087201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:05:51.088201 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:05:51.091201 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:05:51.093203 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m03:05:51.096206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:05:51.096206 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m03:05:51.100201 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:05:51.101201 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m03:05:51.102204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD4085590>]}
[0m03:05:51.103206 [info ] [Thread-1 (]: 3 of 7 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.09s]
[0m03:05:51.103206 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m03:05:51.104202 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m03:05:51.104202 [info ] [Thread-1 (]: 4 of 7 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m03:05:51.105707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m03:05:51.105707 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m03:05:51.108715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m03:05:51.109719 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m03:05:51.112712 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m03:05:51.113714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:51.113714 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m03:05:51.114713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:51.167258 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.053 seconds
[0m03:05:51.170258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:51.170258 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m03:05:51.171258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:05:51.174640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:51.174640 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m03:05:51.175640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:05:51.177640 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:05:51.177640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:51.178643 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:05:51.179644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:05:51.181638 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m03:05:51.182646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:05:51.182646 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m03:05:51.185648 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:05:51.186650 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m03:05:51.187646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD2F63750>]}
[0m03:05:51.188651 [info ] [Thread-1 (]: 4 of 7 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.08s]
[0m03:05:51.189848 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m03:05:51.189848 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m03:05:51.190847 [info ] [Thread-1 (]: 5 of 7 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m03:05:51.192177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m03:05:51.192177 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m03:05:51.196386 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m03:05:51.197381 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m03:05:51.200678 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m03:05:51.201672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:05:51.201672 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m03:05:51.201672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:51.254080 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m03:05:51.257080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:05:51.258084 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:05:51.258084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:05:51.259454 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:05:51.260452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:05:51.260452 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:05:51.262459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:05:51.264454 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m03:05:51.265454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:05:51.265454 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m03:05:51.266453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:05:51.267453 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m03:05:51.268455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD40E7250>]}
[0m03:05:51.268455 [info ] [Thread-1 (]: 5 of 7 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:05:51.269959 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m03:05:51.270946 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m03:05:51.270946 [info ] [Thread-1 (]: 6 of 7 START sql view model books_books.dim_books .............................. [RUN]
[0m03:05:51.271951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m03:05:51.272945 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m03:05:51.274946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m03:05:51.275950 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m03:05:51.279020 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m03:05:51.280016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:05:51.280016 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m03:05:51.281232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:51.325408 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m03:05:51.328654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:05:51.329186 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m03:05:51.329721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:05:51.330794 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:05:51.331325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:05:51.331863 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:05:51.332934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:05:51.335516 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m03:05:51.336515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:05:51.336515 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m03:05:51.337515 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:05:51.338515 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m03:05:51.339791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD24AC8D0>]}
[0m03:05:51.340801 [info ] [Thread-1 (]: 6 of 7 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m03:05:51.341803 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m03:05:51.342309 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m03:05:51.342309 [info ] [Thread-1 (]: 7 of 7 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m03:05:51.343691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m03:05:51.344230 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m03:05:51.346441 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m03:05:51.347510 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m03:05:51.350136 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m03:05:51.351389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:05:51.351389 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m03:05:51.352407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:51.402808 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m03:05:51.408322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:05:51.408322 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m03:05:51.409320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:05:51.410320 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:05:51.411320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:05:51.411320 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:05:51.413320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:05:51.415326 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m03:05:51.415326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:05:51.416320 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m03:05:51.417320 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:05:51.418320 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m03:05:51.419320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6a242e-b3ea-49d0-8481-869c8202dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD409C290>]}
[0m03:05:51.419320 [info ] [Thread-1 (]: 7 of 7 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.08s]
[0m03:05:51.420324 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m03:05:51.422325 [debug] [MainThread]: On master: COMMIT
[0m03:05:51.422325 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:51.423320 [debug] [MainThread]: On master: COMMIT
[0m03:05:51.423320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:05:51.465809 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m03:05:51.465809 [debug] [MainThread]: On master: Close
[0m03:05:51.466808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:51.466808 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:05:51.467810 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m03:05:51.467810 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m03:05:51.468826 [info ] [MainThread]: 
[0m03:05:51.468826 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m03:05:51.470843 [debug] [MainThread]: Command end result
[0m03:05:51.488841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:05:51.491317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:05:51.496364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:05:51.497367 [info ] [MainThread]: 
[0m03:05:51.497367 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:05:51.498780 [info ] [MainThread]: 
[0m03:05:51.499803 [error] [MainThread]: [31mFailure in model available_quantity (models\example\available_quantity.sql)[0m
[0m03:05:51.499803 [error] [MainThread]:   Database Error in model available_quantity (models\example\available_quantity.sql)
  relation "web_scraper.books" does not exist
  LINE 16: from web_scraper.books
                ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m03:05:51.501072 [info ] [MainThread]: 
[0m03:05:51.502069 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\available_quantity.sql
[0m03:05:51.502069 [info ] [MainThread]: 
[0m03:05:51.503070 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m03:05:51.504069 [debug] [MainThread]: Command `dbt run` failed at 03:05:51.504069 after 2.64 seconds
[0m03:05:51.504069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DCBE382D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DCBE38290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DCCE1FB50>]}
[0m03:05:51.505071 [debug] [MainThread]: Flushing usage events
[0m03:05:52.369242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:06:05.244867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325BAFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325C26F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325BA3090>]}


============================== 03:06:05.249471 | 32c3e8f0-0654-47c9-b888-6a8ee4e665a5 ==============================
[0m03:06:05.249471 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:06:05.250481 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m03:06:05.483057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325DACB10>]}
[0m03:06:05.548918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3207DE1D0>]}
[0m03:06:05.550920 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:06:05.902785 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:06:06.072506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:06:06.073506 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\available_quantity.sql
[0m03:06:06.385783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:06:06.397980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325EFDC10>]}
[0m03:06:06.476543 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:06:06.479553 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:06:06.499683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325D9F1D0>]}
[0m03:06:06.500692 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:06:06.501683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325DD95D0>]}
[0m03:06:06.503036 [info ] [MainThread]: 
[0m03:06:06.504045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:06:06.505054 [info ] [MainThread]: 
[0m03:06:06.506064 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:06:06.510063 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:06:06.596100 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:06:06.597482 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:06:06.597482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:06:06.645747 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.048 seconds
[0m03:06:06.647322 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:06:06.649453 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:06:06.649985 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:06:06.650522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:06.695992 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.046 seconds
[0m03:06:06.697997 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:06:06.700994 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:06:06.700994 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:06:06.702200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:06.745815 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.044 seconds
[0m03:06:06.746815 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:06:06.748817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m03:06:06.753930 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:06:06.754929 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:06:06.754929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:06:06.807125 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m03:06:06.809125 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:06:06.810126 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:06:06.810126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m03:06:06.814125 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:06:06.814125 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:06:06.814125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:06.864320 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m03:06:06.866327 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:06:06.866327 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:06:06.867577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books)
[0m03:06:06.870077 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:06:06.870077 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:06:06.871079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:06.921667 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.051 seconds
[0m03:06:06.922957 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:06:06.923968 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:06:06.923968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books_books_silver)
[0m03:06:06.926824 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:06:06.927849 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:06:06.927849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:06.977452 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.049 seconds
[0m03:06:06.978454 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:06:06.979452 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:06:06.983452 [debug] [MainThread]: Using postgres connection "master"
[0m03:06:06.983452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:06:06.984454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:06:07.038963 [debug] [MainThread]: SQL status: SELECT 8 in 0.055 seconds
[0m03:06:07.040968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A327842A90>]}
[0m03:06:07.041963 [debug] [MainThread]: On master: ROLLBACK
[0m03:06:07.041963 [debug] [MainThread]: On master: COMMIT
[0m03:06:07.042969 [debug] [MainThread]: Using postgres connection "master"
[0m03:06:07.043963 [debug] [MainThread]: On master: COMMIT
[0m03:06:07.043963 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:06:07.044968 [debug] [MainThread]: On master: Close
[0m03:06:07.049133 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m03:06:07.050129 [info ] [Thread-1 (]: 1 of 7 START sql table model books.available_quantity .......................... [RUN]
[0m03:06:07.051128 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m03:06:07.051128 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m03:06:07.058141 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m03:06:07.059138 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m03:06:07.088137 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m03:06:07.089149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m03:06:07.089149 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    -- 


-- select *
-- from web_scraper.books
-- where id = 4011
  );
  
[0m03:06:07.090608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:06:07.133462 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 18:   );
           ^

[0m03:06:07.134550 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: ROLLBACK
[0m03:06:07.134550 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m03:06:07.140249 [debug] [Thread-1 (]: Database Error in model available_quantity (models\example\available_quantity.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m03:06:07.142248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325F16490>]}
[0m03:06:07.143248 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model books.available_quantity ................. [[31mERROR[0m in 0.09s]
[0m03:06:07.144585 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m03:06:07.144585 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m03:06:07.145580 [debug] [Thread-4 (]: Marking all children of 'model.dbt_train.available_quantity' to be skipped because of status 'error'.  Reason: Database Error in model available_quantity (models\example\available_quantity.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql.
[0m03:06:07.145580 [info ] [Thread-1 (]: 2 of 7 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m03:06:07.146577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.dim_books_price_history)
[0m03:06:07.147860 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m03:06:07.149951 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m03:06:07.150955 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m03:06:07.166064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m03:06:07.167060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:06:07.167060 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m03:06:07.168060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:07.220251 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m03:06:07.226256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:06:07.226256 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m03:06:07.227260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:07.230333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:06:07.231333 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m03:06:07.231333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:07.244465 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:06:07.245465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:06:07.245465 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:06:07.248474 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:06:07.253473 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m03:06:07.257472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:06:07.258473 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m03:06:07.260473 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:06:07.262488 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m03:06:07.262488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3278E2550>]}
[0m03:06:07.263487 [info ] [Thread-1 (]: 2 of 7 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.12s]
[0m03:06:07.265503 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m03:06:07.265503 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m03:06:07.266559 [info ] [Thread-1 (]: 3 of 7 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m03:06:07.266559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m03:06:07.267571 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m03:06:07.270569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m03:06:07.271569 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m03:06:07.275885 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m03:06:07.276888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:06:07.277889 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:06:07.277889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:07.330612 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.052 seconds
[0m03:06:07.336611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:06:07.336611 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:06:07.337612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:07.340612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:06:07.340612 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:06:07.341612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:07.342618 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:06:07.343723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:06:07.343723 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:06:07.358773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m03:06:07.361768 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m03:06:07.363768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:06:07.363768 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m03:06:07.368768 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:06:07.369768 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m03:06:07.370768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325F14ED0>]}
[0m03:06:07.370768 [info ] [Thread-1 (]: 3 of 7 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.10s]
[0m03:06:07.371770 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m03:06:07.372786 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m03:06:07.373801 [info ] [Thread-1 (]: 4 of 7 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m03:06:07.373801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m03:06:07.375020 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m03:06:07.377020 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m03:06:07.378017 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m03:06:07.381063 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m03:06:07.382052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:06:07.383054 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m03:06:07.383054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:07.443797 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m03:06:07.446792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:06:07.446792 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m03:06:07.447792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:07.450902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:06:07.450902 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m03:06:07.452032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:07.454143 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:06:07.454143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:06:07.455143 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:06:07.456138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:07.459140 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m03:06:07.460139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:06:07.460139 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m03:06:07.463647 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m03:06:07.465657 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m03:06:07.466658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3279B93D0>]}
[0m03:06:07.466658 [info ] [Thread-1 (]: 4 of 7 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.09s]
[0m03:06:07.468661 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m03:06:07.468661 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m03:06:07.469657 [info ] [Thread-1 (]: 5 of 7 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m03:06:07.470656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m03:06:07.470656 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m03:06:07.473654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m03:06:07.474655 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m03:06:07.477659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m03:06:07.478859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:06:07.478859 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m03:06:07.479859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:07.529416 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m03:06:07.533418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:06:07.534417 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:06:07.535414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:07.536413 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:06:07.536413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:06:07.537413 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:06:07.538413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:06:07.541413 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m03:06:07.541413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:06:07.542413 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m03:06:07.543413 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:06:07.544414 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m03:06:07.545412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3279EE550>]}
[0m03:06:07.545412 [info ] [Thread-1 (]: 5 of 7 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:06:07.547636 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m03:06:07.547636 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m03:06:07.548631 [info ] [Thread-1 (]: 6 of 7 START sql view model books_books.dim_books .............................. [RUN]
[0m03:06:07.549686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m03:06:07.549686 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m03:06:07.552687 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m03:06:07.554689 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m03:06:07.557690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m03:06:07.557690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:06:07.558687 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m03:06:07.559688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:07.609730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m03:06:07.612728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:06:07.613728 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m03:06:07.614737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:06:07.615728 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:06:07.615728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:06:07.616734 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:06:07.640237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m03:06:07.643237 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m03:06:07.644240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:06:07.644240 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m03:06:07.645241 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:06:07.646520 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m03:06:07.647533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3279D9410>]}
[0m03:06:07.647533 [info ] [Thread-1 (]: 6 of 7 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.10s]
[0m03:06:07.649533 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m03:06:07.649533 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m03:06:07.650537 [info ] [Thread-1 (]: 7 of 7 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m03:06:07.651535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m03:06:07.651535 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m03:06:07.654532 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m03:06:07.655533 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m03:06:07.658537 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m03:06:07.659533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:06:07.660534 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m03:06:07.660534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:06:07.711538 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m03:06:07.713542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:06:07.714543 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m03:06:07.715540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:06:07.717537 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:06:07.717537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:06:07.717537 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:06:07.721047 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:06:07.723051 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m03:06:07.724052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:06:07.725055 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m03:06:07.725055 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:06:07.727051 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m03:06:07.727051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32c3e8f0-0654-47c9-b888-6a8ee4e665a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325EBDBD0>]}
[0m03:06:07.728078 [info ] [Thread-1 (]: 7 of 7 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.08s]
[0m03:06:07.728078 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m03:06:07.729540 [debug] [MainThread]: On master: COMMIT
[0m03:06:07.730989 [debug] [MainThread]: Using postgres connection "master"
[0m03:06:07.732122 [debug] [MainThread]: On master: COMMIT
[0m03:06:07.732122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:06:07.772365 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m03:06:07.773364 [debug] [MainThread]: On master: Close
[0m03:06:07.774364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:06:07.774364 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:06:07.775600 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m03:06:07.775600 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m03:06:07.775600 [info ] [MainThread]: 
[0m03:06:07.776597 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m03:06:07.778594 [debug] [MainThread]: Command end result
[0m03:06:07.797649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:06:07.800646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:06:07.805652 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:06:07.805652 [info ] [MainThread]: 
[0m03:06:07.806661 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:06:07.807660 [info ] [MainThread]: 
[0m03:06:07.807660 [error] [MainThread]: [31mFailure in model available_quantity (models\example\available_quantity.sql)[0m
[0m03:06:07.809656 [error] [MainThread]:   Database Error in model available_quantity (models\example\available_quantity.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m03:06:07.809656 [info ] [MainThread]: 
[0m03:06:07.810658 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\available_quantity.sql
[0m03:06:07.810658 [info ] [MainThread]: 
[0m03:06:07.811662 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m03:06:07.812656 [debug] [MainThread]: Command `dbt run` failed at 03:06:07.812656 after 2.66 seconds
[0m03:06:07.813656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31F8081D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31F8085D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A325BA22D0>]}
[0m03:06:07.813656 [debug] [MainThread]: Flushing usage events
[0m03:06:08.586345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:07:01.511703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928C7AED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928C7AEB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928C7AFA10>]}


============================== 03:07:01.517019 | 94f976d2-ebc8-4c77-b17c-62fa548ad367 ==============================
[0m03:07:01.517019 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:07:01.518027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'no_print': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m03:07:01.752661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928C99F150>]}
[0m03:07:01.817468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192884F1A50>]}
[0m03:07:01.818468 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:07:02.165171 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:07:02.332214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:07:02.333214 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\example\available_quantity.sql
[0m03:07:02.648878 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:07:02.660881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928CA90310>]}
[0m03:07:02.741401 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:07:02.743419 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:07:02.763684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928C7F4090>]}
[0m03:07:02.765155 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:07:02.766174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928CB18E50>]}
[0m03:07:02.768166 [info ] [MainThread]: 
[0m03:07:02.769175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:07:02.769175 [info ] [MainThread]: 
[0m03:07:02.770167 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:07:02.775167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:07:02.861972 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:07:02.862970 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:07:02.862970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:02.922155 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.059 seconds
[0m03:07:02.923156 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:07:02.925156 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:07:02.926240 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:07:02.926240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:02.976223 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.049 seconds
[0m03:07:02.977223 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:07:02.980229 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:07:02.980229 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:07:02.981223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:03.025156 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.044 seconds
[0m03:07:03.026160 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:07:03.029212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m03:07:03.033754 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:07:03.033754 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:07:03.034756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:03.086759 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.052 seconds
[0m03:07:03.088961 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:07:03.088961 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:07:03.089974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books_books_silver)
[0m03:07:03.092003 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:07:03.093012 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:07:03.093012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:03.144674 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.051 seconds
[0m03:07:03.146680 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:07:03.146680 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:07:03.147679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m03:07:03.149675 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:07:03.150679 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:07:03.150679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:03.204015 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m03:07:03.205015 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:07:03.206016 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:07:03.206016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m03:07:03.209021 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:07:03.210016 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:07:03.210016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:03.261015 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.051 seconds
[0m03:07:03.262126 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:07:03.263137 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:07:03.268561 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:03.269095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:07:03.269635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:07:03.318798 [debug] [MainThread]: SQL status: SELECT 8 in 0.050 seconds
[0m03:07:03.321798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928CAE1110>]}
[0m03:07:03.321798 [debug] [MainThread]: On master: ROLLBACK
[0m03:07:03.322798 [debug] [MainThread]: On master: COMMIT
[0m03:07:03.322798 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:03.322798 [debug] [MainThread]: On master: COMMIT
[0m03:07:03.324075 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:07:03.324075 [debug] [MainThread]: On master: Close
[0m03:07:03.327931 [debug] [Thread-1 (]: Began running node model.dbt_train.available_quantity
[0m03:07:03.328932 [info ] [Thread-1 (]: 1 of 7 START sql table model books.available_quantity .......................... [RUN]
[0m03:07:03.329937 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.available_quantity'
[0m03:07:03.330931 [debug] [Thread-1 (]: Began compiling node model.dbt_train.available_quantity
[0m03:07:03.337933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.available_quantity"
[0m03:07:03.338943 [debug] [Thread-1 (]: Began executing node model.dbt_train.available_quantity
[0m03:07:03.367405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.available_quantity"
[0m03:07:03.369408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.available_quantity"
[0m03:07:03.369408 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.available_quantity"} */

  
    

  create  table "web_scraper"."books"."available_quantity__dbt_tmp"
  
  
    as
  
  (
    


select *
from web_scraper.books
where id = 4011
  );
  
[0m03:07:03.370412 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:07:03.416510 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "web_scraper.books" does not exist
LINE 16: from web_scraper.books
              ^

[0m03:07:03.417506 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: ROLLBACK
[0m03:07:03.417506 [debug] [Thread-1 (]: On model.dbt_train.available_quantity: Close
[0m03:07:03.422522 [debug] [Thread-1 (]: Database Error in model available_quantity (models\example\available_quantity.sql)
  relation "web_scraper.books" does not exist
  LINE 16: from web_scraper.books
                ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m03:07:03.424524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928E32BD50>]}
[0m03:07:03.425516 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model books.available_quantity ................. [[31mERROR[0m in 0.09s]
[0m03:07:03.426521 [debug] [Thread-1 (]: Finished running node model.dbt_train.available_quantity
[0m03:07:03.426521 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m03:07:03.427714 [debug] [Thread-4 (]: Marking all children of 'model.dbt_train.available_quantity' to be skipped because of status 'error'.  Reason: Database Error in model available_quantity (models\example\available_quantity.sql)
  relation "web_scraper.books" does not exist
  LINE 16: from web_scraper.books
                ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql.
[0m03:07:03.427714 [info ] [Thread-1 (]: 2 of 7 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m03:07:03.428718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.available_quantity, now model.dbt_train.dim_books_price_history)
[0m03:07:03.428718 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m03:07:03.432130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m03:07:03.433143 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m03:07:03.447148 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m03:07:03.448144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:07:03.448144 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m03:07:03.449144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:03.498722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m03:07:03.504722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:07:03.504722 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m03:07:03.505722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:07:03.507726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:07:03.508721 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m03:07:03.509725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:07:03.521728 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:07:03.522722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:07:03.522722 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:07:03.528959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m03:07:03.533975 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m03:07:03.537975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:07:03.537975 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m03:07:03.540975 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:07:03.543201 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m03:07:03.544209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928E44ACD0>]}
[0m03:07:03.544209 [info ] [Thread-1 (]: 2 of 7 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.12s]
[0m03:07:03.546206 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m03:07:03.547203 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m03:07:03.547203 [info ] [Thread-1 (]: 3 of 7 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m03:07:03.548223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m03:07:03.548223 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m03:07:03.551219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m03:07:03.552219 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m03:07:03.557229 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m03:07:03.558228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:07:03.558228 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:07:03.559230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:03.610388 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.052 seconds
[0m03:07:03.616388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:07:03.617388 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:07:03.618397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:07:03.621679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:07:03.621679 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:07:03.622679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:07:03.623682 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:07:03.624678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:07:03.624678 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:07:03.625692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:07:03.628098 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m03:07:03.631098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:07:03.631098 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m03:07:03.636100 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:07:03.637098 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m03:07:03.638099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928E5B4B50>]}
[0m03:07:03.638099 [info ] [Thread-1 (]: 3 of 7 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.09s]
[0m03:07:03.639401 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m03:07:03.640404 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m03:07:03.641399 [info ] [Thread-1 (]: 4 of 7 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m03:07:03.641399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m03:07:03.642399 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m03:07:03.644670 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m03:07:03.645672 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m03:07:03.648670 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m03:07:03.649674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:07:03.650672 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m03:07:03.650672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:03.701506 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m03:07:03.704503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:07:03.704503 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m03:07:03.706504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:07:03.708513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:07:03.708513 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m03:07:03.709507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:07:03.711504 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:07:03.711504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:07:03.711504 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:07:03.713721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:07:03.715726 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m03:07:03.715726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:07:03.716719 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m03:07:03.718720 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:07:03.719722 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m03:07:03.720719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928E4661D0>]}
[0m03:07:03.721728 [info ] [Thread-1 (]: 4 of 7 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.08s]
[0m03:07:03.723720 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m03:07:03.723720 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m03:07:03.724721 [info ] [Thread-1 (]: 5 of 7 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m03:07:03.725722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m03:07:03.725722 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m03:07:03.728720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m03:07:03.729729 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m03:07:03.732718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m03:07:03.733721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:07:03.733721 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m03:07:03.733721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:03.782758 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m03:07:03.786759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:07:03.787759 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:07:03.788762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:07:03.789759 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:07:03.790763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:07:03.790763 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:07:03.801281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m03:07:03.804280 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m03:07:03.804280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:07:03.805279 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m03:07:03.806283 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:07:03.808277 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m03:07:03.808277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928E62B990>]}
[0m03:07:03.809279 [info ] [Thread-1 (]: 5 of 7 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:07:03.810281 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m03:07:03.810281 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m03:07:03.811298 [info ] [Thread-1 (]: 6 of 7 START sql view model books_books.dim_books .............................. [RUN]
[0m03:07:03.811298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m03:07:03.812496 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m03:07:03.815494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m03:07:03.816495 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m03:07:03.819497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m03:07:03.821643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:07:03.821643 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m03:07:03.822658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:03.871790 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m03:07:03.873799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:07:03.874792 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m03:07:03.875797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:07:03.877193 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:07:03.878197 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:07:03.878197 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:07:03.882206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:07:03.885199 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m03:07:03.885199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:07:03.886198 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m03:07:03.887207 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:07:03.888200 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m03:07:03.889200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928E62B490>]}
[0m03:07:03.889200 [info ] [Thread-1 (]: 6 of 7 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:07:03.890641 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m03:07:03.890641 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m03:07:03.892150 [info ] [Thread-1 (]: 7 of 7 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m03:07:03.892150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m03:07:03.893447 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m03:07:03.895446 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m03:07:03.896932 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m03:07:03.899962 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m03:07:03.900959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:07:03.901960 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m03:07:03.901960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:03.951727 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m03:07:03.955719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:07:03.955719 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m03:07:03.956720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:07:03.957719 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:07:03.958728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:07:03.958728 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:07:03.960718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:07:03.962719 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m03:07:03.963719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:07:03.963719 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m03:07:03.964719 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:07:03.967127 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m03:07:03.967127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f976d2-ebc8-4c77-b17c-62fa548ad367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928E506310>]}
[0m03:07:03.968128 [info ] [Thread-1 (]: 7 of 7 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.07s]
[0m03:07:03.969136 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m03:07:03.970130 [debug] [MainThread]: On master: COMMIT
[0m03:07:03.971128 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:03.971128 [debug] [MainThread]: On master: COMMIT
[0m03:07:03.971128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:07:04.016482 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m03:07:04.017482 [debug] [MainThread]: On master: Close
[0m03:07:04.017482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:07:04.018487 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:07:04.018487 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m03:07:04.019566 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m03:07:04.019566 [info ] [MainThread]: 
[0m03:07:04.019566 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m03:07:04.022882 [debug] [MainThread]: Command end result
[0m03:07:04.041889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:07:04.043883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:07:04.049883 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:07:04.049883 [info ] [MainThread]: 
[0m03:07:04.050887 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:07:04.050887 [info ] [MainThread]: 
[0m03:07:04.051885 [error] [MainThread]: [31mFailure in model available_quantity (models\example\available_quantity.sql)[0m
[0m03:07:04.052884 [error] [MainThread]:   Database Error in model available_quantity (models\example\available_quantity.sql)
  relation "web_scraper.books" does not exist
  LINE 16: from web_scraper.books
                ^
  compiled code at target\run\dbt_train\models\example\available_quantity.sql
[0m03:07:04.053892 [info ] [MainThread]: 
[0m03:07:04.054883 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\example\available_quantity.sql
[0m03:07:04.054883 [info ] [MainThread]: 
[0m03:07:04.055886 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m03:07:04.056886 [debug] [MainThread]: Command `dbt run` failed at 03:07:04.056886 after 2.63 seconds
[0m03:07:04.057886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928C82ADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928C82BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928A9E6A10>]}
[0m03:07:04.058901 [debug] [MainThread]: Flushing usage events
[0m03:07:04.954235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:09:37.152619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2691AEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2691AEB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2691ADFD0>]}


============================== 03:09:37.155862 | c0c8a1bf-cac8-4a04-b649-eb208d56701f ==============================
[0m03:09:37.155862 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:09:37.157872 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m03:09:37.389634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B269229290>]}
[0m03:09:37.454872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B263E0CF10>]}
[0m03:09:37.455872 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:09:37.802853 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:09:37.968386 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m03:09:37.968386 [debug] [MainThread]: Partial parsing: deleted file: dbt_train://models\example\available_quantity.sql
[0m03:09:38.040948 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:09:38.053465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2697032D0>]}
[0m03:09:38.130521 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:09:38.133646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:09:38.210221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26951BA50>]}
[0m03:09:38.210221 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:09:38.211726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2698656D0>]}
[0m03:09:38.212747 [info ] [MainThread]: 
[0m03:09:38.213759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:38.214758 [info ] [MainThread]: 
[0m03:09:38.215755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:09:38.219117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:09:38.307634 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:09:38.307634 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:09:38.307634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:38.371327 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.063 seconds
[0m03:09:38.373329 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:09:38.375327 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:09:38.376327 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:09:38.376327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:38.425996 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.050 seconds
[0m03:09:38.426996 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:09:38.429637 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:09:38.429637 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:09:38.429637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:38.477147 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.046 seconds
[0m03:09:38.479141 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:09:38.481465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m03:09:38.485514 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:09:38.486521 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:09:38.486521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:38.538250 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m03:09:38.540594 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:09:38.540594 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:09:38.541618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m03:09:38.543634 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:09:38.544692 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:09:38.544692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:38.593739 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.048 seconds
[0m03:09:38.594739 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:09:38.595740 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:09:38.596744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books)
[0m03:09:38.599745 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:09:38.599745 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:09:38.599745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:38.650068 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.050 seconds
[0m03:09:38.653068 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:09:38.654068 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:09:38.655073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:09:38.657068 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:09:38.657068 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:09:38.658415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:38.714135 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.056 seconds
[0m03:09:38.716132 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:09:38.716132 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:09:38.721517 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:38.722523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:09:38.722523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:38.890019 [debug] [MainThread]: SQL status: SELECT 8 in 0.167 seconds
[0m03:09:38.893019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2698CFC90>]}
[0m03:09:38.893019 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:38.894028 [debug] [MainThread]: On master: COMMIT
[0m03:09:38.894028 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:38.894028 [debug] [MainThread]: On master: COMMIT
[0m03:09:38.895022 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:09:38.895022 [debug] [MainThread]: On master: Close
[0m03:09:38.899178 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m03:09:38.900179 [info ] [Thread-1 (]: 1 of 6 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m03:09:38.901183 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.dim_books_price_history'
[0m03:09:38.901183 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m03:09:38.907204 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m03:09:38.908206 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m03:09:38.934483 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m03:09:38.935483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:09:38.936501 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m03:09:38.936501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:09:38.989541 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m03:09:38.994533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:09:38.995534 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m03:09:38.996534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:09:38.999538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:09:38.999538 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m03:09:39.000534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:09:39.013706 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:09:39.015074 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:09:39.015074 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:09:39.021790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m03:09:39.028117 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m03:09:39.032118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:09:39.032118 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m03:09:39.036128 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m03:09:39.038123 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m03:09:39.040125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B269C6B690>]}
[0m03:09:39.041142 [info ] [Thread-1 (]: 1 of 6 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.14s]
[0m03:09:39.042164 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m03:09:39.043157 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m03:09:39.043157 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m03:09:39.044156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m03:09:39.045157 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m03:09:39.048668 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m03:09:39.049667 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m03:09:39.067276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m03:09:39.068286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:09:39.068286 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:09:39.069500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:39.230186 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.160 seconds
[0m03:09:39.235195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:09:39.236195 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:09:39.236195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:09:39.239654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:09:39.240656 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:09:39.241657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:09:39.243666 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:09:39.243666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:09:39.243666 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:09:39.245676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:09:39.247675 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m03:09:39.250182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:09:39.250182 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m03:09:39.254529 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:09:39.255543 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m03:09:39.256537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B269D7DF90>]}
[0m03:09:39.257552 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.21s]
[0m03:09:39.258550 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m03:09:39.258550 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m03:09:39.259551 [info ] [Thread-1 (]: 3 of 6 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m03:09:39.259551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m03:09:39.260774 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m03:09:39.263778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m03:09:39.264823 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m03:09:39.267243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m03:09:39.268267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:09:39.269387 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m03:09:39.269387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:39.323404 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m03:09:39.326404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:09:39.327405 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m03:09:39.328405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:09:39.330751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:09:39.331754 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m03:09:39.332760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:09:39.333764 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:09:39.333764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:09:39.334772 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:09:39.337772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:09:39.340772 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m03:09:39.340772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:09:39.341772 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m03:09:39.343772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:09:39.344772 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m03:09:39.345774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26992BA50>]}
[0m03:09:39.346772 [info ] [Thread-1 (]: 3 of 6 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.09s]
[0m03:09:39.346772 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m03:09:39.347774 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m03:09:39.349119 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m03:09:39.350328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m03:09:39.350328 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m03:09:39.354348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m03:09:39.355346 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m03:09:39.358411 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m03:09:39.359429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:09:39.360509 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m03:09:39.360509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:39.411220 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m03:09:39.414216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:09:39.415218 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:09:39.416221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:09:39.417216 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:09:39.417216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:09:39.418216 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:09:39.419221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:09:39.421216 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m03:09:39.422219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:09:39.422219 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m03:09:39.423221 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:09:39.424221 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m03:09:39.425216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B269E22610>]}
[0m03:09:39.426218 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:09:39.426218 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m03:09:39.427324 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m03:09:39.427324 [info ] [Thread-1 (]: 5 of 6 START sql view model books_books.dim_books .............................. [RUN]
[0m03:09:39.428344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m03:09:39.429541 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m03:09:39.431778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m03:09:39.432773 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m03:09:39.435283 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m03:09:39.436286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:09:39.437312 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m03:09:39.437312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:39.486090 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m03:09:39.489090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:09:39.490101 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m03:09:39.491114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:09:39.492106 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:09:39.493107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:09:39.493107 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:09:39.502107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m03:09:39.504555 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m03:09:39.505860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:09:39.505860 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m03:09:39.506910 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:09:39.508920 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m03:09:39.509914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B269C697D0>]}
[0m03:09:39.509914 [info ] [Thread-1 (]: 5 of 6 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:09:39.510912 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m03:09:39.510912 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m03:09:39.512912 [info ] [Thread-1 (]: 6 of 6 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m03:09:39.513929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m03:09:39.513929 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m03:09:39.515931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m03:09:39.516927 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m03:09:39.520478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m03:09:39.521476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:09:39.522478 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m03:09:39.522478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:39.572184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m03:09:39.577184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:09:39.577184 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m03:09:39.579184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:09:39.580184 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:09:39.581189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:09:39.581189 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:09:39.583205 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:09:39.586361 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m03:09:39.586361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:09:39.587361 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m03:09:39.588363 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:09:39.589367 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m03:09:39.590393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c8a1bf-cac8-4a04-b649-eb208d56701f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B269D0E3D0>]}
[0m03:09:39.590393 [info ] [Thread-1 (]: 6 of 6 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.08s]
[0m03:09:39.591888 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m03:09:39.592887 [debug] [MainThread]: On master: COMMIT
[0m03:09:39.592887 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:39.593887 [debug] [MainThread]: On master: COMMIT
[0m03:09:39.593887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:39.640182 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m03:09:39.641182 [debug] [MainThread]: On master: Close
[0m03:09:39.642182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:39.642182 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:09:39.643184 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m03:09:39.643184 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m03:09:39.643184 [info ] [MainThread]: 
[0m03:09:39.644184 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m03:09:39.645182 [debug] [MainThread]: Command end result
[0m03:09:39.664237 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:09:39.666234 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:09:39.671620 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:09:39.672624 [info ] [MainThread]: 
[0m03:09:39.672624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:39.673619 [info ] [MainThread]: 
[0m03:09:39.673619 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m03:09:39.675639 [debug] [MainThread]: Command `dbt run` succeeded at 03:09:39.675639 after 2.61 seconds
[0m03:09:39.675639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B269229A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26922BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2691A21D0>]}
[0m03:09:39.676640 [debug] [MainThread]: Flushing usage events
[0m03:09:40.491388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:09:46.678707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2073AEE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2073AEE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2073AE390>]}


============================== 03:09:46.681727 | 0e5888bc-b21a-489a-8dcb-3cb1a5b85406 ==============================
[0m03:09:46.681727 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:09:46.683730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m03:09:46.911637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e5888bc-b21a-489a-8dcb-3cb1a5b85406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2076876D0>]}
[0m03:09:46.975046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e5888bc-b21a-489a-8dcb-3cb1a5b85406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2030EE110>]}
[0m03:09:46.976046 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:09:47.314977 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:09:47.491460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:09:47.492463 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:09:47.492463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:09:47.498463 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:09:47.542121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e5888bc-b21a-489a-8dcb-3cb1a5b85406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A207A57790>]}
[0m03:09:47.618963 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:09:47.621981 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:09:47.643071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e5888bc-b21a-489a-8dcb-3cb1a5b85406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2079288D0>]}
[0m03:09:47.643071 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:09:47.644069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e5888bc-b21a-489a-8dcb-3cb1a5b85406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A207A75350>]}
[0m03:09:47.646283 [info ] [MainThread]: 
[0m03:09:47.647281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:47.648291 [info ] [MainThread]: 
[0m03:09:47.649284 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:09:47.650280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:09:47.796283 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:09:47.797489 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:09:47.798490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:47.855316 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.057 seconds
[0m03:09:47.856927 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:09:47.861856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m03:09:47.866580 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:09:47.867634 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:09:47.867634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:47.916352 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.048 seconds
[0m03:09:47.917348 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:09:47.918349 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:09:47.919354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_snapshots)
[0m03:09:47.922577 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:09:47.922577 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:09:47.923578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:47.977230 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.054 seconds
[0m03:09:47.979232 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:09:47.979232 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:09:47.980237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books)
[0m03:09:47.982425 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:09:47.983558 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:09:47.983558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:48.037049 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.053 seconds
[0m03:09:48.039048 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:09:48.040078 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:09:48.041113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m03:09:48.043106 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:09:48.043106 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:09:48.044472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:48.101956 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.058 seconds
[0m03:09:48.103957 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:09:48.103957 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:09:48.109086 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:48.109086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:09:48.110097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:48.165595 [debug] [MainThread]: SQL status: SELECT 8 in 0.055 seconds
[0m03:09:48.168592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e5888bc-b21a-489a-8dcb-3cb1a5b85406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A205D38910>]}
[0m03:09:48.168592 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:48.169593 [debug] [MainThread]: On master: COMMIT
[0m03:09:48.169593 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:48.170597 [debug] [MainThread]: On master: COMMIT
[0m03:09:48.170597 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:09:48.171593 [debug] [MainThread]: On master: Close
[0m03:09:48.174609 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m03:09:48.175609 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m03:09:48.176613 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m03:09:48.177611 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m03:09:48.183607 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m03:09:48.230405 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.231494 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price, price_excl_tax, price_incl_tax from (
                



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m03:09:48.232496 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:09:48.279697 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.048 seconds
[0m03:09:48.290700 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.290700 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:09:48.315781 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.023 seconds
[0m03:09:48.322788 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.322788 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:09:48.327087 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m03:09:48.365209 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.366209 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp030948359217"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:09:48.380475 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.014 seconds
[0m03:09:48.383474 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.384474 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp030948359217'
        
      order by ordinal_position

  
[0m03:09:48.389475 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.004 seconds
[0m03:09:48.392474 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.392474 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:09:48.396474 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:09:48.400475 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.400475 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp030948359217'
        
      order by ordinal_position

  
[0m03:09:48.404611 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.004 seconds
[0m03:09:48.407612 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.407612 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:09:48.412442 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m03:09:48.418490 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.418490 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp030948359217'
        
      order by ordinal_position

  
[0m03:09:48.422504 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.003 seconds
[0m03:09:48.433499 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.434499 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:09:48.436499 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m03:09:48.438805 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.439805 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:09:48.439805 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:09:48.440811 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.441810 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.441810 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp030948359217" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "price_excl_tax", "price_incl_tax", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."price_excl_tax",DBT_INTERNAL_SOURCE."price_incl_tax",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp030948359217" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:09:48.449233 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.006 seconds
[0m03:09:48.462135 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:09:48.462135 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:09:48.463135 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:09:48.464140 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:09:48.467474 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m03:09:48.469476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e5888bc-b21a-489a-8dcb-3cb1a5b85406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2076A9CD0>]}
[0m03:09:48.470476 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 0[0m in 0.29s]
[0m03:09:48.471475 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m03:09:48.472477 [debug] [MainThread]: On master: COMMIT
[0m03:09:48.472477 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:48.473475 [debug] [MainThread]: On master: COMMIT
[0m03:09:48.473475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:48.518644 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m03:09:48.519648 [debug] [MainThread]: On master: Close
[0m03:09:48.520649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:48.520649 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:09:48.520649 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m03:09:48.521792 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m03:09:48.521792 [info ] [MainThread]: 
[0m03:09:48.522812 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m03:09:48.522812 [debug] [MainThread]: Command end result
[0m03:09:48.540974 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:09:48.544082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:09:48.549082 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:09:48.549082 [info ] [MainThread]: 
[0m03:09:48.550082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:48.551082 [info ] [MainThread]: 
[0m03:09:48.551082 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:09:48.552082 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:09:48.552082 after 1.96 seconds
[0m03:09:48.553082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2074358D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A207043290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A27FC08110>]}
[0m03:09:48.553082 [debug] [MainThread]: Flushing usage events
[0m03:09:49.152685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:10:23.352918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234720AE450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234720AE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234720AE350>]}


============================== 03:10:23.357287 | 5b9b90d6-e8f7-4cd1-8e8e-20a3f1dc4053 ==============================
[0m03:10:23.357287 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:10:23.358295 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt snapshot', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m03:10:23.606245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b9b90d6-e8f7-4cd1-8e8e-20a3f1dc4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023472327CD0>]}
[0m03:10:23.675901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b9b90d6-e8f7-4cd1-8e8e-20a3f1dc4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002346CCBD650>]}
[0m03:10:23.676903 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:10:24.038283 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:10:24.182431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:24.183442 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:10:24.183442 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:24.188958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:10:24.233669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b9b90d6-e8f7-4cd1-8e8e-20a3f1dc4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234722A9210>]}
[0m03:10:24.316583 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:10:24.319583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:10:24.343302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b9b90d6-e8f7-4cd1-8e8e-20a3f1dc4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023472299290>]}
[0m03:10:24.344300 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:10:24.345321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b9b90d6-e8f7-4cd1-8e8e-20a3f1dc4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234722A9AD0>]}
[0m03:10:24.346321 [info ] [MainThread]: 
[0m03:10:24.347323 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:24.348324 [info ] [MainThread]: 
[0m03:10:24.348324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:10:24.350358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:10:24.496353 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:10:24.497347 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:10:24.497347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:24.550137 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.053 seconds
[0m03:10:24.551549 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:10:24.556709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_snapshots'
[0m03:10:24.562364 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:10:24.562364 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:10:24.563366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:24.614193 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.051 seconds
[0m03:10:24.616196 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:10:24.616196 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:10:24.617195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m03:10:24.619597 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:10:24.619597 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:10:24.621093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:24.670969 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m03:10:24.671973 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:10:24.672980 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:10:24.672980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books)
[0m03:10:24.676147 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:10:24.676147 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:10:24.677145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:24.728986 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.052 seconds
[0m03:10:24.729984 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:10:24.730985 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:10:24.731985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:10:24.735006 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:10:24.735006 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:10:24.735006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:24.784257 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.048 seconds
[0m03:10:24.785436 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:10:24.785436 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:10:24.791207 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:24.791207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:10:24.792207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:24.846028 [debug] [MainThread]: SQL status: SELECT 8 in 0.054 seconds
[0m03:10:24.848032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b9b90d6-e8f7-4cd1-8e8e-20a3f1dc4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023472BCF510>]}
[0m03:10:24.849031 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:24.850027 [debug] [MainThread]: On master: COMMIT
[0m03:10:24.850027 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:24.851029 [debug] [MainThread]: On master: COMMIT
[0m03:10:24.851029 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:10:24.852030 [debug] [MainThread]: On master: Close
[0m03:10:24.855029 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m03:10:24.856336 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m03:10:24.857350 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m03:10:24.858349 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m03:10:24.865348 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m03:10:24.911864 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:24.912866 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price, price_excl_tax, price_incl_tax from (
                



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m03:10:24.912866 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:10:24.957706 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.044 seconds
[0m03:10:24.968706 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:24.969707 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:10:24.985924 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.017 seconds
[0m03:10:24.993575 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:24.994577 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:10:24.998573 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:10:25.039995 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.039995 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp031025033575"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:10:25.054447 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m03:10:25.057450 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.058451 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031025033575'
        
      order by ordinal_position

  
[0m03:10:25.062447 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.004 seconds
[0m03:10:25.066816 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.066816 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:10:25.072831 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m03:10:25.075827 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.075827 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031025033575'
        
      order by ordinal_position

  
[0m03:10:25.080825 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.004 seconds
[0m03:10:25.084828 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.084828 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:10:25.089342 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:10:25.095343 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.095343 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031025033575'
        
      order by ordinal_position

  
[0m03:10:25.100726 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.005 seconds
[0m03:10:25.113729 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.114729 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:10:25.115729 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m03:10:25.118729 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.119729 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:10:25.119729 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:10:25.120729 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.121730 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.121730 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp031025033575" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "price_excl_tax", "price_incl_tax", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."price_excl_tax",DBT_INTERNAL_SOURCE."price_incl_tax",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp031025033575" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:10:25.123730 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m03:10:25.137957 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:10:25.137957 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:10:25.138959 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:10:25.144951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m03:10:25.148800 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m03:10:25.150793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b9b90d6-e8f7-4cd1-8e8e-20a3f1dc4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023472D02010>]}
[0m03:10:25.150793 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 0[0m in 0.29s]
[0m03:10:25.152794 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m03:10:25.153796 [debug] [MainThread]: On master: COMMIT
[0m03:10:25.154794 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:25.154794 [debug] [MainThread]: On master: COMMIT
[0m03:10:25.154794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:25.197703 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m03:10:25.198703 [debug] [MainThread]: On master: Close
[0m03:10:25.198703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:25.198703 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:10:25.199702 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m03:10:25.199702 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m03:10:25.200703 [info ] [MainThread]: 
[0m03:10:25.201703 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m03:10:25.202704 [debug] [MainThread]: Command end result
[0m03:10:25.220700 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:10:25.224089 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:10:25.228141 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:10:25.229286 [info ] [MainThread]: 
[0m03:10:25.230343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:25.230343 [info ] [MainThread]: 
[0m03:10:25.231360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:10:25.232721 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:10:25.232721 after 1.97 seconds
[0m03:10:25.232721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234720F64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023470198550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002346BCD8110>]}
[0m03:10:25.233879 [debug] [MainThread]: Flushing usage events
[0m03:10:25.849097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:10:34.145720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DEFDAE710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DEFE25090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DEFE25D90>]}


============================== 03:10:34.150717 | 46659cc3-801c-438b-a5fe-d268227c88ee ==============================
[0m03:10:34.150717 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:10:34.151718 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m03:10:34.402283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DEFDB6FD0>]}
[0m03:10:34.468955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DEA96D4D0>]}
[0m03:10:34.469955 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:10:34.827369 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:10:34.976250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:34.976250 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:10:34.977251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:34.982248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_books
[0m03:10:35.026480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF0302D10>]}
[0m03:10:35.106771 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:10:35.109770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:10:35.131854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF0098710>]}
[0m03:10:35.132852 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:10:35.132852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF0401190>]}
[0m03:10:35.135199 [info ] [MainThread]: 
[0m03:10:35.136215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:35.137211 [info ] [MainThread]: 
[0m03:10:35.138209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:10:35.143331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:10:35.292854 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:10:35.293852 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:10:35.293852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:35.347591 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.054 seconds
[0m03:10:35.349585 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:10:35.351590 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:10:35.351590 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:10:35.352587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:35.395947 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.043 seconds
[0m03:10:35.396952 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:10:35.399474 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:10:35.399474 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:10:35.400470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:35.447480 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.047 seconds
[0m03:10:35.448481 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:10:35.450482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_snapshots'
[0m03:10:35.456480 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:10:35.456480 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:10:35.457877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:35.506509 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.049 seconds
[0m03:10:35.508515 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:10:35.509511 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:10:35.509511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books)
[0m03:10:35.512510 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:10:35.512510 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:10:35.513511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:35.561257 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.048 seconds
[0m03:10:35.563372 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:10:35.563372 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:10:35.564772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:10:35.567625 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:10:35.568866 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:10:35.568866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:35.622057 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.053 seconds
[0m03:10:35.624057 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:10:35.624057 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:10:35.625057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m03:10:35.628491 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:10:35.629481 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:10:35.629481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:35.679441 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m03:10:35.681449 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:10:35.682446 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:10:35.686459 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:35.687457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:10:35.688462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:35.741484 [debug] [MainThread]: SQL status: SELECT 8 in 0.053 seconds
[0m03:10:35.743487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF0099C10>]}
[0m03:10:35.744493 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:35.744493 [debug] [MainThread]: On master: COMMIT
[0m03:10:35.745485 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:35.745485 [debug] [MainThread]: On master: COMMIT
[0m03:10:35.746484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:10:35.746484 [debug] [MainThread]: On master: Close
[0m03:10:35.750488 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m03:10:35.751487 [info ] [Thread-1 (]: 1 of 6 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m03:10:35.751487 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.dim_books_price_history'
[0m03:10:35.752485 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m03:10:35.759572 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m03:10:35.761581 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m03:10:35.792266 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m03:10:35.793690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:10:35.794704 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m03:10:35.795701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:10:35.848702 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m03:10:35.855824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:10:35.856823 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m03:10:35.857822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:10:35.860822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:10:35.862825 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m03:10:35.863824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:10:35.877833 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:10:35.877833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:10:35.878896 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:10:35.882937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:10:35.888942 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m03:10:35.893946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:10:35.894946 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m03:10:35.897944 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:10:35.900457 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m03:10:35.903838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF097F1D0>]}
[0m03:10:35.903838 [info ] [Thread-1 (]: 1 of 6 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.15s]
[0m03:10:35.905311 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m03:10:35.906329 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m03:10:35.906329 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m03:10:35.907328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m03:10:35.908327 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m03:10:35.911405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m03:10:35.912417 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m03:10:35.929712 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m03:10:35.930708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:10:35.930708 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:10:35.932164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:35.981829 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.050 seconds
[0m03:10:35.988840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:10:35.989839 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:10:35.990840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:10:35.994840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:10:35.994840 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:10:35.995839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:10:35.997840 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:10:35.997840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:10:35.997840 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:10:36.001356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:10:36.003354 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m03:10:36.005360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:10:36.006354 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m03:10:36.010364 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:10:36.012365 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m03:10:36.012365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF09D8D50>]}
[0m03:10:36.013366 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.11s]
[0m03:10:36.014372 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m03:10:36.015366 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m03:10:36.015366 [info ] [Thread-1 (]: 3 of 6 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m03:10:36.016862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m03:10:36.016862 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m03:10:36.020862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m03:10:36.021870 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m03:10:36.024863 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m03:10:36.025864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:10:36.025864 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m03:10:36.026865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:36.077519 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m03:10:36.080513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:10:36.081514 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m03:10:36.082520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:10:36.085834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:10:36.085834 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m03:10:36.086836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:10:36.088840 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:10:36.088840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:10:36.089837 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:10:36.092221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:10:36.095229 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m03:10:36.096230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:10:36.096230 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m03:10:36.099746 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m03:10:36.100752 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m03:10:36.101748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF047A090>]}
[0m03:10:36.101748 [info ] [Thread-1 (]: 3 of 6 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.08s]
[0m03:10:36.102748 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m03:10:36.103754 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m03:10:36.104756 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m03:10:36.105748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m03:10:36.105748 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m03:10:36.108746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m03:10:36.108746 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m03:10:36.111750 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m03:10:36.113164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:10:36.114198 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m03:10:36.114198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:36.163079 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m03:10:36.166073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:10:36.167077 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:10:36.168278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:10:36.169294 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:10:36.169294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:10:36.170289 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:10:36.171289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:10:36.175291 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m03:10:36.176288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:10:36.176288 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m03:10:36.177289 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:10:36.179289 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m03:10:36.179289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF0A34650>]}
[0m03:10:36.180291 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m03:10:36.181290 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m03:10:36.182289 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m03:10:36.182289 [info ] [Thread-1 (]: 5 of 6 START sql view model books_books.dim_books .............................. [RUN]
[0m03:10:36.183288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m03:10:36.183288 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m03:10:36.186299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m03:10:36.187299 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m03:10:36.190388 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m03:10:36.192421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:10:36.192421 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m03:10:36.193420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:36.241821 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m03:10:36.244820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:10:36.245820 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m03:10:36.246826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:10:36.247822 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:10:36.248820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:10:36.249830 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:10:36.253820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:10:36.256820 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m03:10:36.257826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:10:36.258823 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m03:10:36.259819 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:10:36.260820 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m03:10:36.260820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF0A35AD0>]}
[0m03:10:36.261821 [info ] [Thread-1 (]: 5 of 6 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:10:36.262823 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m03:10:36.262823 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m03:10:36.263842 [info ] [Thread-1 (]: 6 of 6 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m03:10:36.265316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m03:10:36.265316 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m03:10:36.268812 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m03:10:36.269824 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m03:10:36.272827 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m03:10:36.273826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:10:36.274826 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m03:10:36.274826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:36.329358 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m03:10:36.332363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:10:36.332363 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m03:10:36.334362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:10:36.335359 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:10:36.336357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:10:36.336357 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:10:36.338395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:10:36.341491 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m03:10:36.342488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:10:36.343628 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m03:10:36.343628 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:10:36.345774 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m03:10:36.346789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46659cc3-801c-438b-a5fe-d268227c88ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF0A1E6D0>]}
[0m03:10:36.346789 [info ] [Thread-1 (]: 6 of 6 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.08s]
[0m03:10:36.349098 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m03:10:36.350099 [debug] [MainThread]: On master: COMMIT
[0m03:10:36.350099 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:36.351193 [debug] [MainThread]: On master: COMMIT
[0m03:10:36.351193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:36.401914 [debug] [MainThread]: SQL status: COMMIT in 0.050 seconds
[0m03:10:36.402913 [debug] [MainThread]: On master: Close
[0m03:10:36.402913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:36.403916 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:10:36.403916 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m03:10:36.403916 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m03:10:36.404913 [info ] [MainThread]: 
[0m03:10:36.404913 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m03:10:36.406916 [debug] [MainThread]: Command end result
[0m03:10:36.425722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:10:36.428736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:10:36.433887 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:10:36.434889 [info ] [MainThread]: 
[0m03:10:36.434889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:36.435893 [info ] [MainThread]: 
[0m03:10:36.436898 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m03:10:36.438889 [debug] [MainThread]: Command `dbt run` succeeded at 03:10:36.438889 after 2.38 seconds
[0m03:10:36.439888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DEFE303D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DEFA47310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DEFDA2350>]}
[0m03:10:36.439888 [debug] [MainThread]: Flushing usage events
[0m03:10:37.160507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:12:01.674829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B56AF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B56AE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B56AF890>]}


============================== 03:12:01.678552 | 6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7 ==============================
[0m03:12:01.678552 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:12:01.679567 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m03:12:01.912460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B56AF390>]}
[0m03:12:01.976984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B13F05D0>]}
[0m03:12:01.978979 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:12:02.326116 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:12:02.418480 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:12:02.419487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B3851DD0>]}
[0m03:12:03.781950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_train
[0m03:12:03.789978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B71A1550>]}
[0m03:12:03.863268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:12:03.866268 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:12:03.886855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B57CB5D0>]}
[0m03:12:03.887955 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:12:03.887955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B708CA90>]}
[0m03:12:03.890983 [info ] [MainThread]: 
[0m03:12:03.890983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:03.891984 [info ] [MainThread]: 
[0m03:12:03.893985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:12:03.898268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:12:03.985222 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:12:03.986405 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:12:03.986405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:04.041528 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.055 seconds
[0m03:12:04.042529 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:12:04.045432 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:12:04.045963 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:12:04.046486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:04.090634 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.044 seconds
[0m03:12:04.091633 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:12:04.094092 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:12:04.094092 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:12:04.095091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:04.139767 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.045 seconds
[0m03:12:04.141768 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:12:04.142772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m03:12:04.148801 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:12:04.148801 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:12:04.149815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:04.202260 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.053 seconds
[0m03:12:04.204260 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:12:04.205263 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:12:04.205263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books)
[0m03:12:04.208446 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:12:04.208446 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:12:04.208446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:04.265050 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.056 seconds
[0m03:12:04.266050 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:12:04.267050 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:12:04.268054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_snapshots)
[0m03:12:04.271110 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:12:04.271110 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:12:04.272098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:04.323771 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m03:12:04.324765 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:12:04.324765 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:12:04.325763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books)
[0m03:12:04.328199 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:12:04.328199 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:12:04.329245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:04.378359 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m03:12:04.379358 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:12:04.380677 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:12:04.384825 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:04.386167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:12:04.386167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:04.428794 [debug] [MainThread]: SQL status: SELECT 8 in 0.043 seconds
[0m03:12:04.431794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B75A0A50>]}
[0m03:12:04.431794 [debug] [MainThread]: On master: ROLLBACK
[0m03:12:04.432795 [debug] [MainThread]: On master: COMMIT
[0m03:12:04.432795 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:04.433796 [debug] [MainThread]: On master: COMMIT
[0m03:12:04.434800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:12:04.434800 [debug] [MainThread]: On master: Close
[0m03:12:04.438258 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m03:12:04.439271 [info ] [Thread-1 (]: 1 of 6 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m03:12:04.440304 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.dim_books_price_history'
[0m03:12:04.440304 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m03:12:04.446960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m03:12:04.447963 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m03:12:04.476440 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m03:12:04.477437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:12:04.478569 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m03:12:04.478569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:12:04.531056 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m03:12:04.537054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:12:04.538059 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m03:12:04.539056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:04.542054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:12:04.542054 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m03:12:04.543054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:04.557054 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:12:04.558054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:12:04.558054 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:12:04.560053 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:12:04.565054 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m03:12:04.569054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:12:04.570071 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m03:12:04.571060 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:12:04.573070 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m03:12:04.575060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B73EBF50>]}
[0m03:12:04.576176 [info ] [Thread-1 (]: 1 of 6 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.13s]
[0m03:12:04.577193 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m03:12:04.578188 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m03:12:04.578188 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m03:12:04.579188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m03:12:04.580201 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m03:12:04.582701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m03:12:04.583703 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m03:12:04.599398 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m03:12:04.601401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:12:04.601401 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:12:04.602846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:04.652309 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.049 seconds
[0m03:12:04.658309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:12:04.658309 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:12:04.660309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:04.663311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:12:04.663311 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:12:04.664314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:04.665364 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:12:04.666363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:12:04.666363 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:12:04.669404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:12:04.672409 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m03:12:04.674410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:12:04.674410 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m03:12:04.678587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:12:04.680595 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m03:12:04.680595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B75A5310>]}
[0m03:12:04.681599 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.10s]
[0m03:12:04.682599 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m03:12:04.683601 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m03:12:04.684598 [info ] [Thread-1 (]: 3 of 6 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m03:12:04.685103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m03:12:04.685103 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m03:12:04.690109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m03:12:04.691112 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m03:12:04.694397 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m03:12:04.695399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:12:04.695399 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m03:12:04.695399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:04.752732 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.056 seconds
[0m03:12:04.754733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:12:04.755732 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m03:12:04.756734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:04.759732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:12:04.759732 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m03:12:04.760734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:04.762781 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:12:04.762781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:12:04.763787 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:12:04.766794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:12:04.769794 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m03:12:04.769794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:12:04.770804 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m03:12:04.773799 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m03:12:04.774805 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m03:12:04.775800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B769C750>]}
[0m03:12:04.776802 [info ] [Thread-1 (]: 3 of 6 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.09s]
[0m03:12:04.777800 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m03:12:04.778800 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m03:12:04.778800 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m03:12:04.779934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m03:12:04.780933 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m03:12:04.783040 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m03:12:04.784552 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m03:12:04.787756 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m03:12:04.789771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:12:04.789771 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m03:12:04.790771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:04.838070 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m03:12:04.841068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:12:04.842070 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:12:04.842070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:04.844067 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:12:04.844067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:12:04.844067 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:12:04.847065 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:12:04.850563 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m03:12:04.851583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:12:04.851583 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m03:12:04.852582 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:12:04.853581 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m03:12:04.854581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B769C750>]}
[0m03:12:04.854581 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m03:12:04.856613 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m03:12:04.856613 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m03:12:04.857601 [info ] [Thread-1 (]: 5 of 6 START sql view model books_books.dim_books .............................. [RUN]
[0m03:12:04.857601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m03:12:04.858716 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m03:12:04.860715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m03:12:04.861714 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m03:12:04.866756 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m03:12:04.867755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:12:04.868757 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m03:12:04.868757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:04.918748 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m03:12:04.921748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:12:04.922750 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m03:12:04.923755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:04.925747 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:12:04.925747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:12:04.926749 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:12:04.927968 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:12:04.929984 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m03:12:04.930983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:12:04.930983 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m03:12:04.931983 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:12:04.933983 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m03:12:04.933983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B75F58D0>]}
[0m03:12:04.934984 [info ] [Thread-1 (]: 5 of 6 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:12:04.935984 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m03:12:04.935984 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m03:12:04.936984 [info ] [Thread-1 (]: 6 of 6 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m03:12:04.937983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m03:12:04.937983 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m03:12:04.940985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m03:12:04.941986 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m03:12:04.945455 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m03:12:04.946458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:12:04.947456 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m03:12:04.947456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:05.000693 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.053 seconds
[0m03:12:05.003691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:12:05.004693 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m03:12:05.005844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:05.006853 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:12:05.007853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:12:05.007853 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:12:05.010854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:12:05.013852 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m03:12:05.014853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:12:05.014853 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m03:12:05.015856 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:12:05.017857 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m03:12:05.018853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d36c1ba-bf9f-4b5f-ab6c-35711e7dc9d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B75ACE90>]}
[0m03:12:05.018853 [info ] [Thread-1 (]: 6 of 6 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.08s]
[0m03:12:05.019853 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m03:12:05.020854 [debug] [MainThread]: On master: COMMIT
[0m03:12:05.021854 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:05.021854 [debug] [MainThread]: On master: COMMIT
[0m03:12:05.022854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:05.067509 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m03:12:05.067509 [debug] [MainThread]: On master: Close
[0m03:12:05.068505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:05.068505 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:12:05.069505 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m03:12:05.069505 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m03:12:05.069505 [info ] [MainThread]: 
[0m03:12:05.070513 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m03:12:05.071640 [debug] [MainThread]: Command end result
[0m03:12:05.091568 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:12:05.094571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:12:05.099569 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:12:05.100574 [info ] [MainThread]: 
[0m03:12:05.101572 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:05.101572 [info ] [MainThread]: 
[0m03:12:05.102595 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m03:12:05.103591 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:05.103591 after 3.55 seconds
[0m03:12:05.104596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B56A2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B56A3B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0B56A3990>]}
[0m03:12:05.104596 [debug] [MainThread]: Flushing usage events
[0m03:12:06.013617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:12:09.935076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F02FA3C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F02FAF810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F02FAF310>]}


============================== 03:12:09.939073 | 3919fd9f-d65a-4bab-be99-c57d377ec40e ==============================
[0m03:12:09.939073 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:12:09.940072 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'printer_width': '80', 'invocation_command': 'dbt snapshot', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m03:12:10.169118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3919fd9f-d65a-4bab-be99-c57d377ec40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F041D8650>]}
[0m03:12:10.233106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3919fd9f-d65a-4bab-be99-c57d377ec40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFEC01810>]}
[0m03:12:10.234107 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:12:10.572242 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:12:10.735945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:10.736945 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:12:10.736945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:10.741945 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_train
[0m03:12:10.786626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3919fd9f-d65a-4bab-be99-c57d377ec40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F04114E10>]}
[0m03:12:10.863646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:12:10.865864 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:12:10.887266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3919fd9f-d65a-4bab-be99-c57d377ec40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F04291050>]}
[0m03:12:10.888266 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:12:10.888266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3919fd9f-d65a-4bab-be99-c57d377ec40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F04561350>]}
[0m03:12:10.890267 [info ] [MainThread]: 
[0m03:12:10.890267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:10.891776 [info ] [MainThread]: 
[0m03:12:10.892785 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:12:10.893787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:12:11.037695 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:12:11.037695 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:12:11.037695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:11.089718 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.051 seconds
[0m03:12:11.090716 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:12:11.095238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_snapshots'
[0m03:12:11.100237 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:12:11.101242 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:12:11.101242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:11.152908 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.051 seconds
[0m03:12:11.154909 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:12:11.154909 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:12:11.155907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m03:12:11.158908 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:12:11.158908 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:12:11.159906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:11.209117 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.049 seconds
[0m03:12:11.211118 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:12:11.212131 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:12:11.213121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books)
[0m03:12:11.215116 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:12:11.216126 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:12:11.216126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:11.273275 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.057 seconds
[0m03:12:11.275277 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:12:11.275277 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:12:11.276277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:12:11.279282 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:12:11.279282 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:12:11.280285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:11.335846 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.055 seconds
[0m03:12:11.337847 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:12:11.337847 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:12:11.342848 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:11.342848 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:12:11.343847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:11.397363 [debug] [MainThread]: SQL status: SELECT 8 in 0.054 seconds
[0m03:12:11.400369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3919fd9f-d65a-4bab-be99-c57d377ec40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F04AFC090>]}
[0m03:12:11.401368 [debug] [MainThread]: On master: ROLLBACK
[0m03:12:11.401368 [debug] [MainThread]: On master: COMMIT
[0m03:12:11.402368 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:11.402368 [debug] [MainThread]: On master: COMMIT
[0m03:12:11.403364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:12:11.403364 [debug] [MainThread]: On master: Close
[0m03:12:11.407366 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m03:12:11.408365 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m03:12:11.409365 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m03:12:11.410362 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m03:12:11.417364 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m03:12:11.461379 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.462378 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price, price_excl_tax, price_incl_tax from (
                



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m03:12:11.463381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:12:11.509903 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.046 seconds
[0m03:12:11.520902 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.520902 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:12:11.538941 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.018 seconds
[0m03:12:11.545980 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.546974 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:12:11.551976 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:12:11.592052 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.593063 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp031211585444"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:12:11.604065 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m03:12:11.608066 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.608066 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031211585444'
        
      order by ordinal_position

  
[0m03:12:11.613065 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.004 seconds
[0m03:12:11.616065 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.617064 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:12:11.621063 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:12:11.625063 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.626065 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031211585444'
        
      order by ordinal_position

  
[0m03:12:11.630067 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.003 seconds
[0m03:12:11.633065 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.633065 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:12:11.639063 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m03:12:11.645064 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.646063 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031211585444'
        
      order by ordinal_position

  
[0m03:12:11.650061 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.004 seconds
[0m03:12:11.662067 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.663063 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
    price,
    price_excl_tax,
    price_incl_tax,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ) or snapshotted_data."price_excl_tax" != source_data."price_excl_tax"
        or
        (
            ((snapshotted_data."price_excl_tax" is null) and not (source_data."price_excl_tax" is null))
            or
            ((not snapshotted_data."price_excl_tax" is null) and (source_data."price_excl_tax" is null))
        ) or snapshotted_data."price_incl_tax" != source_data."price_incl_tax"
        or
        (
            ((snapshotted_data."price_incl_tax" is null) and not (source_data."price_incl_tax" is null))
            or
            ((not snapshotted_data."price_incl_tax" is null) and (source_data."price_incl_tax" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:12:11.664075 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m03:12:11.667063 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.667063 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:12:11.668082 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:12:11.669065 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.670070 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.671064 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp031211585444" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "price_excl_tax", "price_incl_tax", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."price_excl_tax",DBT_INTERNAL_SOURCE."price_incl_tax",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp031211585444" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:12:11.672235 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m03:12:11.685622 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:12:11.685622 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:12:11.686622 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:12:11.687619 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:12:11.690618 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m03:12:11.693144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3919fd9f-d65a-4bab-be99-c57d377ec40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F04284450>]}
[0m03:12:11.693144 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 0[0m in 0.28s]
[0m03:12:11.694142 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m03:12:11.696142 [debug] [MainThread]: On master: COMMIT
[0m03:12:11.697147 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:11.697147 [debug] [MainThread]: On master: COMMIT
[0m03:12:11.697147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:11.744914 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m03:12:11.745916 [debug] [MainThread]: On master: Close
[0m03:12:11.745916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:11.746915 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:12:11.746915 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m03:12:11.746915 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m03:12:11.747917 [info ] [MainThread]: 
[0m03:12:11.747917 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m03:12:11.748913 [debug] [MainThread]: Command end result
[0m03:12:11.767103 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:12:11.770106 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:12:11.775107 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:12:11.775107 [info ] [MainThread]: 
[0m03:12:11.776109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:11.777105 [info ] [MainThread]: 
[0m03:12:11.777105 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:12:11.778582 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:12:11.778582 after 1.93 seconds
[0m03:12:11.779582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01A32910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F02D35D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F02D35450>]}
[0m03:12:11.779582 [debug] [MainThread]: Flushing usage events
[0m03:12:12.410333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:13:09.040788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228463AE910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228463AE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228463AE790>]}


============================== 03:13:09.044788 | dcafca19-e0f8-474b-bc33-185df05d96c0 ==============================
[0m03:13:09.044788 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:13:09.045786 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt snapshot', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m03:13:09.274928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcafca19-e0f8-474b-bc33-185df05d96c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228445E4610>]}
[0m03:13:09.341750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcafca19-e0f8-474b-bc33-185df05d96c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228420F1A10>]}
[0m03:13:09.343169 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:13:09.690049 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:13:09.851270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:13:09.852270 [debug] [MainThread]: Partial parsing: updated file: dbt_train://snapshots\books_price_snapshot.sql
[0m03:13:10.059987 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot books_price_snapshot (snapshots\books_price_snapshot.sql)
  bad operand type for unary -: 'str'
[0m03:13:10.061474 [debug] [MainThread]: Command `dbt snapshot` failed at 03:13:10.061474 after 1.11 seconds
[0m03:13:10.062469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228463A3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022846C69090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228463A2290>]}
[0m03:13:10.062469 [debug] [MainThread]: Flushing usage events
[0m03:13:10.778998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:13:41.045786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0162A2F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A016325990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0162AF9D0>]}


============================== 03:13:41.049800 | be3fb4cf-97ba-4f9d-9c4e-9b7ffb5e8018 ==============================
[0m03:13:41.049800 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:13:41.050799 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt snapshot', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m03:13:41.285308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be3fb4cf-97ba-4f9d-9c4e-9b7ffb5e8018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A014F40850>]}
[0m03:13:41.349343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be3fb4cf-97ba-4f9d-9c4e-9b7ffb5e8018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A010F2D710>]}
[0m03:13:41.350344 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:13:41.689008 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:13:41.846056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:13:41.847067 [debug] [MainThread]: Partial parsing: updated file: dbt_train://snapshots\books_price_snapshot.sql
[0m03:13:42.035042 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot books_price_snapshot (snapshots\books_price_snapshot.sql)
  bad operand type for unary -: 'str'
[0m03:13:42.036675 [debug] [MainThread]: Command `dbt snapshot` failed at 03:13:42.036675 after 1.08 seconds
[0m03:13:42.037206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A00FF18310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0162A21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0162A2F90>]}
[0m03:13:42.037728 [debug] [MainThread]: Flushing usage events
[0m03:13:42.683461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:14:31.577796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110A9AFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110A9AE710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110A9AF390>]}


============================== 03:14:31.581795 | 2baea53b-3621-4b98-814f-1d4712e555a0 ==============================
[0m03:14:31.581795 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:14:31.582795 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m03:14:31.818547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2baea53b-3621-4b98-814f-1d4712e555a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110ABACD10>]}
[0m03:14:31.884080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2baea53b-3621-4b98-814f-1d4712e555a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211055AC1D0>]}
[0m03:14:31.885072 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:14:32.229605 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:14:32.373189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:14:32.373189 [debug] [MainThread]: Partial parsing: updated file: dbt_train://snapshots\books_price_snapshot.sql
[0m03:14:32.685155 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_train
[0m03:14:32.697156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2baea53b-3621-4b98-814f-1d4712e555a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110ACB8B90>]}
[0m03:14:32.774675 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:14:32.777683 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:14:32.798675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2baea53b-3621-4b98-814f-1d4712e555a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211082FB950>]}
[0m03:14:32.798675 [info ] [MainThread]: Found 6 models, 3 data tests, 1 snapshot, 1 source, 463 macros
[0m03:14:32.799675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2baea53b-3621-4b98-814f-1d4712e555a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110AFBC2D0>]}
[0m03:14:32.801678 [info ] [MainThread]: 
[0m03:14:32.801678 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:14:32.802675 [info ] [MainThread]: 
[0m03:14:32.803678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:14:32.804679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:14:32.891194 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:14:32.891194 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:14:32.892192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:14:32.951193 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.059 seconds
[0m03:14:32.953202 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:14:32.956588 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m03:14:32.961588 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:14:32.962586 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:14:32.962586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:14:33.015618 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.053 seconds
[0m03:14:33.016616 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:14:33.017615 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:14:33.018621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books)
[0m03:14:33.020615 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:14:33.021618 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:14:33.021618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:33.077142 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.055 seconds
[0m03:14:33.079144 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:14:33.080140 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:14:33.080140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:14:33.083139 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:14:33.083139 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:14:33.083139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:33.136138 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.053 seconds
[0m03:14:33.138137 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:14:33.139140 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:14:33.140141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m03:14:33.142138 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:14:33.143139 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:14:33.143139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:33.195449 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m03:14:33.197450 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:14:33.197450 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:14:33.201454 [debug] [MainThread]: Using postgres connection "master"
[0m03:14:33.202450 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:14:33.202450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:14:33.254524 [debug] [MainThread]: SQL status: SELECT 8 in 0.052 seconds
[0m03:14:33.257523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2baea53b-3621-4b98-814f-1d4712e555a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110C60E750>]}
[0m03:14:33.257523 [debug] [MainThread]: On master: ROLLBACK
[0m03:14:33.258527 [debug] [MainThread]: On master: COMMIT
[0m03:14:33.259524 [debug] [MainThread]: Using postgres connection "master"
[0m03:14:33.259524 [debug] [MainThread]: On master: COMMIT
[0m03:14:33.260524 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:14:33.261524 [debug] [MainThread]: On master: Close
[0m03:14:33.265527 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m03:14:33.267037 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m03:14:33.268044 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m03:14:33.268044 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m03:14:33.275043 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m03:14:33.316046 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.317045 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price from (
                



select
    id,
    title,
     price,

    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m03:14:33.317045 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:14:33.467088 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.151 seconds
[0m03:14:33.479553 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.480552 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:14:33.497553 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.016 seconds
[0m03:14:33.504560 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.504560 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:14:33.508550 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m03:14:33.547548 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.548549 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp031433541548"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
     price,

    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:14:33.561568 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m03:14:33.564565 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.565564 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031433541548'
        
      order by ordinal_position

  
[0m03:14:33.570076 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:14:33.573076 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.574075 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:14:33.578082 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m03:14:33.581077 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.581077 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031433541548'
        
      order by ordinal_position

  
[0m03:14:33.585081 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m03:14:33.588076 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.589076 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:14:33.594078 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:14:33.599082 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.600079 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031433541548'
        
      order by ordinal_position

  
[0m03:14:33.604076 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:14:33.616075 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.617076 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
     price,

    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:14:33.618076 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m03:14:33.621076 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.621076 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:14:33.622076 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:14:33.623076 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.624086 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.625076 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp031433541548" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp031433541548" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:14:33.626272 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m03:14:33.637273 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:14:33.638273 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:14:33.638273 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:14:33.644923 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m03:14:33.648361 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m03:14:33.650356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2baea53b-3621-4b98-814f-1d4712e555a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110565CB90>]}
[0m03:14:33.651354 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 0[0m in 0.38s]
[0m03:14:33.652361 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m03:14:33.654361 [debug] [MainThread]: On master: COMMIT
[0m03:14:33.655359 [debug] [MainThread]: Using postgres connection "master"
[0m03:14:33.655359 [debug] [MainThread]: On master: COMMIT
[0m03:14:33.656361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:14:33.698872 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m03:14:33.699870 [debug] [MainThread]: On master: Close
[0m03:14:33.700870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:14:33.700870 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:14:33.700870 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m03:14:33.701872 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m03:14:33.701872 [info ] [MainThread]: 
[0m03:14:33.702871 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m03:14:33.703876 [debug] [MainThread]: Command end result
[0m03:14:33.723873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:14:33.726874 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:14:33.731872 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:14:33.732873 [info ] [MainThread]: 
[0m03:14:33.732873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:14:33.733870 [info ] [MainThread]: 
[0m03:14:33.734872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:14:33.735872 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:14:33.735872 after 2.25 seconds
[0m03:14:33.736869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110AA32F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110A735210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110C5B1090>]}
[0m03:14:33.737871 [debug] [MainThread]: Flushing usage events
[0m03:14:34.422822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:15:27.565734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA1AE1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA200C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA202410>]}


============================== 03:15:27.569737 | ff235ecf-5f1b-4f9d-877f-320b577bbe9e ==============================
[0m03:15:27.569737 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:15:27.570735 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot', 'printer_width': '80', 'write_json': 'True'}
[0m03:15:27.812667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff235ecf-5f1b-4f9d-877f-320b577bbe9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA1F6790>]}
[0m03:15:27.878501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff235ecf-5f1b-4f9d-877f-320b577bbe9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A4D9DD50>]}
[0m03:15:27.879498 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:15:28.264679 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:15:28.448733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:15:28.449726 [debug] [MainThread]: Partial parsing: updated file: dbt_train://snapshots\books_price_snapshot.sql
[0m03:15:28.784199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_train.snapshots.dbt_train
[0m03:15:28.796805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff235ecf-5f1b-4f9d-877f-320b577bbe9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA4DDBD0>]}
[0m03:15:28.877854 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:15:28.880854 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:15:28.901863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff235ecf-5f1b-4f9d-877f-320b577bbe9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA986210>]}
[0m03:15:28.902863 [info ] [MainThread]: Found 6 models, 3 data tests, 1 snapshot, 1 source, 463 macros
[0m03:15:28.903863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff235ecf-5f1b-4f9d-877f-320b577bbe9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA8358D0>]}
[0m03:15:28.905861 [info ] [MainThread]: 
[0m03:15:28.905861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:15:28.907227 [info ] [MainThread]: 
[0m03:15:28.908240 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:15:28.909240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:15:29.000130 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:15:29.000130 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:15:29.001133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:29.057227 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.056 seconds
[0m03:15:29.058318 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:15:29.062964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m03:15:29.067965 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:15:29.068964 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:15:29.069968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:29.122359 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m03:15:29.123354 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:15:29.124359 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:15:29.124359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m03:15:29.127981 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:15:29.127981 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:15:29.129309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:29.180455 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.051 seconds
[0m03:15:29.181457 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:15:29.182455 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:15:29.182455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books)
[0m03:15:29.185460 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:15:29.185460 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:15:29.185460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:29.238974 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.052 seconds
[0m03:15:29.239980 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:15:29.240980 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:15:29.241973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m03:15:29.243974 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:15:29.244975 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:15:29.244975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:29.294388 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.049 seconds
[0m03:15:29.295392 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:15:29.296388 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:15:29.301388 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:29.302392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:15:29.302392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:15:29.354346 [debug] [MainThread]: SQL status: SELECT 8 in 0.052 seconds
[0m03:15:29.357346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff235ecf-5f1b-4f9d-877f-320b577bbe9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA950810>]}
[0m03:15:29.358351 [debug] [MainThread]: On master: ROLLBACK
[0m03:15:29.358351 [debug] [MainThread]: On master: COMMIT
[0m03:15:29.359346 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:29.359346 [debug] [MainThread]: On master: COMMIT
[0m03:15:29.360349 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:15:29.360349 [debug] [MainThread]: On master: Close
[0m03:15:29.364400 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m03:15:29.364400 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m03:15:29.365403 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m03:15:29.366402 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m03:15:29.372403 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m03:15:29.415617 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.415617 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price from (
                



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m03:15:29.416617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:15:29.460086 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m03:15:29.472086 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.473092 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:15:29.489092 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.015 seconds
[0m03:15:29.496086 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.497090 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:15:29.501087 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:15:29.541602 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.541602 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp031529535596"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:15:29.556325 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m03:15:29.559326 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.560330 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031529535596'
        
      order by ordinal_position

  
[0m03:15:29.564325 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:15:29.567330 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.568330 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:15:29.571325 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m03:15:29.574331 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.575325 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031529535596'
        
      order by ordinal_position

  
[0m03:15:29.578325 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m03:15:29.581325 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.581325 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:15:29.586603 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:15:29.592603 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.592603 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031529535596'
        
      order by ordinal_position

  
[0m03:15:29.598605 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m03:15:29.610603 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.611603 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:15:29.612603 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m03:15:29.615609 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.616603 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:15:29.617603 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:15:29.617603 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.618608 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.619604 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp031529535596" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp031529535596" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:15:29.621610 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m03:15:29.633253 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:15:29.634253 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:15:29.634253 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:15:29.637771 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:15:29.640771 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m03:15:29.642773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff235ecf-5f1b-4f9d-877f-320b577bbe9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA9C1250>]}
[0m03:15:29.643772 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 0[0m in 0.28s]
[0m03:15:29.644776 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m03:15:29.645771 [debug] [MainThread]: On master: COMMIT
[0m03:15:29.646779 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:29.646779 [debug] [MainThread]: On master: COMMIT
[0m03:15:29.647777 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:15:29.691372 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m03:15:29.692768 [debug] [MainThread]: On master: Close
[0m03:15:29.692768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:29.692768 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:15:29.693780 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m03:15:29.693780 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m03:15:29.693780 [info ] [MainThread]: 
[0m03:15:29.695081 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m03:15:29.696090 [debug] [MainThread]: Command end result
[0m03:15:29.715126 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:15:29.718126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:15:29.722141 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:15:29.723140 [info ] [MainThread]: 
[0m03:15:29.724142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:15:29.725142 [info ] [MainThread]: 
[0m03:15:29.725142 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:15:29.726143 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:15:29.726143 after 2.25 seconds
[0m03:15:29.727161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA230990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA1A2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AA1A2410>]}
[0m03:15:29.727161 [debug] [MainThread]: Flushing usage events
[0m03:15:30.344916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:17:45.525218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C8BAEF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C8BAE6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C8BAEB90>]}


============================== 03:17:45.529223 | e8089277-2457-4c41-b202-562467d89dc0 ==============================
[0m03:17:45.529223 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:17:45.529223 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'printer_width': '80', 'write_json': 'True'}
[0m03:17:45.759888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8089277-2457-4c41-b202-562467d89dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C8DA9690>]}
[0m03:17:45.824442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8089277-2457-4c41-b202-562467d89dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C3801A10>]}
[0m03:17:45.825448 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:17:46.172959 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:17:46.281474 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:17:46.282474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8089277-2457-4c41-b202-562467d89dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C6D51C90>]}
[0m03:17:47.655817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8089277-2457-4c41-b202-562467d89dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CA680790>]}
[0m03:17:47.729990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:17:47.733037 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:17:47.754038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8089277-2457-4c41-b202-562467d89dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CA417990>]}
[0m03:17:47.755038 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:17:47.756045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8089277-2457-4c41-b202-562467d89dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CA6A1E50>]}
[0m03:17:47.758042 [info ] [MainThread]: 
[0m03:17:47.759040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:17:47.759040 [info ] [MainThread]: 
[0m03:17:47.760038 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:17:47.762038 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:17:47.849562 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:17:47.850556 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:17:47.850556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:17:47.905078 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.054 seconds
[0m03:17:47.906079 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:17:47.911094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m03:17:47.915093 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:17:47.916095 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:17:47.916095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:17:47.968635 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m03:17:47.969634 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:17:47.970638 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:17:47.971638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m03:17:47.973636 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:17:47.973636 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:17:47.974678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:17:48.026598 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m03:17:48.028598 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:17:48.028598 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:17:48.029602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books)
[0m03:17:48.032037 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:17:48.033048 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:17:48.033048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:17:48.084346 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.051 seconds
[0m03:17:48.086346 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:17:48.087351 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:17:48.087351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books)
[0m03:17:48.090752 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:17:48.091755 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:17:48.091755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:17:48.142489 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.051 seconds
[0m03:17:48.144489 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:17:48.145489 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:17:48.150602 [debug] [MainThread]: Using postgres connection "master"
[0m03:17:48.151615 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:17:48.151615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:17:48.202271 [debug] [MainThread]: SQL status: SELECT 8 in 0.050 seconds
[0m03:17:48.205296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8089277-2457-4c41-b202-562467d89dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CAACE890>]}
[0m03:17:48.205296 [debug] [MainThread]: On master: ROLLBACK
[0m03:17:48.206300 [debug] [MainThread]: On master: COMMIT
[0m03:17:48.206300 [debug] [MainThread]: Using postgres connection "master"
[0m03:17:48.207295 [debug] [MainThread]: On master: COMMIT
[0m03:17:48.207295 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:17:48.208296 [debug] [MainThread]: On master: Close
[0m03:17:48.213299 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m03:17:48.213299 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m03:17:48.214297 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m03:17:48.215298 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m03:17:48.221295 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m03:17:48.263295 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.264295 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price from (
                



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m03:17:48.264295 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:17:48.311815 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.047 seconds
[0m03:17:48.323983 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.324983 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:17:48.344983 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.020 seconds
[0m03:17:48.351983 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.352987 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:17:48.357983 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m03:17:48.396988 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.397993 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp031748391988"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:17:48.413138 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.014 seconds
[0m03:17:48.416138 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.416138 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031748391988'
        
      order by ordinal_position

  
[0m03:17:48.422138 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m03:17:48.425142 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.425142 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:17:48.430144 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:17:48.433143 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.434138 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031748391988'
        
      order by ordinal_position

  
[0m03:17:48.438138 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:17:48.441138 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.442138 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:17:48.446141 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:17:48.452138 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.453146 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031748391988'
        
      order by ordinal_position

  
[0m03:17:48.458138 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m03:17:48.470138 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.471138 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:17:48.472138 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m03:17:48.475138 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.475138 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:17:48.476138 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:17:48.477143 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.478142 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.478142 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp031748391988" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp031748391988" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:17:48.480613 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m03:17:48.491623 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:17:48.492626 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:17:48.492626 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:17:48.495628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:17:48.498623 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m03:17:48.500623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8089277-2457-4c41-b202-562467d89dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CAA6E550>]}
[0m03:17:48.501626 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 0[0m in 0.29s]
[0m03:17:48.502624 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m03:17:48.504676 [debug] [MainThread]: On master: COMMIT
[0m03:17:48.504676 [debug] [MainThread]: Using postgres connection "master"
[0m03:17:48.504676 [debug] [MainThread]: On master: COMMIT
[0m03:17:48.505676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:17:48.550689 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m03:17:48.551687 [debug] [MainThread]: On master: Close
[0m03:17:48.552684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:17:48.552684 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:17:48.552684 [debug] [MainThread]: Connection 'list_web_scraper_books_books' was properly closed.
[0m03:17:48.553686 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m03:17:48.553686 [info ] [MainThread]: 
[0m03:17:48.554685 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m03:17:48.555686 [debug] [MainThread]: Command end result
[0m03:17:48.573870 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:17:48.576870 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:17:48.581870 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:17:48.581870 [info ] [MainThread]: 
[0m03:17:48.582875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:17:48.582875 [info ] [MainThread]: 
[0m03:17:48.583875 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:17:48.584875 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:17:48.584875 after 3.18 seconds
[0m03:17:48.585875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C8C34A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C8C36950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C8C34450>]}
[0m03:17:48.585875 [debug] [MainThread]: Flushing usage events
[0m03:17:49.289892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:18:14.355720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AE5AE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AE5AEC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AE5AFAD0>]}


============================== 03:18:14.359725 | f76727b6-b206-4e24-ad21-24c7c1d8daa2 ==============================
[0m03:18:14.359725 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:18:14.360721 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot', 'printer_width': '80', 'write_json': 'True'}
[0m03:18:14.599703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f76727b6-b206-4e24-ad21-24c7c1d8daa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AE662D50>]}
[0m03:18:14.668037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f76727b6-b206-4e24-ad21-24c7c1d8daa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AA1ED490>]}
[0m03:18:14.670040 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:18:15.021610 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:18:15.186903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:18:15.187434 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:18:15.187965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:18:15.236724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f76727b6-b206-4e24-ad21-24c7c1d8daa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AEC37150>]}
[0m03:18:15.319958 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:18:15.323067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:18:15.346287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f76727b6-b206-4e24-ad21-24c7c1d8daa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AEE1C250>]}
[0m03:18:15.346287 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:18:15.347287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f76727b6-b206-4e24-ad21-24c7c1d8daa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AEB20810>]}
[0m03:18:15.349286 [info ] [MainThread]: 
[0m03:18:15.350295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:18:15.350295 [info ] [MainThread]: 
[0m03:18:15.351466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:18:15.352477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:18:15.500724 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:18:15.500724 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:18:15.501725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:18:15.550074 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.049 seconds
[0m03:18:15.552080 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:18:15.556075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_snapshots'
[0m03:18:15.561082 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:18:15.561082 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:18:15.561082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:18:15.609752 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.048 seconds
[0m03:18:15.610758 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:18:15.611758 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:18:15.612758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m03:18:15.614760 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:18:15.616086 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:18:15.617101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:18:15.665081 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.048 seconds
[0m03:18:15.666081 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:18:15.667081 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:18:15.668082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m03:18:15.670087 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:18:15.671085 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:18:15.671085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:18:15.716606 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.045 seconds
[0m03:18:15.717596 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:18:15.718594 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:18:15.719922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books)
[0m03:18:15.723426 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:18:15.724439 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:18:15.724439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:18:15.775535 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.051 seconds
[0m03:18:15.776535 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:18:15.777535 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:18:15.781901 [debug] [MainThread]: Using postgres connection "master"
[0m03:18:15.782901 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:18:15.782901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:18:15.835259 [debug] [MainThread]: SQL status: SELECT 8 in 0.052 seconds
[0m03:18:15.838257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f76727b6-b206-4e24-ad21-24c7c1d8daa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B00FA7D0>]}
[0m03:18:15.838257 [debug] [MainThread]: On master: ROLLBACK
[0m03:18:15.839266 [debug] [MainThread]: On master: COMMIT
[0m03:18:15.839266 [debug] [MainThread]: Using postgres connection "master"
[0m03:18:15.840258 [debug] [MainThread]: On master: COMMIT
[0m03:18:15.840258 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:18:15.841257 [debug] [MainThread]: On master: Close
[0m03:18:15.844258 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m03:18:15.845472 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m03:18:15.846488 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m03:18:15.846488 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m03:18:15.853700 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m03:18:15.898618 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:15.898618 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price from (
                



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m03:18:15.899609 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:18:15.946050 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.047 seconds
[0m03:18:15.958208 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:15.959209 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:18:15.978997 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.019 seconds
[0m03:18:15.985997 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:15.985997 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:18:15.996017 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:18:16.036033 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.037035 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp031816031024"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:18:16.051042 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m03:18:16.054033 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.055033 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031816031024'
        
      order by ordinal_position

  
[0m03:18:16.060033 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:18:16.063045 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.063045 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:18:16.067350 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:18:16.071348 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.071348 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031816031024'
        
      order by ordinal_position

  
[0m03:18:16.076390 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:18:16.079397 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.080391 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:18:16.084495 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:18:16.090497 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.091496 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp031816031024'
        
      order by ordinal_position

  
[0m03:18:16.096495 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m03:18:16.108496 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.109495 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:18:16.110496 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m03:18:16.114505 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.114505 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:18:16.115502 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:18:16.116510 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.117510 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.118511 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp031816031024" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp031816031024" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:18:16.120514 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m03:18:16.133699 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:18:16.134713 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:18:16.134713 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:18:16.136699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:18:16.139698 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m03:18:16.140705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76727b6-b206-4e24-ad21-24c7c1d8daa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AE884450>]}
[0m03:18:16.141701 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 0[0m in 0.29s]
[0m03:18:16.142699 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m03:18:16.144698 [debug] [MainThread]: On master: COMMIT
[0m03:18:16.144698 [debug] [MainThread]: Using postgres connection "master"
[0m03:18:16.144698 [debug] [MainThread]: On master: COMMIT
[0m03:18:16.145698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:18:16.187200 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m03:18:16.188200 [debug] [MainThread]: On master: Close
[0m03:18:16.188200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:18:16.189458 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:18:16.189458 [debug] [MainThread]: Connection 'list_web_scraper_books_books' was properly closed.
[0m03:18:16.189458 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m03:18:16.190853 [info ] [MainThread]: 
[0m03:18:16.190853 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m03:18:16.190853 [debug] [MainThread]: Command end result
[0m03:18:16.211134 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:18:16.213606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:18:16.219703 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:18:16.219703 [info ] [MainThread]: 
[0m03:18:16.220808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:18:16.222011 [info ] [MainThread]: 
[0m03:18:16.222011 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:18:16.224024 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:18:16.224024 after 1.96 seconds
[0m03:18:16.225516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AE5F5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AE335E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AE5A23D0>]}
[0m03:18:16.225516 [debug] [MainThread]: Flushing usage events
[0m03:18:16.820499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:24:25.178727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C707CA2F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C707D25690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C707D26F50>]}


============================== 03:24:25.181725 | c5e4b0e7-474b-4708-82d2-feca30cf1151 ==============================
[0m03:24:25.181725 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:24:25.183726 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt snapshot', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m03:24:25.424860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5e4b0e7-474b-4708-82d2-feca30cf1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C707CB6D90>]}
[0m03:24:25.492255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5e4b0e7-474b-4708-82d2-feca30cf1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7028EDF50>]}
[0m03:24:25.493255 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:24:25.854245 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:24:25.998765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:24:25.999763 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:24:25.999763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:24:26.048274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5e4b0e7-474b-4708-82d2-feca30cf1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C709359A10>]}
[0m03:24:26.127788 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:24:26.130789 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:24:26.151789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5e4b0e7-474b-4708-82d2-feca30cf1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C707EA8F50>]}
[0m03:24:26.151789 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:24:26.152790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5e4b0e7-474b-4708-82d2-feca30cf1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C709262310>]}
[0m03:24:26.154849 [info ] [MainThread]: 
[0m03:24:26.156004 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:24:26.157089 [info ] [MainThread]: 
[0m03:24:26.157089 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:24:26.158097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:24:26.310859 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:24:26.310859 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:24:26.312365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:26.368577 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.056 seconds
[0m03:24:26.369581 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:24:26.373762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m03:24:26.379082 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:24:26.380082 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:24:26.380082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:26.431347 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.052 seconds
[0m03:24:26.433614 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:24:26.433614 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:24:26.434709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books_books_silver)
[0m03:24:26.437719 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:24:26.437719 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:24:26.438723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:26.485162 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m03:24:26.486163 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:24:26.486163 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:24:26.487163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m03:24:26.490163 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:24:26.490163 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:24:26.490163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:26.540818 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m03:24:26.541822 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:24:26.542820 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:24:26.543819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m03:24:26.546821 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:24:26.546821 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:24:26.546821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:26.597262 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m03:24:26.598277 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:24:26.599442 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:24:26.603980 [debug] [MainThread]: Using postgres connection "master"
[0m03:24:26.603980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:24:26.608008 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:24:26.662743 [debug] [MainThread]: SQL status: SELECT 8 in 0.055 seconds
[0m03:24:26.665745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5e4b0e7-474b-4708-82d2-feca30cf1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7097D7310>]}
[0m03:24:26.665745 [debug] [MainThread]: On master: ROLLBACK
[0m03:24:26.666745 [debug] [MainThread]: On master: COMMIT
[0m03:24:26.666745 [debug] [MainThread]: Using postgres connection "master"
[0m03:24:26.667746 [debug] [MainThread]: On master: COMMIT
[0m03:24:26.668748 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:24:26.668748 [debug] [MainThread]: On master: Close
[0m03:24:26.672746 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m03:24:26.672746 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m03:24:26.673748 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m03:24:26.674745 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m03:24:26.681745 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m03:24:26.728286 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.728286 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price from (
                



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m03:24:26.729287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:24:26.773320 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.045 seconds
[0m03:24:26.785802 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.786804 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:24:26.804290 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.017 seconds
[0m03:24:26.811857 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.812858 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:24:26.817370 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:24:26.857712 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.857712 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp032426851499"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:24:26.872452 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.014 seconds
[0m03:24:26.875451 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.876454 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp032426851499'
        
      order by ordinal_position

  
[0m03:24:26.880453 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:24:26.883454 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.884453 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:24:26.888612 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:24:26.891611 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.892611 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp032426851499'
        
      order by ordinal_position

  
[0m03:24:26.896613 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:24:26.900618 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.900618 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:24:26.904621 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:24:26.910619 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.910619 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp032426851499'
        
      order by ordinal_position

  
[0m03:24:26.916129 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m03:24:26.927614 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.928614 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m03:24:26.929772 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m03:24:26.931772 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.933122 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m03:24:26.933122 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m03:24:26.934508 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.935524 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.935524 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp032426851499" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp032426851499" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:24:26.938520 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.002 seconds
[0m03:24:26.950520 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:24:26.951518 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m03:24:26.952520 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m03:24:26.955519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:24:26.959520 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m03:24:26.961521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e4b0e7-474b-4708-82d2-feca30cf1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C707D10D10>]}
[0m03:24:26.962521 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 1[0m in 0.29s]
[0m03:24:26.963521 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m03:24:26.964907 [debug] [MainThread]: On master: COMMIT
[0m03:24:26.964907 [debug] [MainThread]: Using postgres connection "master"
[0m03:24:26.965910 [debug] [MainThread]: On master: COMMIT
[0m03:24:26.965910 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:24:27.008249 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m03:24:27.009258 [debug] [MainThread]: On master: Close
[0m03:24:27.009258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:24:27.010258 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:24:27.010258 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m03:24:27.010258 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m03:24:27.011382 [info ] [MainThread]: 
[0m03:24:27.011382 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m03:24:27.013394 [debug] [MainThread]: Command end result
[0m03:24:27.030763 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:24:27.033763 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:24:27.038763 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:24:27.038763 [info ] [MainThread]: 
[0m03:24:27.040167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:24:27.040167 [info ] [MainThread]: 
[0m03:24:27.041573 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:24:27.042699 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:24:27.042699 after 1.96 seconds
[0m03:24:27.043698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7097D7810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C707CA2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C707CA3450>]}
[0m03:24:27.043698 [debug] [MainThread]: Flushing usage events
[0m03:24:27.773179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:25:00.706695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC4F2E250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC4143E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC4F2FBD0>]}


============================== 03:25:00.710695 | a6a7149c-90b7-43c1-908c-d8796822b157 ==============================
[0m03:25:00.710695 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:25:00.711691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt run', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m03:25:00.952556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC6197F90>]}
[0m03:25:01.022153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC0BBC310>]}
[0m03:25:01.023154 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:25:01.391038 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:25:01.539330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:25:01.540331 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:25:01.540331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:25:01.590675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC6063B10>]}
[0m03:25:01.671073 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:25:01.674320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:25:01.696570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC665D090>]}
[0m03:25:01.697570 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 463 macros
[0m03:25:01.697570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC64FFDD0>]}
[0m03:25:01.699574 [info ] [MainThread]: 
[0m03:25:01.700588 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:25:01.701586 [info ] [MainThread]: 
[0m03:25:01.701586 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:25:01.706587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m03:25:01.855183 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:25:01.856183 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:25:01.856183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:01.905577 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.050 seconds
[0m03:25:01.907575 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:25:01.911583 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:25:01.913584 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:25:01.913584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:01.960887 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.048 seconds
[0m03:25:01.963324 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:25:01.966326 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m03:25:01.966326 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m03:25:01.967323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:02.014581 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.047 seconds
[0m03:25:02.016583 [debug] [ThreadPool]: On list_web_scraper: Close
[0m03:25:02.019581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m03:25:02.024582 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:25:02.025582 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:25:02.025582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:02.081965 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.056 seconds
[0m03:25:02.083965 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:25:02.083965 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:25:02.084965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m03:25:02.088363 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:25:02.089363 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:25:02.089363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:02.143912 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.054 seconds
[0m03:25:02.144910 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:25:02.145910 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:25:02.146911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books)
[0m03:25:02.148983 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:25:02.148983 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:25:02.150402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:02.202592 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.052 seconds
[0m03:25:02.203596 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:25:02.204591 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:25:02.204591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books_books_silver)
[0m03:25:02.207000 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:25:02.208000 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:25:02.208000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:02.260719 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m03:25:02.262718 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:25:02.262718 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:25:02.267108 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:02.268119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:25:02.269117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:25:02.322633 [debug] [MainThread]: SQL status: SELECT 8 in 0.054 seconds
[0m03:25:02.324633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC6AF6B50>]}
[0m03:25:02.325634 [debug] [MainThread]: On master: ROLLBACK
[0m03:25:02.325634 [debug] [MainThread]: On master: COMMIT
[0m03:25:02.327081 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:02.327081 [debug] [MainThread]: On master: COMMIT
[0m03:25:02.328094 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:25:02.328094 [debug] [MainThread]: On master: Close
[0m03:25:02.332704 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m03:25:02.332704 [info ] [Thread-1 (]: 1 of 6 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m03:25:02.333745 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.dim_books_price_history'
[0m03:25:02.334749 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m03:25:02.341759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m03:25:02.343762 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m03:25:02.370275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m03:25:02.372273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:25:02.372273 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m03:25:02.373292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:25:02.423451 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m03:25:02.429768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:25:02.429768 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m03:25:02.431597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:25:02.434877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:25:02.435405 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m03:25:02.436501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:25:02.450321 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:25:02.450842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:25:02.451362 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m03:25:02.457937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m03:25:02.463717 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m03:25:02.467717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m03:25:02.468717 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m03:25:02.471491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:25:02.474149 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m03:25:02.476336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC6B82C10>]}
[0m03:25:02.476875 [info ] [Thread-1 (]: 1 of 6 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.14s]
[0m03:25:02.477939 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m03:25:02.478471 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m03:25:02.478996 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m03:25:02.478996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m03:25:02.480070 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m03:25:02.483070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m03:25:02.484070 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m03:25:02.501070 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m03:25:02.502070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:25:02.503070 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m03:25:02.503070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:02.550640 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.047 seconds
[0m03:25:02.556639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:25:02.556639 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m03:25:02.557640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:25:02.562643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:25:02.562643 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m03:25:02.563641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:25:02.565645 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:25:02.565645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:25:02.566679 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m03:25:02.569776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:25:02.572777 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m03:25:02.575936 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m03:25:02.575936 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m03:25:02.580323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:25:02.582323 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m03:25:02.582323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC6BD8F50>]}
[0m03:25:02.583323 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.10s]
[0m03:25:02.584323 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m03:25:02.585493 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m03:25:02.586494 [info ] [Thread-1 (]: 3 of 6 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m03:25:02.586494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m03:25:02.588003 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m03:25:02.589998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m03:25:02.590999 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m03:25:02.595002 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m03:25:02.596002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:25:02.596002 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m03:25:02.596999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:02.646516 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m03:25:02.650240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:25:02.650240 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m03:25:02.652242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:25:02.654243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:25:02.655242 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m03:25:02.656241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:25:02.657248 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:25:02.658242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:25:02.658242 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m03:25:02.669346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m03:25:02.672348 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m03:25:02.673347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m03:25:02.673347 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m03:25:02.676817 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m03:25:02.677829 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m03:25:02.678842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC6AABBD0>]}
[0m03:25:02.679837 [info ] [Thread-1 (]: 3 of 6 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.09s]
[0m03:25:02.680828 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m03:25:02.680828 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m03:25:02.681825 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m03:25:02.682827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m03:25:02.682827 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m03:25:02.685826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m03:25:02.687836 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m03:25:02.690839 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m03:25:02.691837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:25:02.691837 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m03:25:02.692838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:02.743501 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m03:25:02.746501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:25:02.746501 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m03:25:02.747502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:25:02.749012 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:25:02.750019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:25:02.750019 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m03:25:02.753409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:25:02.756409 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m03:25:02.757409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m03:25:02.757409 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m03:25:02.758411 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:25:02.760676 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m03:25:02.760676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC6C30A50>]}
[0m03:25:02.761675 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:25:02.762674 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m03:25:02.762674 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m03:25:02.762674 [info ] [Thread-1 (]: 5 of 6 START sql view model books_books.dim_books .............................. [RUN]
[0m03:25:02.763952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m03:25:02.763952 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m03:25:02.767945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m03:25:02.768944 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m03:25:02.771944 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m03:25:02.772944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:25:02.772944 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m03:25:02.773945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:02.824224 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m03:25:02.826224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:25:02.827225 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m03:25:02.828222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:25:02.829725 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:25:02.830728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:25:02.830728 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m03:25:02.839940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m03:25:02.842976 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m03:25:02.842976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m03:25:02.844323 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m03:25:02.845366 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:25:02.846364 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m03:25:02.847365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC6C30650>]}
[0m03:25:02.847365 [info ] [Thread-1 (]: 5 of 6 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m03:25:02.848365 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m03:25:02.849687 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m03:25:02.850689 [info ] [Thread-1 (]: 6 of 6 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m03:25:02.850689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m03:25:02.851688 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m03:25:02.853980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m03:25:02.854990 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m03:25:02.859490 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m03:25:02.860490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:25:02.860490 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m03:25:02.861492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:02.910277 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m03:25:02.914274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:25:02.914274 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m03:25:02.915274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:25:02.916274 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:25:02.917275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:25:02.917275 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m03:25:02.933715 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m03:25:02.936784 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m03:25:02.936784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m03:25:02.937797 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m03:25:02.938797 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:25:02.940882 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m03:25:02.940882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a7149c-90b7-43c1-908c-d8796822b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC6C30850>]}
[0m03:25:02.941894 [info ] [Thread-1 (]: 6 of 6 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.09s]
[0m03:25:02.943202 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m03:25:02.944202 [debug] [MainThread]: On master: COMMIT
[0m03:25:02.945695 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:02.946203 [debug] [MainThread]: On master: COMMIT
[0m03:25:02.947394 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:25:02.993149 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m03:25:02.993149 [debug] [MainThread]: On master: Close
[0m03:25:02.994149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:02.994149 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m03:25:02.995370 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m03:25:02.996451 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m03:25:02.996451 [info ] [MainThread]: 
[0m03:25:02.997517 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m03:25:02.999517 [debug] [MainThread]: Command end result
[0m03:25:03.018580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:25:03.021581 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:25:03.027654 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:25:03.028653 [info ] [MainThread]: 
[0m03:25:03.028653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:25:03.029901 [info ] [MainThread]: 
[0m03:25:03.029901 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m03:25:03.032092 [debug] [MainThread]: Command `dbt run` succeeded at 03:25:03.032092 after 2.41 seconds
[0m03:25:03.032092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC60335D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC4F21FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC4F23910>]}
[0m03:25:03.033103 [debug] [MainThread]: Flushing usage events
[0m03:25:03.773193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:37:28.869181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACB8FAF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACB8D35910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACB8FAE990>]}


============================== 03:37:28.873610 | 7c89787a-2349-403a-b507-4d5ea373fd52 ==============================
[0m03:37:28.873610 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:37:28.874625 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt test', 'printer_width': '80', 'target_path': 'None'}
[0m03:37:29.118307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c89787a-2349-403a-b507-4d5ea373fd52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACBA0D4990>]}
[0m03:37:29.184629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c89787a-2349-403a-b507-4d5ea373fd52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACB4C01650>]}
[0m03:37:29.185631 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:37:29.537939 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:37:29.725431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m03:37:29.725431 [debug] [MainThread]: Partial parsing: added file: dbt_train://snapshots\books_price_snapshot.yml
[0m03:37:29.726455 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\staging\stg_books.yml
[0m03:37:29.727470 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\sources\books_sources.yml
[0m03:37:30.543693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c89787a-2349-403a-b507-4d5ea373fd52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACBAC1DA50>]}
[0m03:37:30.622889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:37:30.624959 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:37:30.655265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c89787a-2349-403a-b507-4d5ea373fd52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACBAEEC890>]}
[0m03:37:30.655265 [info ] [MainThread]: Found 6 models, 1 snapshot, 11 data tests, 1 source, 463 macros
[0m03:37:30.656366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c89787a-2349-403a-b507-4d5ea373fd52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACBABCC550>]}
[0m03:37:30.658366 [info ] [MainThread]: 
[0m03:37:30.659375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:37:30.660364 [info ] [MainThread]: 
[0m03:37:30.661368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:37:30.666555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m03:37:30.756240 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:37:30.756240 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:37:30.757240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:37:30.815115 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.057 seconds
[0m03:37:30.816622 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:37:30.817629 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:37:30.818631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m03:37:30.821629 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:37:30.821629 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:37:30.822632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:37:30.983842 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.162 seconds
[0m03:37:30.985842 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:37:30.985842 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:37:30.986846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m03:37:30.989843 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:37:30.989843 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:37:30.990843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:37:31.044085 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.053 seconds
[0m03:37:31.045087 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:37:31.046097 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:37:31.047086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books)
[0m03:37:31.050371 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:37:31.050371 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:37:31.051371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:37:31.102984 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.051 seconds
[0m03:37:31.103988 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:37:31.104985 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:37:31.110150 [debug] [MainThread]: Using postgres connection "master"
[0m03:37:31.110150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:37:31.111159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:37:31.166208 [debug] [MainThread]: SQL status: SELECT 8 in 0.055 seconds
[0m03:37:31.169207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c89787a-2349-403a-b507-4d5ea373fd52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACBC2B9850>]}
[0m03:37:31.169207 [debug] [MainThread]: On master: ROLLBACK
[0m03:37:31.170214 [debug] [MainThread]: On master: COMMIT
[0m03:37:31.171218 [debug] [MainThread]: Using postgres connection "master"
[0m03:37:31.171218 [debug] [MainThread]: On master: COMMIT
[0m03:37:31.172216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:37:31.172216 [debug] [MainThread]: On master: Close
[0m03:37:31.176513 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:37:31.177733 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_books_rating__One__Two__Three__Four__Five  [RUN]
[0m03:37:31.177733 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5'
[0m03:37:31.179112 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:37:31.186113 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m03:37:31.187112 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:37:31.201113 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m03:37:31.203118 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m03:37:31.203118 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from "web_scraper"."books_books_silver"."stg_books"
    group by rating

)

select *
from all_values
where value_field not in (
    'One','Two','Three','Four','Five'
)



  
  
      
    ) dbt_internal_test
[0m03:37:31.204118 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:37:31.257617 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.053 seconds
[0m03:37:31.260615 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: ROLLBACK
[0m03:37:31.261615 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: Close
[0m03:37:31.262614 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_books_rating__One__Two__Three__Four__Five ..... [[32mPASS[0m in 0.08s]
[0m03:37:31.263614 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:37:31.263614 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m03:37:31.264940 [info ] [Thread-1 (]: 2 of 11 START test not_null_books_price_snapshot_dbt_valid_from ................ [RUN]
[0m03:37:31.264940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa)
[0m03:37:31.265936 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m03:37:31.271070 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m03:37:31.273220 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m03:37:31.275217 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m03:37:31.276217 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m03:37:31.277215 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "web_scraper"."snapshots"."books_price_snapshot"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m03:37:31.277215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.325894 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.049 seconds
[0m03:37:31.326894 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa: ROLLBACK
[0m03:37:31.328185 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa: Close
[0m03:37:31.329243 [info ] [Thread-1 (]: 2 of 11 PASS not_null_books_price_snapshot_dbt_valid_from ...................... [[32mPASS[0m in 0.06s]
[0m03:37:31.330240 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m03:37:31.330240 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m03:37:31.331245 [info ] [Thread-1 (]: 3 of 11 START test not_null_books_price_snapshot_id ............................ [RUN]
[0m03:37:31.331245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa, now test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf)
[0m03:37:31.332245 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m03:37:31.336243 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m03:37:31.337257 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m03:37:31.339337 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m03:37:31.341337 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m03:37:31.341337 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."snapshots"."books_price_snapshot"
where id is null



  
  
      
    ) dbt_internal_test
[0m03:37:31.342493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.389305 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m03:37:31.391304 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf: ROLLBACK
[0m03:37:31.391304 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf: Close
[0m03:37:31.392314 [info ] [Thread-1 (]: 3 of 11 PASS not_null_books_price_snapshot_id .................................. [[32mPASS[0m in 0.06s]
[0m03:37:31.393317 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m03:37:31.394646 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m03:37:31.394646 [info ] [Thread-1 (]: 4 of 11 START test not_null_books_price_snapshot_price ......................... [RUN]
[0m03:37:31.395647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf, now test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7)
[0m03:37:31.395647 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m03:37:31.399666 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m03:37:31.400667 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m03:37:31.404674 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m03:37:31.405675 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m03:37:31.405675 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "web_scraper"."snapshots"."books_price_snapshot"
where price is null



  
  
      
    ) dbt_internal_test
[0m03:37:31.406676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.455955 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.049 seconds
[0m03:37:31.457953 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7: ROLLBACK
[0m03:37:31.457953 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7: Close
[0m03:37:31.458952 [error] [Thread-1 (]: 4 of 11 FAIL 2 not_null_books_price_snapshot_price ............................. [[31mFAIL 2[0m in 0.06s]
[0m03:37:31.459954 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m03:37:31.459954 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m03:37:31.461165 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_books_available_quantity ....................... [RUN]
[0m03:37:31.461165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7, now test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1)
[0m03:37:31.462441 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m03:37:31.465441 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m03:37:31.466441 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m03:37:31.468441 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m03:37:31.469441 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m03:37:31.470441 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select available_quantity
from "web_scraper"."books_books_silver"."stg_books"
where available_quantity is null



  
  
      
    ) dbt_internal_test
[0m03:37:31.470441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.518132 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m03:37:31.520129 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1: ROLLBACK
[0m03:37:31.520129 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1: Close
[0m03:37:31.521132 [error] [Thread-1 (]: 5 of 11 FAIL 38 not_null_stg_books_available_quantity .......................... [[31mFAIL 38[0m in 0.06s]
[0m03:37:31.522129 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m03:37:31.523129 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:37:31.523129 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_books_book_id .................................. [RUN]
[0m03:37:31.524384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m03:37:31.525394 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:37:31.528394 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m03:37:31.529394 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:37:31.531394 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m03:37:31.532394 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m03:37:31.533394 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select book_id
from "web_scraper"."books_books_silver"."stg_books"
where book_id is null



  
  
      
    ) dbt_internal_test
[0m03:37:31.533394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.579227 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m03:37:31.581223 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: ROLLBACK
[0m03:37:31.581223 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: Close
[0m03:37:31.583222 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stg_books_book_id ........................................ [[32mPASS[0m in 0.06s]
[0m03:37:31.583222 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:37:31.584612 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m03:37:31.584612 [info ] [Thread-1 (]: 7 of 11 START test source_not_null_public_books_category ....................... [RUN]
[0m03:37:31.585949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.source_not_null_public_books_category.6ec115d14f)
[0m03:37:31.585949 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m03:37:31.590002 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m03:37:31.591002 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m03:37:31.594002 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m03:37:31.595001 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m03:37:31.596002 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_category.6ec115d14f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_not_null_public_books_category.6ec115d14f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category
from "web_scraper"."public"."books"
where category is null



  
  
      
    ) dbt_internal_test
[0m03:37:31.596002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.645182 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.049 seconds
[0m03:37:31.647182 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_category.6ec115d14f: ROLLBACK
[0m03:37:31.648183 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_category.6ec115d14f: Close
[0m03:37:31.649182 [error] [Thread-1 (]: 7 of 11 FAIL 16 source_not_null_public_books_category .......................... [[31mFAIL 16[0m in 0.06s]
[0m03:37:31.650181 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m03:37:31.650181 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m03:37:31.651212 [info ] [Thread-1 (]: 8 of 11 START test source_not_null_public_books_id ............................. [RUN]
[0m03:37:31.652212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_category.6ec115d14f, now test.dbt_train.source_not_null_public_books_id.39867b96d1)
[0m03:37:31.652212 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m03:37:31.656221 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m03:37:31.657221 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m03:37:31.660222 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m03:37:31.661224 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m03:37:31.662377 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_id.39867b96d1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_not_null_public_books_id.39867b96d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."public"."books"
where id is null



  
  
      
    ) dbt_internal_test
[0m03:37:31.662377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.711434 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m03:37:31.712435 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_id.39867b96d1: ROLLBACK
[0m03:37:31.713447 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_id.39867b96d1: Close
[0m03:37:31.714434 [info ] [Thread-1 (]: 8 of 11 PASS source_not_null_public_books_id ................................... [[32mPASS[0m in 0.06s]
[0m03:37:31.715805 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m03:37:31.716314 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m03:37:31.717325 [info ] [Thread-1 (]: 9 of 11 START test source_not_null_public_books_price .......................... [RUN]
[0m03:37:31.717325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_id.39867b96d1, now test.dbt_train.source_not_null_public_books_price.9e3bad0890)
[0m03:37:31.718408 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m03:37:31.721408 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m03:37:31.722408 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m03:37:31.725409 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m03:37:31.726408 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m03:37:31.726408 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_price.9e3bad0890: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_not_null_public_books_price.9e3bad0890"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "web_scraper"."public"."books"
where price is null



  
  
      
    ) dbt_internal_test
[0m03:37:31.727408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.775271 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m03:37:31.776271 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_price.9e3bad0890: ROLLBACK
[0m03:37:31.777268 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_price.9e3bad0890: Close
[0m03:37:31.778268 [error] [Thread-1 (]: 9 of 11 FAIL 2 source_not_null_public_books_price .............................. [[31mFAIL 2[0m in 0.06s]
[0m03:37:31.779678 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m03:37:31.779678 [debug] [Thread-1 (]: Began running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m03:37:31.780676 [info ] [Thread-1 (]: 10 of 11 START test source_unique_public_books_id .............................. [RUN]
[0m03:37:31.780676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_price.9e3bad0890, now test.dbt_train.source_unique_public_books_id.dbdeae80c5)
[0m03:37:31.782067 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m03:37:31.789300 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m03:37:31.790300 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m03:37:31.868815 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m03:37:31.869816 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m03:37:31.870815 [debug] [Thread-1 (]: On test.dbt_train.source_unique_public_books_id.dbdeae80c5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_unique_public_books_id.dbdeae80c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."public"."books"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:37:31.870815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.917224 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m03:37:31.919252 [debug] [Thread-1 (]: On test.dbt_train.source_unique_public_books_id.dbdeae80c5: ROLLBACK
[0m03:37:31.920239 [debug] [Thread-1 (]: On test.dbt_train.source_unique_public_books_id.dbdeae80c5: Close
[0m03:37:31.921261 [info ] [Thread-1 (]: 10 of 11 PASS source_unique_public_books_id .................................... [[32mPASS[0m in 0.14s]
[0m03:37:31.922486 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m03:37:31.922486 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:37:31.923483 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_books_book_id ................................... [RUN]
[0m03:37:31.924504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_unique_public_books_id.dbdeae80c5, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m03:37:31.925515 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:37:31.929514 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m03:37:31.930513 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:37:31.933514 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m03:37:31.934513 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m03:37:31.934513 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_stg_books_book_id.ca28902f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    book_id as unique_field,
    count(*) as n_records

from "web_scraper"."books_books_silver"."stg_books"
where book_id is not null
group by book_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:37:31.935514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:31.982596 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m03:37:31.984790 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: ROLLBACK
[0m03:37:31.984790 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: Close
[0m03:37:31.985790 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_books_book_id ......................................... [[32mPASS[0m in 0.06s]
[0m03:37:31.986790 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:37:31.988125 [debug] [MainThread]: On master: COMMIT
[0m03:37:31.989190 [debug] [MainThread]: Using postgres connection "master"
[0m03:37:31.989190 [debug] [MainThread]: On master: COMMIT
[0m03:37:31.990195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:37:32.034600 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m03:37:32.034600 [debug] [MainThread]: On master: Close
[0m03:37:32.035600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:37:32.035600 [debug] [MainThread]: Connection 'list_web_scraper_books_books' was properly closed.
[0m03:37:32.035600 [debug] [MainThread]: Connection 'test.dbt_train.unique_stg_books_book_id.ca28902f83' was properly closed.
[0m03:37:32.037105 [info ] [MainThread]: 
[0m03:37:32.037105 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m03:37:32.039108 [debug] [MainThread]: Command end result
[0m03:37:32.059105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:37:32.062108 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:37:32.068108 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:37:32.069106 [info ] [MainThread]: 
[0m03:37:32.069106 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m03:37:32.070106 [info ] [MainThread]: 
[0m03:37:32.071103 [error] [MainThread]: [31mFailure in test not_null_books_price_snapshot_price (snapshots\books_price_snapshot.yml)[0m
[0m03:37:32.072241 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:37:32.072241 [info ] [MainThread]: 
[0m03:37:32.073240 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\snapshots\books_price_snapshot.yml\not_null_books_price_snapshot_price.sql
[0m03:37:32.074244 [info ] [MainThread]: 
[0m03:37:32.074244 [error] [MainThread]: [31mFailure in test not_null_stg_books_available_quantity (models\staging\stg_books.yml)[0m
[0m03:37:32.075239 [error] [MainThread]:   Got 38 results, configured to fail if != 0
[0m03:37:32.075239 [info ] [MainThread]: 
[0m03:37:32.076241 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\staging\stg_books.yml\not_null_stg_books_available_quantity.sql
[0m03:37:32.076241 [info ] [MainThread]: 
[0m03:37:32.077243 [error] [MainThread]: [31mFailure in test source_not_null_public_books_category (models\sources\books_sources.yml)[0m
[0m03:37:32.078445 [error] [MainThread]:   Got 16 results, configured to fail if != 0
[0m03:37:32.078445 [info ] [MainThread]: 
[0m03:37:32.079442 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\sources\books_sources.yml\source_not_null_public_books_category.sql
[0m03:37:32.079442 [info ] [MainThread]: 
[0m03:37:32.080441 [error] [MainThread]: [31mFailure in test source_not_null_public_books_price (models\sources\books_sources.yml)[0m
[0m03:37:32.080441 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:37:32.081442 [info ] [MainThread]: 
[0m03:37:32.081442 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\sources\books_sources.yml\source_not_null_public_books_price.sql
[0m03:37:32.082441 [info ] [MainThread]: 
[0m03:37:32.083442 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=11
[0m03:37:32.084440 [debug] [MainThread]: Command `dbt test` failed at 03:37:32.084440 after 3.31 seconds
[0m03:37:32.085549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACBA98D4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACBA98DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACBA99DC10>]}
[0m03:37:32.086588 [debug] [MainThread]: Flushing usage events
[0m03:37:32.772830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:38:33.499631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA8A2AF190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA8A0355D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA8A2A3FD0>]}


============================== 03:38:33.503631 | 473a99f1-a8f9-4243-a1ac-66862928a654 ==============================
[0m03:38:33.503631 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:38:33.504630 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m03:38:33.738658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '473a99f1-a8f9-4243-a1ac-66862928a654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA8A522090>]}
[0m03:38:33.803186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '473a99f1-a8f9-4243-a1ac-66862928a654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA84F1D650>]}
[0m03:38:33.804182 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:38:34.146771 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:38:34.338517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:38:34.339516 [debug] [MainThread]: Partial parsing: added file: dbt_train://tests\price_should_be_positive.sql
[0m03:38:34.591444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '473a99f1-a8f9-4243-a1ac-66862928a654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA8A5E1B90>]}
[0m03:38:34.687251 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:38:34.690248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:38:34.721249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '473a99f1-a8f9-4243-a1ac-66862928a654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA8A5E37D0>]}
[0m03:38:34.721249 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m03:38:34.722250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '473a99f1-a8f9-4243-a1ac-66862928a654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA8AAA9350>]}
[0m03:38:34.724254 [info ] [MainThread]: 
[0m03:38:34.725248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:38:34.726263 [info ] [MainThread]: 
[0m03:38:34.727264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:38:34.732259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m03:38:34.820781 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m03:38:34.821781 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m03:38:34.821781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:38:34.982829 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.161 seconds
[0m03:38:34.983842 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m03:38:34.984837 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m03:38:34.985848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_snapshots)
[0m03:38:34.988839 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m03:38:34.988839 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m03:38:34.989842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:38:35.043415 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.054 seconds
[0m03:38:35.044415 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m03:38:35.045420 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m03:38:35.046417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m03:38:35.048415 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m03:38:35.048415 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m03:38:35.049420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:38:35.098880 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m03:38:35.100880 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m03:38:35.100880 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m03:38:35.101879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m03:38:35.104881 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m03:38:35.104881 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m03:38:35.105879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:38:35.159625 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.054 seconds
[0m03:38:35.161623 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m03:38:35.162628 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m03:38:35.167635 [debug] [MainThread]: Using postgres connection "master"
[0m03:38:35.168642 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:38:35.168642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:38:35.220856 [debug] [MainThread]: SQL status: SELECT 8 in 0.051 seconds
[0m03:38:35.222856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '473a99f1-a8f9-4243-a1ac-66862928a654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA88C3C950>]}
[0m03:38:35.223860 [debug] [MainThread]: On master: ROLLBACK
[0m03:38:35.223860 [debug] [MainThread]: On master: COMMIT
[0m03:38:35.224856 [debug] [MainThread]: Using postgres connection "master"
[0m03:38:35.224856 [debug] [MainThread]: On master: COMMIT
[0m03:38:35.225857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:38:35.225857 [debug] [MainThread]: On master: Close
[0m03:38:35.229857 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:38:35.230855 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_books_rating__One__Two__Three__Four__Five  [RUN]
[0m03:38:35.231857 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5'
[0m03:38:35.232858 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:38:35.245869 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m03:38:35.247870 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:38:35.261870 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m03:38:35.262868 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m03:38:35.262868 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from "web_scraper"."books_books_silver"."stg_books"
    group by rating

)

select *
from all_values
where value_field not in (
    'One','Two','Three','Four','Five'
)



  
  
      
    ) dbt_internal_test
[0m03:38:35.264360 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:38:35.312486 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m03:38:35.315485 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: ROLLBACK
[0m03:38:35.316488 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: Close
[0m03:38:35.317491 [info ] [Thread-1 (]: 1 of 12 PASS accepted_values_stg_books_rating__One__Two__Three__Four__Five ..... [[32mPASS[0m in 0.09s]
[0m03:38:35.318487 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m03:38:35.318487 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m03:38:35.319489 [info ] [Thread-1 (]: 2 of 12 START test not_null_books_price_snapshot_dbt_valid_from ................ [RUN]
[0m03:38:35.319489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa)
[0m03:38:35.320487 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m03:38:35.325488 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m03:38:35.326486 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m03:38:35.328487 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m03:38:35.329489 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m03:38:35.330490 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "web_scraper"."snapshots"."books_price_snapshot"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m03:38:35.330490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.376492 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m03:38:35.378491 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa: ROLLBACK
[0m03:38:35.379495 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa: Close
[0m03:38:35.380492 [info ] [Thread-1 (]: 2 of 12 PASS not_null_books_price_snapshot_dbt_valid_from ...................... [[32mPASS[0m in 0.06s]
[0m03:38:35.381491 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m03:38:35.381491 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m03:38:35.381491 [info ] [Thread-1 (]: 3 of 12 START test not_null_books_price_snapshot_id ............................ [RUN]
[0m03:38:35.382492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa, now test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf)
[0m03:38:35.383492 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m03:38:35.387633 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m03:38:35.388634 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m03:38:35.390798 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m03:38:35.390798 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m03:38:35.391803 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."snapshots"."books_price_snapshot"
where id is null



  
  
      
    ) dbt_internal_test
[0m03:38:35.391803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.442800 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.051 seconds
[0m03:38:35.445801 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf: ROLLBACK
[0m03:38:35.445801 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf: Close
[0m03:38:35.446802 [info ] [Thread-1 (]: 3 of 12 PASS not_null_books_price_snapshot_id .................................. [[32mPASS[0m in 0.06s]
[0m03:38:35.447800 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m03:38:35.448802 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m03:38:35.448802 [info ] [Thread-1 (]: 4 of 12 START test not_null_books_price_snapshot_price ......................... [RUN]
[0m03:38:35.449801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf, now test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7)
[0m03:38:35.450804 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m03:38:35.453799 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m03:38:35.454801 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m03:38:35.458799 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m03:38:35.459801 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m03:38:35.460801 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "web_scraper"."snapshots"."books_price_snapshot"
where price is null



  
  
      
    ) dbt_internal_test
[0m03:38:35.460801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.509141 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m03:38:35.511146 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7: ROLLBACK
[0m03:38:35.512142 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7: Close
[0m03:38:35.513146 [error] [Thread-1 (]: 4 of 12 FAIL 2 not_null_books_price_snapshot_price ............................. [[31mFAIL 2[0m in 0.06s]
[0m03:38:35.514142 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m03:38:35.514142 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m03:38:35.515142 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_books_available_quantity ....................... [RUN]
[0m03:38:35.516142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7, now test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1)
[0m03:38:35.516142 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m03:38:35.520141 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m03:38:35.521140 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m03:38:35.523144 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m03:38:35.525145 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m03:38:35.525145 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select available_quantity
from "web_scraper"."books_books_silver"."stg_books"
where available_quantity is null



  
  
      
    ) dbt_internal_test
[0m03:38:35.526144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.571148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m03:38:35.573150 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1: ROLLBACK
[0m03:38:35.573150 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1: Close
[0m03:38:35.574150 [error] [Thread-1 (]: 5 of 12 FAIL 38 not_null_stg_books_available_quantity .......................... [[31mFAIL 38[0m in 0.06s]
[0m03:38:35.575150 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m03:38:35.575150 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:38:35.576345 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_books_book_id .................................. [RUN]
[0m03:38:35.576345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m03:38:35.577346 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:38:35.580350 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m03:38:35.581348 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:38:35.583851 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m03:38:35.584878 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m03:38:35.585879 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select book_id
from "web_scraper"."books_books_silver"."stg_books"
where book_id is null



  
  
      
    ) dbt_internal_test
[0m03:38:35.585879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.632394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m03:38:35.634390 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: ROLLBACK
[0m03:38:35.634390 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: Close
[0m03:38:35.635396 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_books_book_id ........................................ [[32mPASS[0m in 0.06s]
[0m03:38:35.636396 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m03:38:35.636396 [debug] [Thread-1 (]: Began running node test.dbt_train.price_should_be_positive
[0m03:38:35.637395 [info ] [Thread-1 (]: 7 of 12 START test price_should_be_positive .................................... [RUN]
[0m03:38:35.637395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.price_should_be_positive)
[0m03:38:35.638396 [debug] [Thread-1 (]: Began compiling node test.dbt_train.price_should_be_positive
[0m03:38:35.640391 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.price_should_be_positive"
[0m03:38:35.642392 [debug] [Thread-1 (]: Began executing node test.dbt_train.price_should_be_positive
[0m03:38:35.645395 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.price_should_be_positive"
[0m03:38:35.646394 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.price_should_be_positive"
[0m03:38:35.646394 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.price_should_be_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "web_scraper"."books_books_silver"."stg_books"
where price <= 0
  
  
      
    ) dbt_internal_test
[0m03:38:35.647396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.694920 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m03:38:35.696922 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: ROLLBACK
[0m03:38:35.696922 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: Close
[0m03:38:35.697923 [info ] [Thread-1 (]: 7 of 12 PASS price_should_be_positive .......................................... [[32mPASS[0m in 0.06s]
[0m03:38:35.698926 [debug] [Thread-1 (]: Finished running node test.dbt_train.price_should_be_positive
[0m03:38:35.699921 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m03:38:35.699921 [info ] [Thread-1 (]: 8 of 12 START test source_not_null_public_books_category ....................... [RUN]
[0m03:38:35.700926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.price_should_be_positive, now test.dbt_train.source_not_null_public_books_category.6ec115d14f)
[0m03:38:35.701925 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m03:38:35.704932 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m03:38:35.706930 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m03:38:35.708925 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m03:38:35.709931 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m03:38:35.709931 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_category.6ec115d14f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_not_null_public_books_category.6ec115d14f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category
from "web_scraper"."public"."books"
where category is null



  
  
      
    ) dbt_internal_test
[0m03:38:35.710928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.758950 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m03:38:35.760959 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_category.6ec115d14f: ROLLBACK
[0m03:38:35.761946 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_category.6ec115d14f: Close
[0m03:38:35.762944 [error] [Thread-1 (]: 8 of 12 FAIL 16 source_not_null_public_books_category .......................... [[31mFAIL 16[0m in 0.06s]
[0m03:38:35.763947 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m03:38:35.763947 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m03:38:35.764943 [info ] [Thread-1 (]: 9 of 12 START test source_not_null_public_books_id ............................. [RUN]
[0m03:38:35.765944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_category.6ec115d14f, now test.dbt_train.source_not_null_public_books_id.39867b96d1)
[0m03:38:35.765944 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m03:38:35.769948 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m03:38:35.770953 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m03:38:35.772952 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m03:38:35.774953 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m03:38:35.774953 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_id.39867b96d1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_not_null_public_books_id.39867b96d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."public"."books"
where id is null



  
  
      
    ) dbt_internal_test
[0m03:38:35.775951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.822473 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m03:38:35.823484 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_id.39867b96d1: ROLLBACK
[0m03:38:35.824478 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_id.39867b96d1: Close
[0m03:38:35.825473 [info ] [Thread-1 (]: 9 of 12 PASS source_not_null_public_books_id ................................... [[32mPASS[0m in 0.06s]
[0m03:38:35.826477 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m03:38:35.826477 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m03:38:35.827472 [info ] [Thread-1 (]: 10 of 12 START test source_not_null_public_books_price ......................... [RUN]
[0m03:38:35.828475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_id.39867b96d1, now test.dbt_train.source_not_null_public_books_price.9e3bad0890)
[0m03:38:35.828475 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m03:38:35.834473 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m03:38:35.835477 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m03:38:35.837476 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m03:38:35.838477 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m03:38:35.838477 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_price.9e3bad0890: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_not_null_public_books_price.9e3bad0890"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "web_scraper"."public"."books"
where price is null



  
  
      
    ) dbt_internal_test
[0m03:38:35.839474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.885992 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m03:38:35.887990 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_price.9e3bad0890: ROLLBACK
[0m03:38:35.888990 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_price.9e3bad0890: Close
[0m03:38:35.888990 [error] [Thread-1 (]: 10 of 12 FAIL 2 source_not_null_public_books_price ............................. [[31mFAIL 2[0m in 0.06s]
[0m03:38:35.890990 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m03:38:35.890990 [debug] [Thread-1 (]: Began running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m03:38:35.891989 [info ] [Thread-1 (]: 11 of 12 START test source_unique_public_books_id .............................. [RUN]
[0m03:38:35.892992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_price.9e3bad0890, now test.dbt_train.source_unique_public_books_id.dbdeae80c5)
[0m03:38:35.893993 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m03:38:35.898992 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m03:38:35.899994 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m03:38:35.901991 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m03:38:35.902990 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m03:38:35.903995 [debug] [Thread-1 (]: On test.dbt_train.source_unique_public_books_id.dbdeae80c5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_unique_public_books_id.dbdeae80c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."public"."books"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:38:35.903995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:35.952989 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m03:38:35.953990 [debug] [Thread-1 (]: On test.dbt_train.source_unique_public_books_id.dbdeae80c5: ROLLBACK
[0m03:38:35.954994 [debug] [Thread-1 (]: On test.dbt_train.source_unique_public_books_id.dbdeae80c5: Close
[0m03:38:35.955993 [info ] [Thread-1 (]: 11 of 12 PASS source_unique_public_books_id .................................... [[32mPASS[0m in 0.06s]
[0m03:38:35.956994 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m03:38:35.956994 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:38:35.957992 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_books_book_id ................................... [RUN]
[0m03:38:35.957992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_unique_public_books_id.dbdeae80c5, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m03:38:35.958991 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:38:35.962990 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m03:38:35.963991 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:38:35.965992 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m03:38:35.966990 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m03:38:35.967994 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_stg_books_book_id.ca28902f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    book_id as unique_field,
    count(*) as n_records

from "web_scraper"."books_books_silver"."stg_books"
where book_id is not null
group by book_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:38:35.967994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:38:36.016479 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.048 seconds
[0m03:38:36.017708 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: ROLLBACK
[0m03:38:36.018709 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: Close
[0m03:38:36.019708 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_books_book_id ......................................... [[32mPASS[0m in 0.06s]
[0m03:38:36.019708 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m03:38:36.021756 [debug] [MainThread]: On master: COMMIT
[0m03:38:36.021756 [debug] [MainThread]: Using postgres connection "master"
[0m03:38:36.022759 [debug] [MainThread]: On master: COMMIT
[0m03:38:36.022759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:38:36.071259 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m03:38:36.072259 [debug] [MainThread]: On master: Close
[0m03:38:36.072259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:38:36.073264 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m03:38:36.073264 [debug] [MainThread]: Connection 'test.dbt_train.unique_stg_books_book_id.ca28902f83' was properly closed.
[0m03:38:36.074259 [info ] [MainThread]: 
[0m03:38:36.074259 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m03:38:36.076260 [debug] [MainThread]: Command end result
[0m03:38:36.096773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m03:38:36.098772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m03:38:36.104771 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m03:38:36.105772 [info ] [MainThread]: 
[0m03:38:36.106772 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m03:38:36.107774 [info ] [MainThread]: 
[0m03:38:36.107774 [error] [MainThread]: [31mFailure in test not_null_books_price_snapshot_price (snapshots\books_price_snapshot.yml)[0m
[0m03:38:36.108776 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:38:36.109771 [info ] [MainThread]: 
[0m03:38:36.110771 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\snapshots\books_price_snapshot.yml\not_null_books_price_snapshot_price.sql
[0m03:38:36.110771 [info ] [MainThread]: 
[0m03:38:36.111776 [error] [MainThread]: [31mFailure in test not_null_stg_books_available_quantity (models\staging\stg_books.yml)[0m
[0m03:38:36.111776 [error] [MainThread]:   Got 38 results, configured to fail if != 0
[0m03:38:36.112771 [info ] [MainThread]: 
[0m03:38:36.113772 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\staging\stg_books.yml\not_null_stg_books_available_quantity.sql
[0m03:38:36.113772 [info ] [MainThread]: 
[0m03:38:36.114775 [error] [MainThread]: [31mFailure in test source_not_null_public_books_category (models\sources\books_sources.yml)[0m
[0m03:38:36.115774 [error] [MainThread]:   Got 16 results, configured to fail if != 0
[0m03:38:36.115774 [info ] [MainThread]: 
[0m03:38:36.116776 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\sources\books_sources.yml\source_not_null_public_books_category.sql
[0m03:38:36.116776 [info ] [MainThread]: 
[0m03:38:36.117771 [error] [MainThread]: [31mFailure in test source_not_null_public_books_price (models\sources\books_sources.yml)[0m
[0m03:38:36.118772 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:38:36.118772 [info ] [MainThread]: 
[0m03:38:36.118772 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\sources\books_sources.yml\source_not_null_public_books_price.sql
[0m03:38:36.120080 [info ] [MainThread]: 
[0m03:38:36.121111 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=12
[0m03:38:36.122136 [debug] [MainThread]: Command `dbt test` failed at 03:38:36.122136 after 2.71 seconds
[0m03:38:36.123131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA83F08310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA83F08290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA8A1D90D0>]}
[0m03:38:36.123131 [debug] [MainThread]: Flushing usage events
[0m03:38:36.822017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:00.671069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAAAE2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAAAE310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAAADF90>]}


============================== 16:07:00.702375 | 09b3a807-fb22-4154-ac9b-29f0ad711887 ==============================
[0m16:07:00.702375 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:07:00.704388 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m16:07:00.723061 [info ] [MainThread]: dbt version: 1.11.2
[0m16:07:00.724065 [info ] [MainThread]: python version: 3.11.9
[0m16:07:00.725059 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m16:07:00.725059 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m16:07:00.779059 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m16:07:00.779865 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m16:07:00.781139 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m16:07:00.782197 [info ] [MainThread]: adapter type: postgres
[0m16:07:00.782197 [info ] [MainThread]: adapter version: 1.10.0
[0m16:07:00.897775 [info ] [MainThread]: Configuration:
[0m16:07:00.899752 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:07:00.900747 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:07:00.900747 [info ] [MainThread]: Required dependencies:
[0m16:07:00.901747 [debug] [MainThread]: Executing "git --help"
[0m16:07:00.945130 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:07:00.946133 [debug] [MainThread]: STDERR: "b''"
[0m16:07:00.946133 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:07:00.947131 [info ] [MainThread]: Connection:
[0m16:07:00.947131 [info ] [MainThread]:   host: localhost
[0m16:07:00.948133 [info ] [MainThread]:   port: 5432
[0m16:07:00.948133 [info ] [MainThread]:   user: amgad
[0m16:07:00.949134 [info ] [MainThread]:   database: web_scraper
[0m16:07:00.950129 [info ] [MainThread]:   schema: books
[0m16:07:00.950826 [info ] [MainThread]:   connect_timeout: 10
[0m16:07:00.950826 [info ] [MainThread]:   role: None
[0m16:07:00.952063 [info ] [MainThread]:   search_path: None
[0m16:07:00.952063 [info ] [MainThread]:   keepalives_idle: 0
[0m16:07:00.952990 [info ] [MainThread]:   sslmode: None
[0m16:07:00.954005 [info ] [MainThread]:   sslcert: None
[0m16:07:00.954005 [info ] [MainThread]:   sslkey: None
[0m16:07:00.955011 [info ] [MainThread]:   sslrootcert: None
[0m16:07:00.956012 [info ] [MainThread]:   application_name: dbt
[0m16:07:00.956012 [info ] [MainThread]:   retries: 1
[0m16:07:00.957013 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:07:01.327298 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:07:01.412347 [debug] [MainThread]: Using postgres connection "debug"
[0m16:07:01.413334 [debug] [MainThread]: On debug: select 1 as id
[0m16:07:01.413334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:01.459632 [debug] [MainThread]: SQL status: SELECT 1 in 0.046 seconds
[0m16:07:01.460642 [debug] [MainThread]: On debug: Close
[0m16:07:01.461641 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:07:01.462640 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:07:01.464042 [debug] [MainThread]: Command `dbt debug` succeeded at 16:07:01.464042 after 0.93 seconds
[0m16:07:01.465043 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:07:01.465043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEA835450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAD81150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEAD80A90>]}
[0m16:07:01.466042 [debug] [MainThread]: Flushing usage events
[0m16:07:02.090675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:21.608927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A151A2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A151AEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A151AE810>]}


============================== 16:08:21.612037 | 36d0f744-065e-49d4-bbec-c6d2ee38cb92 ==============================
[0m16:08:21.612037 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:08:21.613578 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt run --select books_price_snapshot.sql', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:08:22.063950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36d0f744-065e-49d4-bbec-c6d2ee38cb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A153D9E10>]}
[0m16:08:22.143321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36d0f744-065e-49d4-bbec-c6d2ee38cb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A0FDFD8D0>]}
[0m16:08:22.144322 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:08:22.575329 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:08:22.860524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:22.861523 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:08:22.861523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:22.930527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36d0f744-065e-49d4-bbec-c6d2ee38cb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1571D910>]}
[0m16:08:23.099963 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:08:23.144448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:08:23.179563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36d0f744-065e-49d4-bbec-c6d2ee38cb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A13058AD0>]}
[0m16:08:23.180573 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m16:08:23.181573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36d0f744-065e-49d4-bbec-c6d2ee38cb92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A15A5C610>]}
[0m16:08:23.184681 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:08:23.187778 [debug] [MainThread]: Command end result
[0m16:08:23.215622 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:08:23.222138 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:08:23.228849 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m16:08:23.230845 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:23.230845 after 1.71 seconds
[0m16:08:23.231846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A0EDE3D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A0EFB5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A0EFB6450>]}
[0m16:08:23.232845 [debug] [MainThread]: Flushing usage events
[0m16:08:23.941665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:49.981041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A4ADFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A4ADDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A4AF150>]}


============================== 16:08:49.985052 | 17655de6-05a9-4a88-8815-f7328aa8f567 ==============================
[0m16:08:49.985052 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:08:49.985052 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt test', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:08:50.239507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17655de6-05a9-4a88-8815-f7328aa8f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A6A4F90>]}
[0m16:08:50.309334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17655de6-05a9-4a88-8815-f7328aa8f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9960EC410>]}
[0m16:08:50.311334 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:08:50.691971 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:08:50.866045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:50.867045 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:08:50.867045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:50.922076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17655de6-05a9-4a88-8815-f7328aa8f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A52B790>]}
[0m16:08:51.069472 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:08:51.072442 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:08:51.144973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17655de6-05a9-4a88-8815-f7328aa8f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D998635F10>]}
[0m16:08:51.145973 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m16:08:51.146973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17655de6-05a9-4a88-8815-f7328aa8f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A5EF310>]}
[0m16:08:51.148973 [info ] [MainThread]: 
[0m16:08:51.149973 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:51.150973 [info ] [MainThread]: 
[0m16:08:51.150973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:08:51.155973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_snapshots'
[0m16:08:51.255900 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m16:08:51.256900 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:08:51.256900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:51.307757 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m16:08:51.309897 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m16:08:51.310771 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m16:08:51.311741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books)
[0m16:08:51.314157 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m16:08:51.314157 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m16:08:51.315157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:51.362277 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.047 seconds
[0m16:08:51.363277 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m16:08:51.364272 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m16:08:51.365252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m16:08:51.367557 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m16:08:51.368552 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m16:08:51.368552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:51.413041 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.044 seconds
[0m16:08:51.415065 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m16:08:51.416065 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m16:08:51.417047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m16:08:51.419040 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m16:08:51.420385 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m16:08:51.420385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:51.466969 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m16:08:51.468994 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m16:08:51.468994 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m16:08:51.475328 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:51.475328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:08:51.476322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:51.568713 [debug] [MainThread]: SQL status: SELECT 8 in 0.092 seconds
[0m16:08:51.570711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17655de6-05a9-4a88-8815-f7328aa8f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A5292D0>]}
[0m16:08:51.571711 [debug] [MainThread]: On master: ROLLBACK
[0m16:08:51.572794 [debug] [MainThread]: On master: COMMIT
[0m16:08:51.573390 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:51.573390 [debug] [MainThread]: On master: COMMIT
[0m16:08:51.574584 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:08:51.574584 [debug] [MainThread]: On master: Close
[0m16:08:51.581018 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m16:08:51.582144 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_books_rating__One__Two__Three__Four__Five  [RUN]
[0m16:08:51.583154 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5'
[0m16:08:51.584155 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m16:08:51.602970 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m16:08:51.603970 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m16:08:51.624672 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m16:08:51.627848 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m16:08:51.627848 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from "web_scraper"."books_books_silver"."stg_books"
    group by rating

)

select *
from all_values
where value_field not in (
    'One','Two','Three','Four','Five'
)



  
  
      
    ) dbt_internal_test
[0m16:08:51.628848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:51.680399 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.051 seconds
[0m16:08:51.684455 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: ROLLBACK
[0m16:08:51.685437 [debug] [Thread-1 (]: On test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5: Close
[0m16:08:51.685437 [info ] [Thread-1 (]: 1 of 12 PASS accepted_values_stg_books_rating__One__Two__Three__Four__Five ..... [[32mPASS[0m in 0.10s]
[0m16:08:51.686910 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m16:08:51.687910 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m16:08:51.688909 [info ] [Thread-1 (]: 2 of 12 START test not_null_books_price_snapshot_dbt_valid_from ................ [RUN]
[0m16:08:51.688909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa)
[0m16:08:51.691046 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m16:08:51.698082 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m16:08:51.699082 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m16:08:51.701597 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m16:08:51.702597 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m16:08:51.703927 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "web_scraper"."snapshots"."books_price_snapshot"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m16:08:51.704926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:51.755009 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.050 seconds
[0m16:08:51.757387 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa: ROLLBACK
[0m16:08:51.758365 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa: Close
[0m16:08:51.759379 [info ] [Thread-1 (]: 2 of 12 PASS not_null_books_price_snapshot_dbt_valid_from ...................... [[32mPASS[0m in 0.07s]
[0m16:08:51.760355 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m16:08:51.761353 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m16:08:51.761353 [info ] [Thread-1 (]: 3 of 12 START test not_null_books_price_snapshot_id ............................ [RUN]
[0m16:08:51.762354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa, now test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf)
[0m16:08:51.763354 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m16:08:51.767387 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m16:08:51.768369 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m16:08:51.770875 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m16:08:51.773182 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m16:08:51.773182 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."snapshots"."books_price_snapshot"
where id is null



  
  
      
    ) dbt_internal_test
[0m16:08:51.773182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:51.824551 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.051 seconds
[0m16:08:51.826555 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf: ROLLBACK
[0m16:08:51.827551 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf: Close
[0m16:08:51.828565 [info ] [Thread-1 (]: 3 of 12 PASS not_null_books_price_snapshot_id .................................. [[32mPASS[0m in 0.07s]
[0m16:08:51.830547 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m16:08:51.870804 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m16:08:51.871804 [info ] [Thread-1 (]: 4 of 12 START test not_null_books_price_snapshot_price ......................... [RUN]
[0m16:08:51.872804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf, now test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7)
[0m16:08:51.873809 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m16:08:51.878135 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m16:08:51.880121 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m16:08:51.882271 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m16:08:51.883312 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m16:08:51.884621 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "web_scraper"."snapshots"."books_price_snapshot"
where price is null



  
  
      
    ) dbt_internal_test
[0m16:08:51.884621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:51.935039 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.050 seconds
[0m16:08:51.936028 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7: ROLLBACK
[0m16:08:51.937407 [debug] [Thread-1 (]: On test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7: Close
[0m16:08:51.938454 [error] [Thread-1 (]: 4 of 12 FAIL 2 not_null_books_price_snapshot_price ............................. [[31mFAIL 2[0m in 0.07s]
[0m16:08:51.939502 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m16:08:51.940520 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m16:08:51.941501 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_books_available_quantity ....................... [RUN]
[0m16:08:51.941501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7, now test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1)
[0m16:08:51.942646 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m16:08:51.946695 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m16:08:51.948665 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m16:08:51.950880 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m16:08:51.951887 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m16:08:51.951887 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select available_quantity
from "web_scraper"."books_books_silver"."stg_books"
where available_quantity is null



  
  
      
    ) dbt_internal_test
[0m16:08:51.953351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:52.118318 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.165 seconds
[0m16:08:52.121318 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1: ROLLBACK
[0m16:08:52.122317 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1: Close
[0m16:08:52.124321 [error] [Thread-1 (]: 5 of 12 FAIL 38 not_null_stg_books_available_quantity .......................... [[31mFAIL 38[0m in 0.18s]
[0m16:08:52.125349 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m16:08:52.126348 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m16:08:52.128349 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_books_book_id .................................. [RUN]
[0m16:08:52.130444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m16:08:52.131443 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m16:08:52.139626 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m16:08:52.141625 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m16:08:52.146624 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m16:08:52.149625 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m16:08:52.150625 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select book_id
from "web_scraper"."books_books_silver"."stg_books"
where book_id is null



  
  
      
    ) dbt_internal_test
[0m16:08:52.151625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:52.221581 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.070 seconds
[0m16:08:52.224074 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: ROLLBACK
[0m16:08:52.224074 [debug] [Thread-1 (]: On test.dbt_train.not_null_stg_books_book_id.7e166e33a6: Close
[0m16:08:52.225123 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_books_book_id ........................................ [[32mPASS[0m in 0.09s]
[0m16:08:52.227624 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m16:08:52.228626 [debug] [Thread-1 (]: Began running node test.dbt_train.price_should_be_positive
[0m16:08:52.229626 [info ] [Thread-1 (]: 7 of 12 START test price_should_be_positive .................................... [RUN]
[0m16:08:52.230625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.price_should_be_positive)
[0m16:08:52.231624 [debug] [Thread-1 (]: Began compiling node test.dbt_train.price_should_be_positive
[0m16:08:52.237657 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.price_should_be_positive"
[0m16:08:52.239964 [debug] [Thread-1 (]: Began executing node test.dbt_train.price_should_be_positive
[0m16:08:52.243482 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.price_should_be_positive"
[0m16:08:52.245841 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.price_should_be_positive"
[0m16:08:52.247143 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.price_should_be_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "web_scraper"."books_books_silver"."stg_books"
where price <= 0
  
  
      
    ) dbt_internal_test
[0m16:08:52.247143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:52.319941 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.072 seconds
[0m16:08:52.321932 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: ROLLBACK
[0m16:08:52.322981 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: Close
[0m16:08:52.325003 [info ] [Thread-1 (]: 7 of 12 PASS price_should_be_positive .......................................... [[32mPASS[0m in 0.09s]
[0m16:08:52.326004 [debug] [Thread-1 (]: Finished running node test.dbt_train.price_should_be_positive
[0m16:08:52.327003 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m16:08:52.328005 [info ] [Thread-1 (]: 8 of 12 START test source_not_null_public_books_category ....................... [RUN]
[0m16:08:52.329005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.price_should_be_positive, now test.dbt_train.source_not_null_public_books_category.6ec115d14f)
[0m16:08:52.330209 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m16:08:52.336225 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m16:08:52.337226 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m16:08:52.341222 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m16:08:52.343225 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m16:08:52.343225 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_category.6ec115d14f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_not_null_public_books_category.6ec115d14f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category
from "web_scraper"."public"."books"
where category is null



  
  
      
    ) dbt_internal_test
[0m16:08:52.344219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:52.411660 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.067 seconds
[0m16:08:52.413658 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_category.6ec115d14f: ROLLBACK
[0m16:08:52.414660 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_category.6ec115d14f: Close
[0m16:08:52.416654 [error] [Thread-1 (]: 8 of 12 FAIL 16 source_not_null_public_books_category .......................... [[31mFAIL 16[0m in 0.09s]
[0m16:08:52.418660 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m16:08:52.418660 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m16:08:52.419698 [info ] [Thread-1 (]: 9 of 12 START test source_not_null_public_books_id ............................. [RUN]
[0m16:08:52.421695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_category.6ec115d14f, now test.dbt_train.source_not_null_public_books_id.39867b96d1)
[0m16:08:52.422693 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m16:08:52.427985 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m16:08:52.430029 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m16:08:52.434450 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m16:08:52.435451 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m16:08:52.436452 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_id.39867b96d1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_not_null_public_books_id.39867b96d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "web_scraper"."public"."books"
where id is null



  
  
      
    ) dbt_internal_test
[0m16:08:52.437455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:52.507164 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.070 seconds
[0m16:08:52.509541 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_id.39867b96d1: ROLLBACK
[0m16:08:52.510560 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_id.39867b96d1: Close
[0m16:08:52.512586 [info ] [Thread-1 (]: 9 of 12 PASS source_not_null_public_books_id ................................... [[32mPASS[0m in 0.09s]
[0m16:08:52.513586 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m16:08:52.514585 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m16:08:52.515588 [info ] [Thread-1 (]: 10 of 12 START test source_not_null_public_books_price ......................... [RUN]
[0m16:08:52.516585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_id.39867b96d1, now test.dbt_train.source_not_null_public_books_price.9e3bad0890)
[0m16:08:52.517586 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m16:08:52.522589 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m16:08:52.524585 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m16:08:52.527587 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m16:08:52.528588 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m16:08:52.529585 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_price.9e3bad0890: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_not_null_public_books_price.9e3bad0890"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "web_scraper"."public"."books"
where price is null



  
  
      
    ) dbt_internal_test
[0m16:08:52.530585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:52.594964 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.064 seconds
[0m16:08:52.597349 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_price.9e3bad0890: ROLLBACK
[0m16:08:52.598342 [debug] [Thread-1 (]: On test.dbt_train.source_not_null_public_books_price.9e3bad0890: Close
[0m16:08:52.599826 [error] [Thread-1 (]: 10 of 12 FAIL 2 source_not_null_public_books_price ............................. [[31mFAIL 2[0m in 0.08s]
[0m16:08:52.601345 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m16:08:52.601345 [debug] [Thread-1 (]: Began running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m16:08:52.602620 [info ] [Thread-1 (]: 11 of 12 START test source_unique_public_books_id .............................. [RUN]
[0m16:08:52.604703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_price.9e3bad0890, now test.dbt_train.source_unique_public_books_id.dbdeae80c5)
[0m16:08:52.605704 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m16:08:52.614400 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m16:08:52.615407 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m16:08:52.621634 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m16:08:52.623633 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m16:08:52.624877 [debug] [Thread-1 (]: On test.dbt_train.source_unique_public_books_id.dbdeae80c5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.source_unique_public_books_id.dbdeae80c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "web_scraper"."public"."books"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:08:52.624877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:52.686188 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.061 seconds
[0m16:08:52.689667 [debug] [Thread-1 (]: On test.dbt_train.source_unique_public_books_id.dbdeae80c5: ROLLBACK
[0m16:08:52.690665 [debug] [Thread-1 (]: On test.dbt_train.source_unique_public_books_id.dbdeae80c5: Close
[0m16:08:52.690665 [info ] [Thread-1 (]: 11 of 12 PASS source_unique_public_books_id .................................... [[32mPASS[0m in 0.09s]
[0m16:08:52.693022 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m16:08:52.694024 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m16:08:52.695155 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_books_book_id ................................... [RUN]
[0m16:08:52.695662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_unique_public_books_id.dbdeae80c5, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m16:08:52.696671 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m16:08:52.702546 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m16:08:52.703574 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m16:08:52.707041 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m16:08:52.709458 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m16:08:52.710458 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.unique_stg_books_book_id.ca28902f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    book_id as unique_field,
    count(*) as n_records

from "web_scraper"."books_books_silver"."stg_books"
where book_id is not null
group by book_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:08:52.711456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:52.775517 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.064 seconds
[0m16:08:52.777484 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: ROLLBACK
[0m16:08:52.778484 [debug] [Thread-1 (]: On test.dbt_train.unique_stg_books_book_id.ca28902f83: Close
[0m16:08:52.779484 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_books_book_id ......................................... [[32mPASS[0m in 0.08s]
[0m16:08:52.781808 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m16:08:52.823694 [debug] [MainThread]: On master: COMMIT
[0m16:08:52.824680 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:52.824680 [debug] [MainThread]: On master: COMMIT
[0m16:08:52.825683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:52.883690 [debug] [MainThread]: SQL status: COMMIT in 0.058 seconds
[0m16:08:52.884688 [debug] [MainThread]: On master: Close
[0m16:08:52.885687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:52.886699 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m16:08:52.886699 [debug] [MainThread]: Connection 'test.dbt_train.unique_stg_books_book_id.ca28902f83' was properly closed.
[0m16:08:52.888011 [info ] [MainThread]: 
[0m16:08:52.889233 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m16:08:52.892470 [debug] [MainThread]: Command end result
[0m16:08:52.921993 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:08:52.926023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:08:52.935398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m16:08:52.936984 [info ] [MainThread]: 
[0m16:08:52.938508 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m16:08:52.938508 [info ] [MainThread]: 
[0m16:08:52.940043 [error] [MainThread]: [31mFailure in test not_null_books_price_snapshot_price (snapshots\books_price_snapshot.yml)[0m
[0m16:08:52.941690 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m16:08:52.941690 [info ] [MainThread]: 
[0m16:08:52.943241 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\snapshots\books_price_snapshot.yml\not_null_books_price_snapshot_price.sql
[0m16:08:52.943241 [info ] [MainThread]: 
[0m16:08:52.944777 [error] [MainThread]: [31mFailure in test not_null_stg_books_available_quantity (models\staging\stg_books.yml)[0m
[0m16:08:52.945823 [error] [MainThread]:   Got 38 results, configured to fail if != 0
[0m16:08:52.947292 [info ] [MainThread]: 
[0m16:08:52.948386 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\staging\stg_books.yml\not_null_stg_books_available_quantity.sql
[0m16:08:52.948386 [info ] [MainThread]: 
[0m16:08:52.949561 [error] [MainThread]: [31mFailure in test source_not_null_public_books_category (models\sources\books_sources.yml)[0m
[0m16:08:52.951003 [error] [MainThread]:   Got 16 results, configured to fail if != 0
[0m16:08:52.952284 [info ] [MainThread]: 
[0m16:08:52.952284 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\sources\books_sources.yml\source_not_null_public_books_category.sql
[0m16:08:52.953284 [info ] [MainThread]: 
[0m16:08:52.954285 [error] [MainThread]: [31mFailure in test source_not_null_public_books_price (models\sources\books_sources.yml)[0m
[0m16:08:52.955557 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m16:08:52.956558 [info ] [MainThread]: 
[0m16:08:52.957872 [info ] [MainThread]:   compiled code at target\compiled\dbt_train\models\sources\books_sources.yml\source_not_null_public_books_price.sql
[0m16:08:52.958871 [info ] [MainThread]: 
[0m16:08:52.959870 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=12
[0m16:08:52.961929 [debug] [MainThread]: Command `dbt test` failed at 16:08:52.961929 after 3.07 seconds
[0m16:08:52.963300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D994068310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9940682D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A4A2BD0>]}
[0m16:08:52.964335 [debug] [MainThread]: Flushing usage events
[0m16:08:53.625192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:29.351329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B49AFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B49AE450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B49AFA10>]}


============================== 16:10:29.355495 | f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7 ==============================
[0m16:10:29.355495 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:10:29.356504 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt run', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:10:29.630706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B4A34310>]}
[0m16:10:29.699009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B05ED7D0>]}
[0m16:10:29.701014 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:10:30.087638 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:10:30.253619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:30.254594 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:10:30.255615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:30.310072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B4EF5690>]}
[0m16:10:30.454901 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:10:30.457901 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:10:30.481321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B61F5350>]}
[0m16:10:30.481321 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m16:10:30.482728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B6281990>]}
[0m16:10:30.484733 [info ] [MainThread]: 
[0m16:10:30.485740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:30.485740 [info ] [MainThread]: 
[0m16:10:30.486770 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:30.490984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m16:10:30.589769 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m16:10:30.589769 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m16:10:30.590765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:30.641328 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.050 seconds
[0m16:10:30.642375 [debug] [ThreadPool]: On list_web_scraper: Close
[0m16:10:30.645499 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m16:10:30.646016 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m16:10:30.646545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:30.690389 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.044 seconds
[0m16:10:30.692299 [debug] [ThreadPool]: On list_web_scraper: Close
[0m16:10:30.694695 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m16:10:30.694695 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m16:10:30.695823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:30.737297 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.041 seconds
[0m16:10:30.738705 [debug] [ThreadPool]: On list_web_scraper: Close
[0m16:10:30.740705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_snapshots'
[0m16:10:30.747123 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m16:10:30.747123 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:10:30.748124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:30.795788 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.049 seconds
[0m16:10:30.798180 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m16:10:30.798180 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m16:10:30.799180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m16:10:30.801419 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m16:10:30.801419 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m16:10:30.802815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:30.848608 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m16:10:30.850612 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m16:10:30.851611 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m16:10:30.851611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m16:10:30.854609 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m16:10:30.854609 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m16:10:30.855618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:30.901434 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.046 seconds
[0m16:10:30.902429 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m16:10:30.903414 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m16:10:30.904544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books)
[0m16:10:30.907266 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m16:10:30.908267 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m16:10:30.908267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:30.957006 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.049 seconds
[0m16:10:30.958571 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m16:10:30.960180 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m16:10:30.964777 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:30.964777 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:10:30.966296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:31.012393 [debug] [MainThread]: SQL status: SELECT 8 in 0.046 seconds
[0m16:10:31.014402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B6596750>]}
[0m16:10:31.015401 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:31.016401 [debug] [MainThread]: On master: COMMIT
[0m16:10:31.016401 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:31.016401 [debug] [MainThread]: On master: COMMIT
[0m16:10:31.017402 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:31.017402 [debug] [MainThread]: On master: Close
[0m16:10:31.022841 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m16:10:31.023843 [info ] [Thread-1 (]: 1 of 6 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m16:10:31.023843 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.dim_books_price_history'
[0m16:10:31.024841 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m16:10:31.030839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m16:10:31.032841 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m16:10:31.062909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m16:10:31.063906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m16:10:31.063906 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m16:10:31.065386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:31.153494 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.088 seconds
[0m16:10:31.159492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m16:10:31.159492 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m16:10:31.161906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:10:31.165122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m16:10:31.165122 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m16:10:31.166102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:31.179330 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m16:10:31.180347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m16:10:31.180347 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m16:10:31.182790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:31.187777 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m16:10:31.193070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m16:10:31.193070 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m16:10:31.197338 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:10:31.198339 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m16:10:31.201852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B42D73D0>]}
[0m16:10:31.202853 [info ] [Thread-1 (]: 1 of 6 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.18s]
[0m16:10:31.203851 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m16:10:31.203851 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m16:10:31.205263 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m16:10:31.205263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m16:10:31.206263 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m16:10:31.209461 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m16:10:31.210460 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m16:10:31.228281 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m16:10:31.230283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m16:10:31.230283 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:10:31.231281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:31.323701 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.092 seconds
[0m16:10:31.329733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m16:10:31.330707 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:10:31.331708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:31.335789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m16:10:31.335789 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:10:31.337762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:31.340780 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m16:10:31.340780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m16:10:31.340780 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m16:10:31.342220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:31.345481 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m16:10:31.347458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m16:10:31.348481 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m16:10:31.354046 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m16:10:31.356079 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m16:10:31.357064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B2A648D0>]}
[0m16:10:31.357064 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.15s]
[0m16:10:31.358057 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m16:10:31.359423 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m16:10:31.359423 [info ] [Thread-1 (]: 3 of 6 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m16:10:31.360521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m16:10:31.360521 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m16:10:31.364100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m16:10:31.365137 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m16:10:31.370806 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m16:10:31.371801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m16:10:31.373004 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m16:10:31.373004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:31.433365 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m16:10:31.437364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m16:10:31.437364 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m16:10:31.438365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:31.441365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m16:10:31.442367 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m16:10:31.443387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:31.445367 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m16:10:31.445367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m16:10:31.446365 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m16:10:31.486903 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m16:10:31.489929 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m16:10:31.491399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m16:10:31.491399 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m16:10:31.495758 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:10:31.497945 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m16:10:31.498946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B6526E90>]}
[0m16:10:31.498946 [info ] [Thread-1 (]: 3 of 6 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.14s]
[0m16:10:31.500453 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m16:10:31.501947 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m16:10:31.502946 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m16:10:31.503945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m16:10:31.504948 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m16:10:31.509034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m16:10:31.511560 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m16:10:31.515563 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m16:10:31.516561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m16:10:31.517560 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m16:10:31.518561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:31.577123 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.059 seconds
[0m16:10:31.580138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m16:10:31.581138 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:10:31.582138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:31.584138 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m16:10:31.585139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m16:10:31.585139 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m16:10:31.596215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m16:10:31.599255 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m16:10:31.600765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m16:10:31.600765 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m16:10:31.602773 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:10:31.603778 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m16:10:31.604778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B4C0FA50>]}
[0m16:10:31.605772 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.10s]
[0m16:10:31.606773 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m16:10:31.606773 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m16:10:31.607774 [info ] [Thread-1 (]: 5 of 6 START sql view model books_books.dim_books .............................. [RUN]
[0m16:10:31.609167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m16:10:31.610166 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m16:10:31.612166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m16:10:31.613167 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m16:10:31.616588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m16:10:31.618861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m16:10:31.618861 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m16:10:31.619861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:31.678498 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.059 seconds
[0m16:10:31.684907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m16:10:31.684907 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m16:10:31.686927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:31.687913 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m16:10:31.687913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m16:10:31.688914 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m16:10:31.728599 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m16:10:31.732639 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m16:10:31.732639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m16:10:31.733614 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m16:10:31.734611 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:10:31.735740 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m16:10:31.736816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B66CA310>]}
[0m16:10:31.738167 [info ] [Thread-1 (]: 5 of 6 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m16:10:31.739407 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m16:10:31.739407 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m16:10:31.740446 [info ] [Thread-1 (]: 6 of 6 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m16:10:31.741425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m16:10:31.741425 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m16:10:31.745460 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m16:10:31.746475 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m16:10:31.750521 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m16:10:31.751503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m16:10:31.751503 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m16:10:31.752764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:31.812316 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m16:10:31.816675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m16:10:31.817676 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m16:10:31.818695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:31.820711 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m16:10:31.822082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m16:10:31.822082 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m16:10:31.862334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m16:10:31.866384 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m16:10:31.867357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m16:10:31.867357 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m16:10:31.869347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:10:31.870685 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m16:10:31.871722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ac2cae-0d5b-4250-9bb7-ca10ce7619c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B66B7990>]}
[0m16:10:31.872722 [info ] [Thread-1 (]: 6 of 6 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.13s]
[0m16:10:31.873739 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m16:10:31.875701 [debug] [MainThread]: On master: COMMIT
[0m16:10:31.876703 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:31.876703 [debug] [MainThread]: On master: COMMIT
[0m16:10:31.878036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:31.935227 [debug] [MainThread]: SQL status: COMMIT in 0.057 seconds
[0m16:10:31.935227 [debug] [MainThread]: On master: Close
[0m16:10:31.936811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:31.936811 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m16:10:31.938400 [debug] [MainThread]: Connection 'list_web_scraper_books_books' was properly closed.
[0m16:10:31.938400 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m16:10:31.940019 [info ] [MainThread]: 
[0m16:10:31.940019 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m16:10:31.943138 [debug] [MainThread]: Command end result
[0m16:10:31.972749 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:10:31.976750 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:10:31.985012 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m16:10:31.985753 [info ] [MainThread]: 
[0m16:10:31.986799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:31.986799 [info ] [MainThread]: 
[0m16:10:31.987799 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:10:31.989799 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:31.989799 after 2.73 seconds
[0m16:10:31.990799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B4A34110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ABFE8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ABFE8110>]}
[0m16:10:31.991799 [debug] [MainThread]: Flushing usage events
[0m16:10:33.603517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:41.976698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206B29AE310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206B29AE650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206B29AE8D0>]}


============================== 16:10:41.981025 | 967e15a8-d10a-43b8-8919-129df176194f ==============================
[0m16:10:41.981025 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:10:41.981025 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --select books_price_snapshot.sql', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m16:10:42.238775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '967e15a8-d10a-43b8-8919-129df176194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206B2A7E150>]}
[0m16:10:42.313885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '967e15a8-d10a-43b8-8919-129df176194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206AE5ED250>]}
[0m16:10:42.314867 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:10:42.688770 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:10:42.854889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:42.855889 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:10:42.855889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:42.911571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '967e15a8-d10a-43b8-8919-129df176194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206B2F1DB90>]}
[0m16:10:43.059717 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:10:43.061903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:10:43.084456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '967e15a8-d10a-43b8-8919-129df176194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206B236FD90>]}
[0m16:10:43.085471 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m16:10:43.086475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967e15a8-d10a-43b8-8919-129df176194f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206B4294750>]}
[0m16:10:43.087849 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:10:43.090084 [debug] [MainThread]: Command end result
[0m16:10:43.111561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:10:43.114601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:10:43.118072 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m16:10:43.119474 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:43.118072 after 1.23 seconds
[0m16:10:43.119474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206AE3843D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206AE49A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206AC658050>]}
[0m16:10:43.119474 [debug] [MainThread]: Flushing usage events
[0m16:10:43.738230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:10.823554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DF5AC250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DF5AE490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DF5AE250>]}


============================== 16:12:10.828198 | e3408711-17c6-4a8d-b63d-39f20db1aa8d ==============================
[0m16:12:10.828198 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:12:10.828198 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select books_price_snapshot.sql', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:12:11.085609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3408711-17c6-4a8d-b63d-39f20db1aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DF335990>]}
[0m16:12:11.155011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3408711-17c6-4a8d-b63d-39f20db1aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DB2ED250>]}
[0m16:12:11.156006 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:12:11.538158 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:12:11.702748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:11.704023 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:12:11.704023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:11.761550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3408711-17c6-4a8d-b63d-39f20db1aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DFC85F90>]}
[0m16:12:11.908347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:12:11.910362 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:12:11.975001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3408711-17c6-4a8d-b63d-39f20db1aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DD459C90>]}
[0m16:12:11.976511 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m16:12:11.977519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3408711-17c6-4a8d-b63d-39f20db1aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DFE96D50>]}
[0m16:12:11.978950 [info ] [MainThread]: 
[0m16:12:11.979962 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:11.979962 [info ] [MainThread]: 
[0m16:12:11.980962 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:12:11.982412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m16:12:12.081701 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m16:12:12.081701 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m16:12:12.082689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:12.131448 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.049 seconds
[0m16:12:12.132448 [debug] [ThreadPool]: On list_web_scraper: Close
[0m16:12:12.137420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m16:12:12.143086 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m16:12:12.143086 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m16:12:12.144086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:12.190309 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m16:12:12.192060 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m16:12:12.192060 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m16:12:12.193072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m16:12:12.195238 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m16:12:12.196536 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:12:12.196536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:12.247098 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m16:12:12.256577 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m16:12:12.257585 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m16:12:12.257585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books)
[0m16:12:12.259865 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m16:12:12.261019 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m16:12:12.261019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:12.309435 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.048 seconds
[0m16:12:12.311456 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m16:12:12.312444 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m16:12:12.312444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books)
[0m16:12:12.316419 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m16:12:12.316954 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m16:12:12.316954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:12.363714 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.046 seconds
[0m16:12:12.364722 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m16:12:12.365701 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m16:12:12.370123 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:12.371265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:12:12.371265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:12:12.419731 [debug] [MainThread]: SQL status: SELECT 8 in 0.048 seconds
[0m16:12:12.422761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3408711-17c6-4a8d-b63d-39f20db1aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DB56D910>]}
[0m16:12:12.422761 [debug] [MainThread]: On master: ROLLBACK
[0m16:12:12.423963 [debug] [MainThread]: On master: COMMIT
[0m16:12:12.423963 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:12.424761 [debug] [MainThread]: On master: COMMIT
[0m16:12:12.425741 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:12:12.425741 [debug] [MainThread]: On master: Close
[0m16:12:12.429761 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m16:12:12.430761 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m16:12:12.431761 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m16:12:12.431761 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m16:12:12.439761 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m16:12:12.501090 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.502127 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price from (
                



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m16:12:12.503127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:12:12.541773 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.039 seconds
[0m16:12:12.555344 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.555344 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:12:12.572890 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.017 seconds
[0m16:12:12.579890 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.580889 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:12:12.583890 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:12:12.628887 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.629887 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp161212623888"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:12:12.683732 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.053 seconds
[0m16:12:12.687734 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.687734 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp161212623888'
        
      order by ordinal_position

  
[0m16:12:12.691787 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:12:12.695181 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.695181 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:12:12.698468 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:12:12.701598 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.701598 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp161212623888'
        
      order by ordinal_position

  
[0m16:12:12.705578 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:12:12.708603 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.708603 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:12:12.712578 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:12:12.718604 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.719603 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp161212623888'
        
      order by ordinal_position

  
[0m16:12:12.723562 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:12:12.738480 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.740023 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:12:12.740023 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:12:12.744260 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.744260 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:12:12.744260 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:12:12.745778 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.745778 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.747300 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp161212623888" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp161212623888" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:12:12.749829 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m16:12:12.762020 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m16:12:12.762020 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:12:12.763051 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m16:12:12.764682 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:12:12.767697 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m16:12:12.769697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3408711-17c6-4a8d-b63d-39f20db1aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E1258FD0>]}
[0m16:12:12.770697 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 0[0m in 0.34s]
[0m16:12:12.772697 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m16:12:12.773697 [debug] [MainThread]: On master: COMMIT
[0m16:12:12.773697 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:12.775015 [debug] [MainThread]: On master: COMMIT
[0m16:12:12.776014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:12:12.817880 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m16:12:12.818863 [debug] [MainThread]: On master: Close
[0m16:12:12.818863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:12.819863 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m16:12:12.819863 [debug] [MainThread]: Connection 'list_web_scraper_books_books' was properly closed.
[0m16:12:12.820937 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m16:12:12.820937 [info ] [MainThread]: 
[0m16:12:12.821936 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m16:12:12.822940 [debug] [MainThread]: Command end result
[0m16:12:12.845997 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:12:12.847998 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:12:12.854217 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m16:12:12.855555 [info ] [MainThread]: 
[0m16:12:12.855555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:12.856572 [info ] [MainThread]: 
[0m16:12:12.857574 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:12:12.858865 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:12:12.857574 after 2.13 seconds
[0m16:12:12.858865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217DF3352D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D6DE3D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D6DE8050>]}
[0m16:12:12.859882 [debug] [MainThread]: Flushing usage events
[0m16:12:14.038546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:48.900568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278607A2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027860826F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027860826750>]}


============================== 16:15:48.904566 | 1565a027-0b7e-4fc1-adc6-45d15b5ed1f3 ==============================
[0m16:15:48.904566 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:15:48.905577 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot --select books_price_snapshot.sql', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:15:49.169824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1565a027-0b7e-4fc1-adc6-45d15b5ed1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278607A27D0>]}
[0m16:15:49.241272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1565a027-0b7e-4fc1-adc6-45d15b5ed1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278607A2A50>]}
[0m16:15:49.242277 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:15:49.622309 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:15:49.791731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:49.791731 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:15:49.791731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:49.848967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1565a027-0b7e-4fc1-adc6-45d15b5ed1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027860D70110>]}
[0m16:15:49.999293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:15:50.003265 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:15:50.026517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1565a027-0b7e-4fc1-adc6-45d15b5ed1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785E658C10>]}
[0m16:15:50.027512 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m16:15:50.028512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1565a027-0b7e-4fc1-adc6-45d15b5ed1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278620967D0>]}
[0m16:15:50.030534 [info ] [MainThread]: 
[0m16:15:50.030534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:15:50.030534 [info ] [MainThread]: 
[0m16:15:50.032001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:50.033389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m16:15:50.132381 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m16:15:50.133707 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m16:15:50.133707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:50.190430 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.056 seconds
[0m16:15:50.191434 [debug] [ThreadPool]: On list_web_scraper: Close
[0m16:15:50.197023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m16:15:50.204797 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m16:15:50.205321 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m16:15:50.205846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:50.259781 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.053 seconds
[0m16:15:50.260785 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m16:15:50.261785 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m16:15:50.262790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m16:15:50.267059 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m16:15:50.267059 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m16:15:50.268060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:50.316022 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.048 seconds
[0m16:15:50.317024 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m16:15:50.318019 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m16:15:50.319015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books)
[0m16:15:50.321483 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m16:15:50.321483 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m16:15:50.322486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:50.371688 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.049 seconds
[0m16:15:50.373692 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m16:15:50.373692 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m16:15:50.375720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_snapshots)
[0m16:15:50.378738 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m16:15:50.378738 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:15:50.379736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:50.430515 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.051 seconds
[0m16:15:50.431515 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m16:15:50.432650 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m16:15:50.438220 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:50.438220 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:15:50.439226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:50.491681 [debug] [MainThread]: SQL status: SELECT 8 in 0.052 seconds
[0m16:15:50.494044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1565a027-0b7e-4fc1-adc6-45d15b5ed1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027860A24990>]}
[0m16:15:50.494044 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:50.495054 [debug] [MainThread]: On master: COMMIT
[0m16:15:50.496039 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:50.496039 [debug] [MainThread]: On master: COMMIT
[0m16:15:50.497037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:50.498040 [debug] [MainThread]: On master: Close
[0m16:15:50.501593 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m16:15:50.502604 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m16:15:50.502604 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m16:15:50.503603 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m16:15:50.511629 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m16:15:50.559431 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.560419 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price from (
                



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m16:15:50.560419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:15:50.603257 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m16:15:50.616035 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.617078 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:15:50.635520 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.019 seconds
[0m16:15:50.675626 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.676650 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:15:50.682233 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m16:15:50.726462 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.726462 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp161550720434"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:15:50.782251 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.055 seconds
[0m16:15:50.786225 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.786225 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp161550720434'
        
      order by ordinal_position

  
[0m16:15:50.790280 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:15:50.794722 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.794722 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:15:50.798749 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:15:50.801722 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.801722 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp161550720434'
        
      order by ordinal_position

  
[0m16:15:50.805727 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:15:50.809723 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.809723 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:15:50.813729 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:15:50.819719 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.820723 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp161550720434'
        
      order by ordinal_position

  
[0m16:15:50.823720 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m16:15:50.838930 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.838930 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:15:50.840930 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:15:50.843914 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.843914 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:15:50.844932 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:15:50.844932 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.845918 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.846917 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp161550720434" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp161550720434" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:15:50.849623 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.002 seconds
[0m16:15:50.863113 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m16:15:50.863113 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m16:15:50.864126 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m16:15:50.904939 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m16:15:50.907988 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m16:15:50.909987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1565a027-0b7e-4fc1-adc6-45d15b5ed1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002786230C750>]}
[0m16:15:50.910988 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 1[0m in 0.41s]
[0m16:15:50.912001 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m16:15:50.913482 [debug] [MainThread]: On master: COMMIT
[0m16:15:50.913482 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:50.914890 [debug] [MainThread]: On master: COMMIT
[0m16:15:50.914890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:50.959258 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:15:50.960437 [debug] [MainThread]: On master: Close
[0m16:15:50.960437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:50.961437 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m16:15:50.961437 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m16:15:50.962756 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m16:15:50.962756 [info ] [MainThread]: 
[0m16:15:50.963960 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m16:15:50.963960 [debug] [MainThread]: Command end result
[0m16:15:50.985800 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:15:50.988780 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:15:50.994200 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m16:15:50.995256 [info ] [MainThread]: 
[0m16:15:50.996474 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:50.996474 [info ] [MainThread]: 
[0m16:15:50.997509 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:15:50.998903 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:15:50.998903 after 2.19 seconds
[0m16:15:50.998903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A5C6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027857FA8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027857FA8590>]}
[0m16:15:51.000104 [debug] [MainThread]: Flushing usage events
[0m16:15:52.068209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:34.756149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022286DAF510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022286DAF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022286DAF210>]}


============================== 16:54:34.798669 | 548b9d80-6ce3-4742-82ee-50c14c4943bb ==============================
[0m16:54:34.798669 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:54:34.799671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select price_should_be_positive.sql', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:54:35.629360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '548b9d80-6ce3-4742-82ee-50c14c4943bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022286DB73D0>]}
[0m16:54:35.747710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '548b9d80-6ce3-4742-82ee-50c14c4943bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222819FC3D0>]}
[0m16:54:35.761732 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:54:36.564622 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:54:38.844645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:38.845646 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:54:38.845646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:38.928073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '548b9d80-6ce3-4742-82ee-50c14c4943bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228748A0D0>]}
[0m16:54:39.119141 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:54:39.144805 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:54:39.663024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '548b9d80-6ce3-4742-82ee-50c14c4943bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222866DB8D0>]}
[0m16:54:39.663024 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m16:54:39.664023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '548b9d80-6ce3-4742-82ee-50c14c4943bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022286083910>]}
[0m16:54:39.667023 [info ] [MainThread]: 
[0m16:54:39.668021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:39.668021 [info ] [MainThread]: 
[0m16:54:39.669023 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:39.674668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m16:54:44.594696 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m16:54:44.595704 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m16:54:44.596704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:44.663954 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.068 seconds
[0m16:54:44.665345 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m16:54:44.666383 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m16:54:44.668361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_snapshots)
[0m16:54:44.671360 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m16:54:44.672361 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:54:44.672361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:44.733711 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.061 seconds
[0m16:54:44.735713 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m16:54:44.736726 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m16:54:44.737843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books)
[0m16:54:44.741388 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m16:54:44.742442 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m16:54:44.743461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:44.805016 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.061 seconds
[0m16:54:44.807004 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m16:54:44.808009 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m16:54:44.809012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m16:54:44.812830 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m16:54:44.812830 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m16:54:44.813850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:44.872396 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.059 seconds
[0m16:54:44.875362 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m16:54:44.875362 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m16:54:44.883362 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:44.884361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:54:44.885361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:44.966414 [debug] [MainThread]: SQL status: SELECT 8 in 0.081 seconds
[0m16:54:44.969422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '548b9d80-6ce3-4742-82ee-50c14c4943bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022287725810>]}
[0m16:54:44.970398 [debug] [MainThread]: On master: ROLLBACK
[0m16:54:44.970398 [debug] [MainThread]: On master: COMMIT
[0m16:54:44.971816 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:44.972814 [debug] [MainThread]: On master: COMMIT
[0m16:54:44.972814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:54:44.973817 [debug] [MainThread]: On master: Close
[0m16:54:45.062467 [debug] [Thread-1 (]: Began running node test.dbt_train.price_should_be_positive
[0m16:54:45.063467 [info ] [Thread-1 (]: 1 of 1 START test price_should_be_positive ..................................... [RUN]
[0m16:54:45.064476 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.price_should_be_positive'
[0m16:54:45.065831 [debug] [Thread-1 (]: Began compiling node test.dbt_train.price_should_be_positive
[0m16:54:45.074941 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.price_should_be_positive"
[0m16:54:45.076946 [debug] [Thread-1 (]: Began executing node test.dbt_train.price_should_be_positive
[0m16:54:45.102279 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.price_should_be_positive"
[0m16:54:45.103281 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.price_should_be_positive"
[0m16:54:45.104251 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.price_should_be_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "web_scraper"."books_books_silver"."stg_books"
where price <= 0
  
  
      
    ) dbt_internal_test
[0m16:54:45.104251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:45.167974 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.063 seconds
[0m16:54:45.172969 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: ROLLBACK
[0m16:54:45.172969 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: Close
[0m16:54:45.174423 [info ] [Thread-1 (]: 1 of 1 PASS price_should_be_positive ........................................... [[32mPASS[0m in 0.11s]
[0m16:54:45.175704 [debug] [Thread-1 (]: Finished running node test.dbt_train.price_should_be_positive
[0m16:54:45.178261 [debug] [MainThread]: On master: COMMIT
[0m16:54:45.178261 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:45.179258 [debug] [MainThread]: On master: COMMIT
[0m16:54:45.179258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:45.237651 [debug] [MainThread]: SQL status: COMMIT in 0.058 seconds
[0m16:54:45.239021 [debug] [MainThread]: On master: Close
[0m16:54:45.240003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:45.240003 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m16:54:45.241410 [debug] [MainThread]: Connection 'test.dbt_train.price_should_be_positive' was properly closed.
[0m16:54:45.241410 [info ] [MainThread]: 
[0m16:54:45.242407 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m16:54:45.242407 [debug] [MainThread]: Command end result
[0m16:54:45.273921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m16:54:45.278572 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m16:54:45.287680 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m16:54:45.287680 [info ] [MainThread]: 
[0m16:54:45.288744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:45.289797 [info ] [MainThread]: 
[0m16:54:45.290816 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:54:45.292132 [debug] [MainThread]: Command `dbt test` succeeded at 16:54:45.292132 after 10.76 seconds
[0m16:54:45.293132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022286B352D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022286DA21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022286DA3590>]}
[0m16:54:45.294151 [debug] [MainThread]: Flushing usage events
[0m16:54:46.101846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:39.357190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F0AC110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F0A3F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F0A3DD0>]}


============================== 17:07:39.362203 | 693e6272-eeb5-4280-a9d7-b3ec660dc0fa ==============================
[0m17:07:39.362203 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:07:39.363575 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:07:39.681589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2D96AC50>]}
[0m17:07:39.759614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D29CCC050>]}
[0m17:07:39.761614 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:07:40.171349 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:07:40.342542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:40.342542 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:07:40.343523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:40.403221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F602BD0>]}
[0m17:07:40.565808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:07:40.568843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:07:40.595018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2CEB5410>]}
[0m17:07:40.596006 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m17:07:40.596006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F601050>]}
[0m17:07:40.598006 [info ] [MainThread]: 
[0m17:07:40.599192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:40.600203 [info ] [MainThread]: 
[0m17:07:40.601202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:40.606585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m17:07:40.707168 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m17:07:40.707168 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m17:07:40.708146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:40.754976 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.047 seconds
[0m17:07:40.757147 [debug] [ThreadPool]: On list_web_scraper: Close
[0m17:07:40.759571 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m17:07:40.760076 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m17:07:40.760076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:40.803748 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.043 seconds
[0m17:07:40.804750 [debug] [ThreadPool]: On list_web_scraper: Close
[0m17:07:40.807747 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m17:07:40.807747 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m17:07:40.808750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:40.854355 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.046 seconds
[0m17:07:40.856566 [debug] [ThreadPool]: On list_web_scraper: Close
[0m17:07:40.857567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_books)
[0m17:07:40.857567 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books"
"
[0m17:07:40.863141 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books"
[0m17:07:40.863141 [debug] [ThreadPool]: On create_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books"} */
create schema if not exists "books"
[0m17:07:40.864184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:40.912264 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.048 seconds
[0m17:07:40.913276 [debug] [ThreadPool]: On create_web_scraper_books: COMMIT
[0m17:07:40.913276 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books"
[0m17:07:40.914279 [debug] [ThreadPool]: On create_web_scraper_books: COMMIT
[0m17:07:40.953949 [debug] [ThreadPool]: SQL status: COMMIT in 0.039 seconds
[0m17:07:40.954959 [debug] [ThreadPool]: On create_web_scraper_books: Close
[0m17:07:40.956441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m17:07:40.961442 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m17:07:40.962506 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m17:07:40.962506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:41.011080 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m17:07:41.012080 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m17:07:41.013193 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m17:07:41.013193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m17:07:41.015592 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m17:07:41.016591 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m17:07:41.016591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:41.100135 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.084 seconds
[0m17:07:41.102450 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m17:07:41.103451 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m17:07:41.103451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m17:07:41.105766 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m17:07:41.106783 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:07:41.106783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:41.156163 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m17:07:41.178050 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m17:07:41.178050 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m17:07:41.179438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books)
[0m17:07:41.181434 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m17:07:41.182437 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m17:07:41.182942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:41.233576 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.050 seconds
[0m17:07:41.234597 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m17:07:41.235590 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m17:07:41.240889 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:41.241886 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:07:41.241886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:41.292013 [debug] [MainThread]: SQL status: SELECT 4 in 0.049 seconds
[0m17:07:41.294072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D29CCFA50>]}
[0m17:07:41.294072 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:41.295245 [debug] [MainThread]: On master: COMMIT
[0m17:07:41.295245 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:41.295245 [debug] [MainThread]: On master: COMMIT
[0m17:07:41.296456 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:07:41.296456 [debug] [MainThread]: On master: Close
[0m17:07:41.300914 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m17:07:41.301916 [info ] [Thread-1 (]: 1 of 6 START sql view model books_books.dim_books_price_history ................ [RUN]
[0m17:07:41.302914 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.dim_books_price_history'
[0m17:07:41.303912 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m17:07:41.311118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m17:07:41.312117 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m17:07:41.344467 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books_price_history"
[0m17:07:41.346450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m17:07:41.346450 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */

  create view "web_scraper"."books_books"."dim_books_price_history__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    category,
    price,
    price_excl_tax,
    price_incl_tax,
    dbt_valid_from,
    dbt_valid_to
from "web_scraper"."snapshots"."books_price_snapshot"
  );
[0m17:07:41.347529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:07:41.397184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m17:07:41.404643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m17:07:41.404643 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history" rename to "dim_books_price_history__dbt_backup"
[0m17:07:41.405942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:41.409370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m17:07:41.409370 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
alter table "web_scraper"."books_books"."dim_books_price_history__dbt_tmp" rename to "dim_books_price_history"
[0m17:07:41.410401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:41.424738 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m17:07:41.424738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m17:07:41.425723 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: COMMIT
[0m17:07:41.427333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:07:41.433005 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books_price_history__dbt_backup"
[0m17:07:41.437390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books_price_history"
[0m17:07:41.438390 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books_price_history"} */
drop view if exists "web_scraper"."books_books"."dim_books_price_history__dbt_backup" cascade
[0m17:07:41.440709 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:07:41.442784 [debug] [Thread-1 (]: On model.dbt_train.dim_books_price_history: Close
[0m17:07:41.455307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F98FA10>]}
[0m17:07:41.456303 [info ] [Thread-1 (]: 1 of 6 OK created sql view model books_books.dim_books_price_history ........... [[32mCREATE VIEW[0m in 0.14s]
[0m17:07:41.457303 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m17:07:41.457303 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m17:07:41.457303 [info ] [Thread-1 (]: 2 of 6 START sql table model books.my_first_dbt_model .......................... [RUN]
[0m17:07:41.458611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now model.dbt_train.my_first_dbt_model)
[0m17:07:41.459611 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m17:07:41.461706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m17:07:41.463716 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m17:07:41.481936 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_first_dbt_model"
[0m17:07:41.483907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m17:07:41.484907 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */

  
    

  create  table "web_scraper"."books"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:07:41.484907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:41.539165 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.054 seconds
[0m17:07:41.545257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m17:07:41.546253 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
alter table "web_scraper"."books"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:07:41.548275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:41.549660 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m17:07:41.549660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m17:07:41.550696 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: COMMIT
[0m17:07:41.590288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m17:07:41.593276 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_first_dbt_model__dbt_backup"
[0m17:07:41.595598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_first_dbt_model"
[0m17:07:41.597032 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_first_dbt_model"} */
drop table if exists "web_scraper"."books"."my_first_dbt_model__dbt_backup" cascade
[0m17:07:41.599419 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:07:41.600932 [debug] [Thread-1 (]: On model.dbt_train.my_first_dbt_model: Close
[0m17:07:41.600932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2FD20C90>]}
[0m17:07:41.601931 [info ] [Thread-1 (]: 2 of 6 OK created sql table model books.my_first_dbt_model ..................... [[32mSELECT 2[0m in 0.14s]
[0m17:07:41.602933 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m17:07:41.604433 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m17:07:41.604433 [info ] [Thread-1 (]: 3 of 6 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m17:07:41.605819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m17:07:41.606816 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m17:07:41.610261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m17:07:41.611263 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m17:07:41.615262 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m17:07:41.616261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:07:41.617268 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m17:07:41.618262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:41.672365 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m17:07:41.675852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:07:41.676851 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books" rename to "stg_books__dbt_backup"
[0m17:07:41.677851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:41.680851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:07:41.680851 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m17:07:41.682857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:41.683855 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m17:07:41.684853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:07:41.684853 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m17:07:41.725767 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m17:07:41.729006 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m17:07:41.729983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:07:41.729983 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m17:07:41.732151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:07:41.733382 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m17:07:41.734381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2FDAED50>]}
[0m17:07:41.735380 [info ] [Thread-1 (]: 3 of 6 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.13s]
[0m17:07:41.736379 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m17:07:41.737397 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m17:07:41.738399 [info ] [Thread-1 (]: 4 of 6 START sql view model books.my_second_dbt_model .......................... [RUN]
[0m17:07:41.738399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now model.dbt_train.my_second_dbt_model)
[0m17:07:41.738399 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m17:07:41.741860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m17:07:41.742857 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m17:07:41.745894 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.my_second_dbt_model"
[0m17:07:41.746898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m17:07:41.747934 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */

  create view "web_scraper"."books"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "web_scraper"."books"."my_first_dbt_model"
where id = 1
  );
[0m17:07:41.748905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:41.794809 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m17:07:41.799028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m17:07:41.799028 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
alter table "web_scraper"."books"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:07:41.800052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:07:41.802028 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m17:07:41.803027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m17:07:41.803027 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: COMMIT
[0m17:07:41.844461 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m17:07:41.847529 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books"."my_second_dbt_model__dbt_backup"
[0m17:07:41.847529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.my_second_dbt_model"
[0m17:07:41.848530 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.my_second_dbt_model"} */
drop view if exists "web_scraper"."books"."my_second_dbt_model__dbt_backup" cascade
[0m17:07:41.849541 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:07:41.850838 [debug] [Thread-1 (]: On model.dbt_train.my_second_dbt_model: Close
[0m17:07:41.851838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2FDA3E50>]}
[0m17:07:41.852839 [info ] [Thread-1 (]: 4 of 6 OK created sql view model books.my_second_dbt_model ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m17:07:41.854099 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m17:07:41.854099 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m17:07:41.855424 [info ] [Thread-1 (]: 5 of 6 START sql view model books_books.dim_books .............................. [RUN]
[0m17:07:41.856423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m17:07:41.856423 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m17:07:41.859608 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m17:07:41.860608 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m17:07:41.864139 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m17:07:41.865127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m17:07:41.865127 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m17:07:41.866127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:41.920536 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m17:07:41.924904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m17:07:41.925909 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books"."dim_books__dbt_tmp" rename to "dim_books"
[0m17:07:41.926909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:41.928883 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m17:07:41.928883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m17:07:41.928883 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m17:07:41.970799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m17:07:41.973822 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."dim_books__dbt_backup"
[0m17:07:41.974821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m17:07:41.974821 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books"."dim_books__dbt_backup" cascade
[0m17:07:41.975799 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:07:41.976797 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m17:07:41.977826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2FDE7750>]}
[0m17:07:41.978811 [info ] [Thread-1 (]: 5 of 6 OK created sql view model books_books.dim_books ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m17:07:41.979808 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m17:07:41.980809 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m17:07:41.980809 [info ] [Thread-1 (]: 6 of 6 START sql view model books_books.fact_books_inventory ................... [RUN]
[0m17:07:41.982141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now model.dbt_train.fact_books_inventory)
[0m17:07:41.982141 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m17:07:41.985166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m17:07:41.986328 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m17:07:41.989352 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m17:07:41.990530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m17:07:41.991333 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_silver"."stg_books"
group by category
  );
[0m17:07:41.991669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:42.041946 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m17:07:42.045083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m17:07:42.045083 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m17:07:42.047157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:42.048572 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m17:07:42.048572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m17:07:42.049336 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m17:07:42.079246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m17:07:42.082615 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books"."fact_books_inventory__dbt_backup"
[0m17:07:42.083589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m17:07:42.083589 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books"."fact_books_inventory__dbt_backup" cascade
[0m17:07:42.084822 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:07:42.085839 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m17:07:42.086883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693e6272-eeb5-4280-a9d7-b3ec660dc0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2FDE7C10>]}
[0m17:07:42.087865 [info ] [Thread-1 (]: 6 of 6 OK created sql view model books_books.fact_books_inventory .............. [[32mCREATE VIEW[0m in 0.10s]
[0m17:07:42.088920 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m17:07:42.089920 [debug] [MainThread]: On master: COMMIT
[0m17:07:42.089920 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:42.091130 [debug] [MainThread]: On master: COMMIT
[0m17:07:42.091130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:42.138171 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m17:07:42.139163 [debug] [MainThread]: On master: Close
[0m17:07:42.139163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:42.140157 [debug] [MainThread]: Connection 'create_web_scraper_books' was properly closed.
[0m17:07:42.140157 [debug] [MainThread]: Connection 'list_web_scraper_books_books' was properly closed.
[0m17:07:42.141251 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m17:07:42.141251 [info ] [MainThread]: 
[0m17:07:42.141251 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m17:07:42.143717 [debug] [MainThread]: Command end result
[0m17:07:42.166672 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:07:42.171014 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:07:42.177527 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m17:07:42.177527 [info ] [MainThread]: 
[0m17:07:42.178522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:42.178522 [info ] [MainThread]: 
[0m17:07:42.179735 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:07:42.181064 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:42.181064 after 2.96 seconds
[0m17:07:42.181064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F137350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2DEA4090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2DDC5350>]}
[0m17:07:42.182064 [debug] [MainThread]: Flushing usage events
[0m17:07:43.066948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:28.444533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292FCA2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292FCAF390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292FCAED10>]}


============================== 17:08:28.450823 | 11cb0851-0d6f-40bf-9ccf-9bb5109e3c2d ==============================
[0m17:08:28.450823 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:08:28.450823 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt snapshot --select books_price_snapshot.sql', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:08:28.725830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11cb0851-0d6f-40bf-9ccf-9bb5109e3c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292F958290>]}
[0m17:08:28.798883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11cb0851-0d6f-40bf-9ccf-9bb5109e3c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292A8DC610>]}
[0m17:08:28.800881 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:08:29.198934 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:08:29.385805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:29.386804 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:08:29.386804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:29.444968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11cb0851-0d6f-40bf-9ccf-9bb5109e3c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229313B1050>]}
[0m17:08:29.609277 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:08:29.612279 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:08:29.648899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11cb0851-0d6f-40bf-9ccf-9bb5109e3c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292DB58E90>]}
[0m17:08:29.649903 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m17:08:29.650912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11cb0851-0d6f-40bf-9ccf-9bb5109e3c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293136B910>]}
[0m17:08:29.653003 [info ] [MainThread]: 
[0m17:08:29.654006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:29.655004 [info ] [MainThread]: 
[0m17:08:29.655004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:29.656456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m17:08:29.757588 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m17:08:29.758588 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m17:08:29.758588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:29.811268 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.052 seconds
[0m17:08:29.812270 [debug] [ThreadPool]: On list_web_scraper: Close
[0m17:08:29.813270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_snapshots)
[0m17:08:29.814269 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "snapshots"
"
[0m17:08:29.819590 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_snapshots"
[0m17:08:29.819590 [debug] [ThreadPool]: On create_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_snapshots"} */
create schema if not exists "snapshots"
[0m17:08:29.820779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:29.863788 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.044 seconds
[0m17:08:29.865042 [debug] [ThreadPool]: On create_web_scraper_snapshots: COMMIT
[0m17:08:29.866094 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_snapshots"
[0m17:08:29.866094 [debug] [ThreadPool]: On create_web_scraper_snapshots: COMMIT
[0m17:08:29.906604 [debug] [ThreadPool]: SQL status: COMMIT in 0.040 seconds
[0m17:08:29.907795 [debug] [ThreadPool]: On create_web_scraper_snapshots: Close
[0m17:08:29.912317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books'
[0m17:08:29.917747 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books"
[0m17:08:29.919720 [debug] [ThreadPool]: On list_web_scraper_books_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books'
  
[0m17:08:29.919720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:29.967598 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.047 seconds
[0m17:08:29.969924 [debug] [ThreadPool]: On list_web_scraper_books_books: ROLLBACK
[0m17:08:29.969924 [debug] [ThreadPool]: On list_web_scraper_books_books: Close
[0m17:08:29.970980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books, now list_web_scraper_books)
[0m17:08:29.973075 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m17:08:29.974427 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m17:08:29.974427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:30.023913 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.049 seconds
[0m17:08:30.025598 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m17:08:30.025598 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m17:08:30.027118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m17:08:30.028692 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m17:08:30.030166 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:08:30.030166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:30.078297 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.047 seconds
[0m17:08:30.079280 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m17:08:30.080275 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m17:08:30.081297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m17:08:30.082798 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m17:08:30.082798 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m17:08:30.083922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:30.133359 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.049 seconds
[0m17:08:30.134358 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m17:08:30.135357 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m17:08:30.139996 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:30.141013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:08:30.141013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:30.191970 [debug] [MainThread]: SQL status: SELECT 4 in 0.050 seconds
[0m17:08:30.193634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11cb0851-0d6f-40bf-9ccf-9bb5109e3c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292FF0E890>]}
[0m17:08:30.194668 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:30.194668 [debug] [MainThread]: On master: COMMIT
[0m17:08:30.195706 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:30.196721 [debug] [MainThread]: On master: COMMIT
[0m17:08:30.197721 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:08:30.197721 [debug] [MainThread]: On master: Close
[0m17:08:30.204092 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m17:08:30.242307 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m17:08:30.243299 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m17:08:30.243299 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m17:08:30.251688 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m17:08:30.319731 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m17:08:30.320748 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m17:08:30.320748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:30.371899 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.050 seconds
[0m17:08:30.374935 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m17:08:30.374935 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m17:08:30.375921 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:08:30.376910 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m17:08:30.377907 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m17:08:30.377907 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      
  
    

  create  table "web_scraper"."snapshots"."books_price_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

    ) sbq



  );
  
  
[0m17:08:30.490797 [debug] [Thread-1 (]: SQL status: SELECT 1057 in 0.112 seconds
[0m17:08:30.515400 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m17:08:30.516399 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m17:08:30.517409 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m17:08:30.558114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m17:08:30.561162 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m17:08:30.564685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11cb0851-0d6f-40bf-9ccf-9bb5109e3c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292F5D7410>]}
[0m17:08:30.565717 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mSELECT 1057[0m in 0.32s]
[0m17:08:30.566800 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m17:08:30.570256 [debug] [MainThread]: On master: COMMIT
[0m17:08:30.571456 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:30.571456 [debug] [MainThread]: On master: COMMIT
[0m17:08:30.572506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:30.639814 [debug] [MainThread]: SQL status: COMMIT in 0.067 seconds
[0m17:08:30.640812 [debug] [MainThread]: On master: Close
[0m17:08:30.640812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:30.641812 [debug] [MainThread]: Connection 'create_web_scraper_snapshots' was properly closed.
[0m17:08:30.642826 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m17:08:30.643824 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m17:08:30.643824 [info ] [MainThread]: 
[0m17:08:30.644808 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m17:08:30.647250 [debug] [MainThread]: Command end result
[0m17:08:30.679128 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:08:30.683133 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:08:30.692988 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m17:08:30.694014 [info ] [MainThread]: 
[0m17:08:30.695012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:30.696029 [info ] [MainThread]: 
[0m17:08:30.697009 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:08:30.699015 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:08:30.699015 after 2.35 seconds
[0m17:08:30.700015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292FD26F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002292FD27010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229298C3DD0>]}
[0m17:08:30.700015 [debug] [MainThread]: Flushing usage events
[0m17:08:31.397077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:59.966647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC855AECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC855AE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC855AE7D0>]}


============================== 17:20:59.970648 | dc0c750c-b9fd-432a-87c8-43acd92b5a72 ==============================
[0m17:20:59.970648 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:20:59.971648 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:21:00.005776 [info ] [MainThread]: dbt version: 1.11.2
[0m17:21:00.006775 [info ] [MainThread]: python version: 3.11.9
[0m17:21:00.007776 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m17:21:00.007776 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m17:21:00.055777 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m17:21:00.056775 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m17:21:00.057781 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m17:21:00.058789 [info ] [MainThread]: adapter type: postgres
[0m17:21:00.058789 [info ] [MainThread]: adapter version: 1.10.0
[0m17:21:00.166021 [info ] [MainThread]: Configuration:
[0m17:21:00.166021 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:21:00.167024 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:21:00.168021 [info ] [MainThread]: Required dependencies:
[0m17:21:00.169027 [debug] [MainThread]: Executing "git --help"
[0m17:21:00.210592 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:21:00.211590 [debug] [MainThread]: STDERR: "b''"
[0m17:21:00.211590 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:21:00.212590 [info ] [MainThread]: Connection:
[0m17:21:00.213606 [info ] [MainThread]:   host: localhost
[0m17:21:00.214610 [info ] [MainThread]:   port: 5432
[0m17:21:00.214610 [info ] [MainThread]:   user: amgad
[0m17:21:00.215628 [info ] [MainThread]:   database: web_scraper
[0m17:21:00.216626 [info ] [MainThread]:   schema: books
[0m17:21:00.216626 [info ] [MainThread]:   connect_timeout: 10
[0m17:21:00.217630 [info ] [MainThread]:   role: None
[0m17:21:00.217630 [info ] [MainThread]:   search_path: None
[0m17:21:00.218626 [info ] [MainThread]:   keepalives_idle: 0
[0m17:21:00.218626 [info ] [MainThread]:   sslmode: None
[0m17:21:00.219627 [info ] [MainThread]:   sslcert: None
[0m17:21:00.220626 [info ] [MainThread]:   sslkey: None
[0m17:21:00.220626 [info ] [MainThread]:   sslrootcert: None
[0m17:21:00.221630 [info ] [MainThread]:   application_name: dbt
[0m17:21:00.221630 [info ] [MainThread]:   retries: 1
[0m17:21:00.222627 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:21:00.591061 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:21:00.673023 [debug] [MainThread]: Using postgres connection "debug"
[0m17:21:00.674033 [debug] [MainThread]: On debug: select 1 as id
[0m17:21:00.674033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:00.727601 [debug] [MainThread]: SQL status: SELECT 1 in 0.054 seconds
[0m17:21:00.729603 [debug] [MainThread]: On debug: Close
[0m17:21:00.729603 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:21:00.730601 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:21:00.732602 [debug] [MainThread]: Command `dbt debug` succeeded at 17:21:00.732602 after 0.88 seconds
[0m17:21:00.732602 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:21:00.733602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC85646C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC81777750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC85879150>]}
[0m17:21:00.734601 [debug] [MainThread]: Flushing usage events
[0m17:21:01.484978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:41.082614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264A8D39110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264AE1AF610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264AE1AF850>]}


============================== 17:21:41.085911 | aa4d8f29-b10f-430a-b8f1-79ce9907cdfd ==============================
[0m17:21:41.085911 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:21:41.086924 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_books.sql', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:21:41.318891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa4d8f29-b10f-430a-b8f1-79ce9907cdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264AE424FD0>]}
[0m17:21:41.382344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa4d8f29-b10f-430a-b8f1-79ce9907cdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264A8D6D810>]}
[0m17:21:41.383344 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:21:41.729665 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:21:41.827992 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:21:41.829343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa4d8f29-b10f-430a-b8f1-79ce9907cdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264AC281E50>]}
[0m17:21:43.312065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa4d8f29-b10f-430a-b8f1-79ce9907cdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264AED403D0>]}
[0m17:21:43.396075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:21:43.399069 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:21:43.419040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa4d8f29-b10f-430a-b8f1-79ce9907cdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264AEA96690>]}
[0m17:21:43.420364 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m17:21:43.420364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa4d8f29-b10f-430a-b8f1-79ce9907cdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264AEBE6010>]}
[0m17:21:43.422579 [info ] [MainThread]: 
[0m17:21:43.422579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:43.423583 [info ] [MainThread]: 
[0m17:21:43.424580 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:43.425582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m17:21:43.516639 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m17:21:43.516639 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m17:21:43.517651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:43.570233 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.053 seconds
[0m17:21:43.571655 [debug] [ThreadPool]: On list_web_scraper: Close
[0m17:21:43.572655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_books_books_silver)
[0m17:21:43.573658 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books_books_silver"
"
[0m17:21:43.577714 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m17:21:43.578248 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books_books_silver"} */
create schema if not exists "books_books_silver"
[0m17:21:43.578789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:43.618519 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.040 seconds
[0m17:21:43.619617 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m17:21:43.619617 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m17:21:43.620697 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m17:21:43.621750 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m17:21:43.621750 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: Close
[0m17:21:43.625822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_gold'
[0m17:21:43.631525 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m17:21:43.632531 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m17:21:43.632531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:43.678113 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.046 seconds
[0m17:21:43.680123 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m17:21:43.680123 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m17:21:43.681629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_books)
[0m17:21:43.683884 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m17:21:43.683884 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m17:21:43.684886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:43.736076 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.051 seconds
[0m17:21:43.738078 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m17:21:43.738078 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m17:21:43.739585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m17:21:43.741751 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m17:21:43.741751 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m17:21:43.741751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:43.787041 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.044 seconds
[0m17:21:43.788046 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m17:21:43.789041 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m17:21:43.790042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m17:21:43.792540 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m17:21:43.792540 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:21:43.792540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:43.837574 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.044 seconds
[0m17:21:43.838571 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m17:21:43.839573 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m17:21:43.844605 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:43.845612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:21:43.846118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:43.889204 [debug] [MainThread]: SQL status: SELECT 0 in 0.043 seconds
[0m17:21:43.890209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa4d8f29-b10f-430a-b8f1-79ce9907cdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264ACA6CB10>]}
[0m17:21:43.891204 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:43.891204 [debug] [MainThread]: On master: COMMIT
[0m17:21:43.892218 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:43.892218 [debug] [MainThread]: On master: COMMIT
[0m17:21:43.892218 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:21:43.893723 [debug] [MainThread]: On master: Close
[0m17:21:43.897523 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m17:21:43.897523 [info ] [Thread-1 (]: 1 of 1 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m17:21:43.899007 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.stg_books'
[0m17:21:43.900193 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m17:21:43.905191 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m17:21:43.906193 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m17:21:43.931308 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m17:21:43.933307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:21:43.933307 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m17:21:43.934310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:21:43.976687 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m17:21:43.981964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:21:43.982966 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m17:21:43.983963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:43.994625 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m17:21:43.995656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:21:43.996164 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m17:21:43.997415 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:21:44.003941 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m17:21:44.007983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:21:44.007983 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m17:21:44.008983 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:21:44.011984 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m17:21:44.013985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa4d8f29-b10f-430a-b8f1-79ce9907cdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264AEE7C8D0>]}
[0m17:21:44.014983 [info ] [Thread-1 (]: 1 of 1 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.11s]
[0m17:21:44.016090 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m17:21:44.017604 [debug] [MainThread]: On master: COMMIT
[0m17:21:44.017604 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:44.018601 [debug] [MainThread]: On master: COMMIT
[0m17:21:44.018601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:44.057256 [debug] [MainThread]: SQL status: COMMIT in 0.038 seconds
[0m17:21:44.057256 [debug] [MainThread]: On master: Close
[0m17:21:44.058256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:44.058256 [debug] [MainThread]: Connection 'create_web_scraper_books_books_silver' was properly closed.
[0m17:21:44.059259 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m17:21:44.059259 [debug] [MainThread]: Connection 'model.dbt_train.stg_books' was properly closed.
[0m17:21:44.059259 [info ] [MainThread]: 
[0m17:21:44.060322 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m17:21:44.060322 [debug] [MainThread]: Command end result
[0m17:21:44.079574 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:21:44.083043 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:21:44.087692 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m17:21:44.087692 [info ] [MainThread]: 
[0m17:21:44.089051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:44.090050 [info ] [MainThread]: 
[0m17:21:44.090050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:21:44.091065 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:44.091065 after 3.10 seconds
[0m17:21:44.092084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264AE1F6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264ACE657D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264ACE65850>]}
[0m17:21:44.092084 [debug] [MainThread]: Flushing usage events
[0m17:21:44.685662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:23.686069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213ED8AF050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213ED8A2F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213ED8A3F10>]}


============================== 17:45:23.690064 | 114e3dc3-55a2-45d8-be27-84960a44c3d2 ==============================
[0m17:45:23.690064 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:45:23.691178 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:45:23.706840 [info ] [MainThread]: dbt version: 1.11.2
[0m17:45:23.707855 [info ] [MainThread]: python version: 3.11.9
[0m17:45:23.708855 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m17:45:23.708855 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m17:45:23.754993 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m17:45:23.755989 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m17:45:23.755989 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m17:45:23.757990 [info ] [MainThread]: adapter type: postgres
[0m17:45:23.757990 [info ] [MainThread]: adapter version: 1.10.0
[0m17:45:23.856993 [info ] [MainThread]: Configuration:
[0m17:45:23.858004 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:45:23.858993 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:45:23.858993 [info ] [MainThread]: Required dependencies:
[0m17:45:23.860280 [debug] [MainThread]: Executing "git --help"
[0m17:45:23.901954 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:45:23.901954 [debug] [MainThread]: STDERR: "b''"
[0m17:45:23.902956 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:45:23.903953 [info ] [MainThread]: Connection:
[0m17:45:23.903953 [info ] [MainThread]:   host: localhost
[0m17:45:23.905040 [info ] [MainThread]:   port: 5432
[0m17:45:23.905040 [info ] [MainThread]:   user: amgad
[0m17:45:23.906274 [info ] [MainThread]:   database: web_scraper
[0m17:45:23.906274 [info ] [MainThread]:   schema: books
[0m17:45:23.907461 [info ] [MainThread]:   connect_timeout: 10
[0m17:45:23.907461 [info ] [MainThread]:   role: None
[0m17:45:23.908966 [info ] [MainThread]:   search_path: None
[0m17:45:23.908966 [info ] [MainThread]:   keepalives_idle: 0
[0m17:45:23.910092 [info ] [MainThread]:   sslmode: None
[0m17:45:23.910092 [info ] [MainThread]:   sslcert: None
[0m17:45:23.910092 [info ] [MainThread]:   sslkey: None
[0m17:45:23.911296 [info ] [MainThread]:   sslrootcert: None
[0m17:45:23.911296 [info ] [MainThread]:   application_name: dbt
[0m17:45:23.912309 [info ] [MainThread]:   retries: 1
[0m17:45:23.913315 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:45:24.254896 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:45:24.335000 [debug] [MainThread]: Using postgres connection "debug"
[0m17:45:24.335000 [debug] [MainThread]: On debug: select 1 as id
[0m17:45:24.336016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:24.380549 [debug] [MainThread]: SQL status: SELECT 1 in 0.045 seconds
[0m17:45:24.381547 [debug] [MainThread]: On debug: Close
[0m17:45:24.382545 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:45:24.383552 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:45:24.384675 [debug] [MainThread]: Command `dbt debug` succeeded at 17:45:24.384675 after 0.79 seconds
[0m17:45:24.385690 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:45:24.385690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213ED936E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213EBB83790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213ED8F5290>]}
[0m17:45:24.385690 [debug] [MainThread]: Flushing usage events
[0m17:45:25.150619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:01.287631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD0DAC890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD0DAE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD0DAE910>]}


============================== 17:47:01.291081 | 91b22afe-8dc5-4ca9-9f8b-fb78aedc3f22 ==============================
[0m17:47:01.291081 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:47:01.292429 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt run --select stg_books.sql', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:47:01.526529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91b22afe-8dc5-4ca9-9f8b-fb78aedc3f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD0E8C090>]}
[0m17:47:01.590123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91b22afe-8dc5-4ca9-9f8b-fb78aedc3f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCB94DE50>]}
[0m17:47:01.592631 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:47:01.929641 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:47:02.047853 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:47:02.048855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91b22afe-8dc5-4ca9-9f8b-fb78aedc3f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD0E1D810>]}
[0m17:47:03.516540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91b22afe-8dc5-4ca9-9f8b-fb78aedc3f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD196F550>]}
[0m17:47:03.603515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:47:03.606512 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:47:03.628444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91b22afe-8dc5-4ca9-9f8b-fb78aedc3f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD1692DD0>]}
[0m17:47:03.628444 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m17:47:03.629844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b22afe-8dc5-4ca9-9f8b-fb78aedc3f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD17E5210>]}
[0m17:47:03.632365 [info ] [MainThread]: 
[0m17:47:03.633361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:03.633361 [info ] [MainThread]: 
[0m17:47:03.634394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:03.635728 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m17:47:03.724148 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m17:47:03.724148 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m17:47:03.725340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:03.768481 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.044 seconds
[0m17:47:03.770481 [debug] [ThreadPool]: On list_web_scraper: Close
[0m17:47:03.771484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_books_books_silver)
[0m17:47:03.771484 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books_books_silver"
"
[0m17:47:03.776526 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m17:47:03.776526 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books_books_silver"} */
create schema if not exists "books_books_silver"
[0m17:47:03.777526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:03.817980 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.041 seconds
[0m17:47:03.818981 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m17:47:03.819983 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m17:47:03.819983 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m17:47:03.826358 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m17:47:03.827588 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: Close
[0m17:47:03.831587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m17:47:03.835975 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m17:47:03.836975 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m17:47:03.837976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:03.883458 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.046 seconds
[0m17:47:03.885260 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m17:47:03.885260 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m17:47:03.886283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_gold)
[0m17:47:03.888280 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m17:47:03.889282 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m17:47:03.889282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:03.932485 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.043 seconds
[0m17:47:03.934493 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m17:47:03.934493 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m17:47:03.935494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_books_books_silver)
[0m17:47:03.937493 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m17:47:03.937493 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m17:47:03.938569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:03.984455 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.046 seconds
[0m17:47:03.985455 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m17:47:03.985455 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m17:47:03.986635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m17:47:03.988635 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m17:47:03.989641 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:47:03.989641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:04.032189 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.042 seconds
[0m17:47:04.033196 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m17:47:04.034231 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m17:47:04.038712 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:04.038712 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:47:04.039713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:04.085488 [debug] [MainThread]: SQL status: SELECT 0 in 0.045 seconds
[0m17:47:04.085994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b22afe-8dc5-4ca9-9f8b-fb78aedc3f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD1E01950>]}
[0m17:47:04.087005 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:04.088010 [debug] [MainThread]: On master: COMMIT
[0m17:47:04.088010 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:04.089005 [debug] [MainThread]: On master: COMMIT
[0m17:47:04.089005 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:47:04.089005 [debug] [MainThread]: On master: Close
[0m17:47:04.092520 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m17:47:04.093521 [info ] [Thread-1 (]: 1 of 1 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m17:47:04.094527 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.stg_books'
[0m17:47:04.095521 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m17:47:04.101526 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m17:47:04.102519 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m17:47:04.127919 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m17:47:04.129957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:47:04.129957 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m17:47:04.129957 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:04.175602 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m17:47:04.180606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:47:04.181604 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m17:47:04.182602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:47:04.193631 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m17:47:04.194632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:47:04.194632 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m17:47:04.201135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:47:04.207483 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m17:47:04.211484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m17:47:04.212483 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m17:47:04.213482 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:47:04.215483 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m17:47:04.217481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b22afe-8dc5-4ca9-9f8b-fb78aedc3f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD1A9CD10>]}
[0m17:47:04.218479 [info ] [Thread-1 (]: 1 of 1 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:47:04.219811 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m17:47:04.221841 [debug] [MainThread]: On master: COMMIT
[0m17:47:04.221841 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:04.222842 [debug] [MainThread]: On master: COMMIT
[0m17:47:04.222842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:04.262706 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m17:47:04.263734 [debug] [MainThread]: On master: Close
[0m17:47:04.263734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:04.264747 [debug] [MainThread]: Connection 'create_web_scraper_books_books_silver' was properly closed.
[0m17:47:04.264747 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m17:47:04.265744 [debug] [MainThread]: Connection 'model.dbt_train.stg_books' was properly closed.
[0m17:47:04.265744 [info ] [MainThread]: 
[0m17:47:04.266745 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m17:47:04.267762 [debug] [MainThread]: Command end result
[0m17:47:04.285555 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:47:04.288574 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:47:04.293472 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m17:47:04.294510 [info ] [MainThread]: 
[0m17:47:04.295504 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:04.295504 [info ] [MainThread]: 
[0m17:47:04.296515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:47:04.298671 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:04.297567 after 3.10 seconds
[0m17:47:04.298671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD0DF6B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD1DB9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD0DA2350>]}
[0m17:47:04.299709 [debug] [MainThread]: Flushing usage events
[0m17:47:05.024040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:15.875536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F63AF190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F63AD890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F63AEF10>]}


============================== 17:49:15.879996 | 0842427f-be4c-4bad-b9f6-5835ae12a95f ==============================
[0m17:49:15.879996 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:49:15.880993 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select dim_books.sql', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:49:16.118859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0842427f-be4c-4bad-b9f6-5835ae12a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F4584050>]}
[0m17:49:16.183632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0842427f-be4c-4bad-b9f6-5835ae12a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F0F4C3D0>]}
[0m17:49:16.185137 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:49:16.524862 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:49:16.695163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:16.696171 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:49:16.696171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:16.749208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0842427f-be4c-4bad-b9f6-5835ae12a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F6A0A610>]}
[0m17:49:16.839748 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:49:16.842751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:49:16.920736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0842427f-be4c-4bad-b9f6-5835ae12a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F62FD010>]}
[0m17:49:16.920736 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m17:49:16.921732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0842427f-be4c-4bad-b9f6-5835ae12a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F691C090>]}
[0m17:49:16.923733 [info ] [MainThread]: 
[0m17:49:16.923733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:16.925238 [info ] [MainThread]: 
[0m17:49:16.925238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:49:16.926249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m17:49:17.012594 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m17:49:17.013839 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m17:49:17.013839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:17.176962 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.163 seconds
[0m17:49:17.177962 [debug] [ThreadPool]: On list_web_scraper: Close
[0m17:49:17.179008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_books_books_gold)
[0m17:49:17.180022 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books_books_gold"
"
[0m17:49:17.185034 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_gold"
[0m17:49:17.185034 [debug] [ThreadPool]: On create_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books_books_gold"} */
create schema if not exists "books_books_gold"
[0m17:49:17.186030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:17.230305 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.044 seconds
[0m17:49:17.231308 [debug] [ThreadPool]: On create_web_scraper_books_books_gold: COMMIT
[0m17:49:17.231308 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_gold"
[0m17:49:17.232303 [debug] [ThreadPool]: On create_web_scraper_books_books_gold: COMMIT
[0m17:49:17.235104 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m17:49:17.235104 [debug] [ThreadPool]: On create_web_scraper_books_books_gold: Close
[0m17:49:17.240430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_gold'
[0m17:49:17.246227 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m17:49:17.247228 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m17:49:17.247228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:17.296256 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.049 seconds
[0m17:49:17.298256 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m17:49:17.299256 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m17:49:17.299256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_snapshots)
[0m17:49:17.301260 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m17:49:17.302257 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:49:17.302257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:17.351057 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m17:49:17.352060 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m17:49:17.353057 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m17:49:17.353057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m17:49:17.356057 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m17:49:17.356057 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m17:49:17.357058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:17.407289 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.051 seconds
[0m17:49:17.409289 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m17:49:17.409289 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m17:49:17.410295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m17:49:17.415292 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m17:49:17.415292 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m17:49:17.416288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:17.576149 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.160 seconds
[0m17:49:17.578507 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m17:49:17.579509 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m17:49:17.583329 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:17.584374 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:49:17.585381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:17.635946 [debug] [MainThread]: SQL status: SELECT 1 in 0.051 seconds
[0m17:49:17.637995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0842427f-be4c-4bad-b9f6-5835ae12a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F63A3350>]}
[0m17:49:17.638995 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:17.638995 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.639995 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:17.639995 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.640993 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:49:17.641994 [debug] [MainThread]: On master: Close
[0m17:49:17.645267 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m17:49:17.646264 [info ] [Thread-1 (]: 1 of 1 START sql view model books_books_gold.dim_books ......................... [RUN]
[0m17:49:17.647450 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.dim_books'
[0m17:49:17.647450 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m17:49:17.653761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m17:49:17.655270 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m17:49:17.685297 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m17:49:17.687300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m17:49:17.687300 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books_gold"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m17:49:17.688292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:17.732682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m17:49:17.738666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m17:49:17.738666 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books_gold"."dim_books__dbt_tmp" rename to "dim_books"
[0m17:49:17.739668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:49:17.751230 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m17:49:17.751230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m17:49:17.752226 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m17:49:17.753230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:49:17.758306 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_gold"."dim_books__dbt_backup"
[0m17:49:17.762306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m17:49:17.763317 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books_gold"."dim_books__dbt_backup" cascade
[0m17:49:17.764332 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:49:17.766332 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m17:49:17.767332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0842427f-be4c-4bad-b9f6-5835ae12a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F6EB8710>]}
[0m17:49:17.768334 [info ] [Thread-1 (]: 1 of 1 OK created sql view model books_books_gold.dim_books .................... [[32mCREATE VIEW[0m in 0.12s]
[0m17:49:17.769570 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m17:49:17.770717 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.771756 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:17.771756 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.771756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:17.812417 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m17:49:17.812417 [debug] [MainThread]: On master: Close
[0m17:49:17.813459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:17.813459 [debug] [MainThread]: Connection 'create_web_scraper_books_books_gold' was properly closed.
[0m17:49:17.813459 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m17:49:17.814969 [debug] [MainThread]: Connection 'model.dbt_train.dim_books' was properly closed.
[0m17:49:17.814969 [info ] [MainThread]: 
[0m17:49:17.815975 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m17:49:17.816982 [debug] [MainThread]: Command end result
[0m17:49:17.836921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:49:17.840934 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:49:17.846196 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m17:49:17.846196 [info ] [MainThread]: 
[0m17:49:17.847202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:17.848198 [info ] [MainThread]: 
[0m17:49:17.848198 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:49:17.849210 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:17.849210 after 2.06 seconds
[0m17:49:17.850197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F61352D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F61357D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284EFF38650>]}
[0m17:49:17.850197 [debug] [MainThread]: Flushing usage events
[0m17:49:18.598069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:17.210265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF98A2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF9927B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF9926810>]}


============================== 17:50:17.214265 | 2a3c1ccd-7ea2-4d10-ba3d-43507faad79e ==============================
[0m17:50:17.214265 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:50:17.215270 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt run --select fact_books_inventory.sql', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:50:17.451511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a3c1ccd-7ea2-4d10-ba3d-43507faad79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF99275D0>]}
[0m17:50:17.517641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a3c1ccd-7ea2-4d10-ba3d-43507faad79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF54EDB90>]}
[0m17:50:17.518641 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:50:17.862914 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:50:18.017876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:18.018876 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:50:18.018876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:18.071069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3c1ccd-7ea2-4d10-ba3d-43507faad79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF9A31950>]}
[0m17:50:18.161028 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:50:18.164233 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:50:18.244990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3c1ccd-7ea2-4d10-ba3d-43507faad79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF99C9B10>]}
[0m17:50:18.246495 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m17:50:18.246495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3c1ccd-7ea2-4d10-ba3d-43507faad79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF9BE1ED0>]}
[0m17:50:18.248504 [info ] [MainThread]: 
[0m17:50:18.249502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:18.250501 [info ] [MainThread]: 
[0m17:50:18.250501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:18.252007 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m17:50:18.340212 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m17:50:18.341209 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m17:50:18.341209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:18.388395 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.046 seconds
[0m17:50:18.389398 [debug] [ThreadPool]: On list_web_scraper: Close
[0m17:50:18.393511 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_gold'
[0m17:50:18.403614 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m17:50:18.404615 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m17:50:18.404615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:18.448714 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.045 seconds
[0m17:50:18.451201 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m17:50:18.451201 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m17:50:18.452202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_books)
[0m17:50:18.454712 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m17:50:18.454712 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m17:50:18.455823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:18.499025 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.043 seconds
[0m17:50:18.501024 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m17:50:18.501024 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m17:50:18.502024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m17:50:18.504213 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m17:50:18.504213 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:50:18.505198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:18.552503 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.047 seconds
[0m17:50:18.553521 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m17:50:18.553521 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m17:50:18.554848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m17:50:18.556849 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m17:50:18.557855 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m17:50:18.557855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:18.605236 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.048 seconds
[0m17:50:18.606741 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m17:50:18.607902 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m17:50:18.613340 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:18.613340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:50:18.614339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:18.660454 [debug] [MainThread]: SQL status: SELECT 2 in 0.046 seconds
[0m17:50:18.662457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3c1ccd-7ea2-4d10-ba3d-43507faad79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF923CB10>]}
[0m17:50:18.663453 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:18.663453 [debug] [MainThread]: On master: COMMIT
[0m17:50:18.664454 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:18.664454 [debug] [MainThread]: On master: COMMIT
[0m17:50:18.665870 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:18.665870 [debug] [MainThread]: On master: Close
[0m17:50:18.669953 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m17:50:18.669953 [info ] [Thread-1 (]: 1 of 1 START sql view model books_books_gold.fact_books_inventory .............. [RUN]
[0m17:50:18.670957 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.fact_books_inventory'
[0m17:50:18.672088 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m17:50:18.678919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m17:50:18.679919 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m17:50:18.705955 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m17:50:18.707528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m17:50:18.707528 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books_gold"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_gold"."dim_books"
group by category
  );
[0m17:50:18.708533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:18.753962 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m17:50:18.759958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m17:50:18.759958 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books_gold"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m17:50:18.760967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:50:18.771968 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m17:50:18.772967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m17:50:18.772967 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m17:50:18.775630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:50:18.781598 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_gold"."fact_books_inventory__dbt_backup"
[0m17:50:18.785606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m17:50:18.786607 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books_gold"."fact_books_inventory__dbt_backup" cascade
[0m17:50:18.787611 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:50:18.790173 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m17:50:18.791183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c1ccd-7ea2-4d10-ba3d-43507faad79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF9A9F910>]}
[0m17:50:18.792183 [info ] [Thread-1 (]: 1 of 1 OK created sql view model books_books_gold.fact_books_inventory ......... [[32mCREATE VIEW[0m in 0.12s]
[0m17:50:18.793182 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m17:50:18.794182 [debug] [MainThread]: On master: COMMIT
[0m17:50:18.795182 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:18.795182 [debug] [MainThread]: On master: COMMIT
[0m17:50:18.795182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:18.836676 [debug] [MainThread]: SQL status: COMMIT in 0.041 seconds
[0m17:50:18.836676 [debug] [MainThread]: On master: Close
[0m17:50:18.837668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:18.837668 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m17:50:18.838666 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m17:50:18.838666 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m17:50:18.839671 [info ] [MainThread]: 
[0m17:50:18.839671 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m17:50:18.840820 [debug] [MainThread]: Command end result
[0m17:50:18.861696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:50:18.863692 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:50:18.869627 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m17:50:18.869627 [info ] [MainThread]: 
[0m17:50:18.870623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:18.871649 [info ] [MainThread]: 
[0m17:50:18.872645 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:50:18.873645 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:18.873645 after 1.75 seconds
[0m17:50:18.874641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF9558210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF36C5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFF36C6450>]}
[0m17:50:18.874641 [debug] [MainThread]: Flushing usage events
[0m17:50:19.621209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:14.666862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D2DA2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D2E27990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D2E26050>]}


============================== 17:52:14.671804 | 2de4f2a1-f668-4ab6-be5d-7217ffa62cde ==============================
[0m17:52:14.671804 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:52:14.672807 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt snapshot --select books_price_snapshot.sql', 'printer_width': '80', 'target_path': 'None'}
[0m17:52:14.911811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2de4f2a1-f668-4ab6-be5d-7217ffa62cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D2E83990>]}
[0m17:52:14.975029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2de4f2a1-f668-4ab6-be5d-7217ffa62cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CD98D950>]}
[0m17:52:14.976032 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:52:15.324498 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:52:15.474062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:52:15.474062 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:52:15.475075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:52:15.526386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2de4f2a1-f668-4ab6-be5d-7217ffa62cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D3485BD0>]}
[0m17:52:15.612824 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:52:15.615214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:52:15.692958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2de4f2a1-f668-4ab6-be5d-7217ffa62cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D2CFD1D0>]}
[0m17:52:15.694260 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m17:52:15.694260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2de4f2a1-f668-4ab6-be5d-7217ffa62cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D3320D90>]}
[0m17:52:15.696706 [info ] [MainThread]: 
[0m17:52:15.698094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:15.698094 [info ] [MainThread]: 
[0m17:52:15.698094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:52:15.700001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m17:52:15.789870 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m17:52:15.790880 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m17:52:15.790880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:15.845571 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.054 seconds
[0m17:52:15.846573 [debug] [ThreadPool]: On list_web_scraper: Close
[0m17:52:15.847573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_snapshots)
[0m17:52:15.847573 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "snapshots"
"
[0m17:52:15.852310 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_snapshots"
[0m17:52:15.853326 [debug] [ThreadPool]: On create_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_snapshots"} */
create schema if not exists "snapshots"
[0m17:52:15.853326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:15.895319 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.041 seconds
[0m17:52:15.896322 [debug] [ThreadPool]: On create_web_scraper_snapshots: COMMIT
[0m17:52:15.896322 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_snapshots"
[0m17:52:15.897322 [debug] [ThreadPool]: On create_web_scraper_snapshots: COMMIT
[0m17:52:15.900850 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m17:52:15.900850 [debug] [ThreadPool]: On create_web_scraper_snapshots: Close
[0m17:52:15.904849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m17:52:15.909900 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m17:52:15.910898 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m17:52:15.911898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:15.957665 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m17:52:15.958668 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m17:52:15.959669 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m17:52:15.959669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books_gold)
[0m17:52:15.963496 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m17:52:15.963496 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m17:52:15.964489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:16.007638 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.043 seconds
[0m17:52:16.008641 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m17:52:16.009643 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m17:52:16.009643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_snapshots)
[0m17:52:16.013037 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m17:52:16.013037 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:52:16.014039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:16.061129 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m17:52:16.062134 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m17:52:16.063459 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m17:52:16.063459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books)
[0m17:52:16.067057 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m17:52:16.067057 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m17:52:16.067057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:16.113914 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.046 seconds
[0m17:52:16.115914 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m17:52:16.115914 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m17:52:16.118913 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:16.120907 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:52:16.120907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:16.168933 [debug] [MainThread]: SQL status: SELECT 3 in 0.048 seconds
[0m17:52:16.170999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2de4f2a1-f668-4ab6-be5d-7217ffa62cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D386A6D0>]}
[0m17:52:16.172011 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:16.172011 [debug] [MainThread]: On master: COMMIT
[0m17:52:16.172011 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:16.173168 [debug] [MainThread]: On master: COMMIT
[0m17:52:16.173168 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:52:16.174168 [debug] [MainThread]: On master: Close
[0m17:52:16.178170 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m17:52:16.178170 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m17:52:16.179675 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m17:52:16.179675 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m17:52:16.186684 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m17:52:16.241914 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m17:52:16.241914 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m17:52:16.242916 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:52:16.281135 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.039 seconds
[0m17:52:16.284569 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m17:52:16.284569 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m17:52:16.285711 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:52:16.286721 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m17:52:16.287724 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m17:52:16.287724 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      
  
    

  create  table "web_scraper"."snapshots"."books_price_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    id,
    title,
    cast(price as numeric(10,2)) as price,
    category
from "web_scraper"."public"."books"

    ) sbq



  );
  
  
[0m17:52:16.302759 [debug] [Thread-1 (]: SQL status: SELECT 1057 in 0.014 seconds
[0m17:52:16.316764 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m17:52:16.317764 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m17:52:16.317764 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m17:52:16.319674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:52:16.320680 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m17:52:16.322694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de4f2a1-f668-4ab6-be5d-7217ffa62cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D38E3690>]}
[0m17:52:16.324200 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mSELECT 1057[0m in 0.14s]
[0m17:52:16.324200 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m17:52:16.325504 [debug] [MainThread]: On master: COMMIT
[0m17:52:16.326642 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:16.326642 [debug] [MainThread]: On master: COMMIT
[0m17:52:16.327651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:16.363834 [debug] [MainThread]: SQL status: COMMIT in 0.037 seconds
[0m17:52:16.364840 [debug] [MainThread]: On master: Close
[0m17:52:16.365841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:16.365841 [debug] [MainThread]: Connection 'create_web_scraper_snapshots' was properly closed.
[0m17:52:16.365841 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m17:52:16.366841 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m17:52:16.366841 [info ] [MainThread]: 
[0m17:52:16.367841 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m17:52:16.368840 [debug] [MainThread]: Command end result
[0m17:52:16.388163 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m17:52:16.390673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m17:52:16.395897 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m17:52:16.395897 [info ] [MainThread]: 
[0m17:52:16.397000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:16.398248 [info ] [MainThread]: 
[0m17:52:16.398248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:52:16.399756 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:52:16.399756 after 1.82 seconds
[0m17:52:16.400768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D2E25150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D2E25D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CCB65D90>]}
[0m17:52:16.400768 [debug] [MainThread]: Flushing usage events
[0m17:52:17.115744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:22:53.240366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F127AD990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F127AE050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F127AF150>]}


============================== 18:22:53.243885 | 78c19748-6623-4779-a55c-38358820d161 ==============================
[0m18:22:53.243885 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:22:53.244886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m18:22:53.264854 [info ] [MainThread]: dbt version: 1.11.2
[0m18:22:53.264854 [info ] [MainThread]: python version: 3.11.9
[0m18:22:53.265903 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m18:22:53.267130 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m18:22:53.317126 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m18:22:53.318143 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m18:22:53.318143 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m18:22:53.320126 [info ] [MainThread]: adapter type: postgres
[0m18:22:53.320126 [info ] [MainThread]: adapter version: 1.10.0
[0m18:22:53.424981 [info ] [MainThread]: Configuration:
[0m18:22:53.425981 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:22:53.427353 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:22:53.428404 [info ] [MainThread]: Required dependencies:
[0m18:22:53.428404 [debug] [MainThread]: Executing "git --help"
[0m18:22:53.472853 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:22:53.473857 [debug] [MainThread]: STDERR: "b''"
[0m18:22:53.473857 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:22:53.474875 [info ] [MainThread]: Connection:
[0m18:22:53.476283 [info ] [MainThread]:   host: localhost
[0m18:22:53.476283 [info ] [MainThread]:   port: 5432
[0m18:22:53.477311 [info ] [MainThread]:   user: amgad
[0m18:22:53.478320 [info ] [MainThread]:   database: web_scraper
[0m18:22:53.479322 [info ] [MainThread]:   schema: books
[0m18:22:53.479322 [info ] [MainThread]:   connect_timeout: 10
[0m18:22:53.479322 [info ] [MainThread]:   role: None
[0m18:22:53.480546 [info ] [MainThread]:   search_path: None
[0m18:22:53.480546 [info ] [MainThread]:   keepalives_idle: 0
[0m18:22:53.480546 [info ] [MainThread]:   sslmode: None
[0m18:22:53.480546 [info ] [MainThread]:   sslcert: None
[0m18:22:53.482389 [info ] [MainThread]:   sslkey: None
[0m18:22:53.482389 [info ] [MainThread]:   sslrootcert: None
[0m18:22:53.483395 [info ] [MainThread]:   application_name: dbt
[0m18:22:53.484440 [info ] [MainThread]:   retries: 1
[0m18:22:53.485433 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:22:53.836935 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:22:53.933463 [debug] [MainThread]: Using postgres connection "debug"
[0m18:22:53.933463 [debug] [MainThread]: On debug: select 1 as id
[0m18:22:53.933463 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:22:53.989688 [debug] [MainThread]: SQL status: SELECT 1 in 0.055 seconds
[0m18:22:53.990689 [debug] [MainThread]: On debug: Close
[0m18:22:53.990689 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:22:53.991691 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:22:53.993196 [debug] [MainThread]: Command `dbt debug` succeeded at 18:22:53.993196 after 0.84 seconds
[0m18:22:53.994282 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:22:53.994282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F128490D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F127F8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1090FB50>]}
[0m18:22:53.994282 [debug] [MainThread]: Flushing usage events
[0m18:22:55.337823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:16.397409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF1EF2E590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF1EF2E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF1EF2FA10>]}


============================== 18:24:16.401488 | 646edee2-108b-4b94-b8b3-817810b96212 ==============================
[0m18:24:16.401488 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:24:16.402489 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_books.sql', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m18:24:16.655178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '646edee2-108b-4b94-b8b3-817810b96212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF20287810>]}
[0m18:24:16.718477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '646edee2-108b-4b94-b8b3-817810b96212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF1ABBC610>]}
[0m18:24:16.720477 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:24:17.061551 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:24:17.216321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:17.217321 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:24:17.217321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:17.268474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '646edee2-108b-4b94-b8b3-817810b96212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF2052B010>]}
[0m18:24:17.359480 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:24:17.362919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:24:17.442829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '646edee2-108b-4b94-b8b3-817810b96212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF2077BE50>]}
[0m18:24:17.442829 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m18:24:17.442829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '646edee2-108b-4b94-b8b3-817810b96212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF202E5550>]}
[0m18:24:17.445492 [info ] [MainThread]: 
[0m18:24:17.446507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:17.447502 [info ] [MainThread]: 
[0m18:24:17.447502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:17.448834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m18:24:17.537149 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m18:24:17.537149 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m18:24:17.537149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:17.587747 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.050 seconds
[0m18:24:17.589222 [debug] [ThreadPool]: On list_web_scraper: Close
[0m18:24:17.590316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_books_books_silver)
[0m18:24:17.590316 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books_books_silver"
"
[0m18:24:17.595454 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m18:24:17.595454 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books_books_silver"} */
create schema if not exists "books_books_silver"
[0m18:24:17.596463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:17.637217 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.041 seconds
[0m18:24:17.638213 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m18:24:17.638213 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m18:24:17.639254 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m18:24:17.644849 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m18:24:17.644849 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: Close
[0m18:24:17.649098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m18:24:17.654095 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m18:24:17.655603 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m18:24:17.655603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:17.706693 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.051 seconds
[0m18:24:17.707727 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m18:24:17.708725 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m18:24:17.708725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books_gold)
[0m18:24:17.710723 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m18:24:17.711723 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m18:24:17.711723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:17.756207 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.045 seconds
[0m18:24:17.757715 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m18:24:17.758722 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m18:24:17.760199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_snapshots)
[0m18:24:17.762198 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m18:24:17.762198 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:24:17.762198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:17.805719 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.043 seconds
[0m18:24:17.807832 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m18:24:17.807832 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m18:24:17.808834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books)
[0m18:24:17.811953 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m18:24:17.811953 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m18:24:17.812954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:17.856935 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.044 seconds
[0m18:24:17.858986 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m18:24:17.858986 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m18:24:17.863072 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:17.864233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:24:17.864233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:17.910597 [debug] [MainThread]: SQL status: SELECT 0 in 0.046 seconds
[0m18:24:17.911598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '646edee2-108b-4b94-b8b3-817810b96212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF1D674A90>]}
[0m18:24:17.912597 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:17.912597 [debug] [MainThread]: On master: COMMIT
[0m18:24:17.913600 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:17.913600 [debug] [MainThread]: On master: COMMIT
[0m18:24:17.913600 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:17.915114 [debug] [MainThread]: On master: Close
[0m18:24:17.918433 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m18:24:17.919434 [info ] [Thread-1 (]: 1 of 1 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m18:24:17.920432 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.stg_books'
[0m18:24:17.921430 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m18:24:17.927358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m18:24:17.928357 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m18:24:17.955409 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m18:24:17.956418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m18:24:17.956418 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
    cast(price as numeric(10,2)) as price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m18:24:17.957923 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:24:18.003350 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m18:24:18.008173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m18:24:18.009187 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m18:24:18.009187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:24:18.021171 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m18:24:18.022171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m18:24:18.022171 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m18:24:18.023938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:24:18.028479 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m18:24:18.032479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m18:24:18.032479 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m18:24:18.033984 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:24:18.036501 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m18:24:18.038501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '646edee2-108b-4b94-b8b3-817810b96212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF20ADDBD0>]}
[0m18:24:18.039501 [info ] [Thread-1 (]: 1 of 1 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:24:18.039501 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m18:24:18.041845 [debug] [MainThread]: On master: COMMIT
[0m18:24:18.041845 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:18.042843 [debug] [MainThread]: On master: COMMIT
[0m18:24:18.042843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:18.084257 [debug] [MainThread]: SQL status: COMMIT in 0.041 seconds
[0m18:24:18.084257 [debug] [MainThread]: On master: Close
[0m18:24:18.085267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:18.085267 [debug] [MainThread]: Connection 'create_web_scraper_books_books_silver' was properly closed.
[0m18:24:18.086278 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m18:24:18.086278 [debug] [MainThread]: Connection 'model.dbt_train.stg_books' was properly closed.
[0m18:24:18.086278 [info ] [MainThread]: 
[0m18:24:18.087277 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m18:24:18.088274 [debug] [MainThread]: Command end result
[0m18:24:18.107573 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:24:18.110587 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:24:18.115605 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m18:24:18.116614 [info ] [MainThread]: 
[0m18:24:18.117612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:18.118614 [info ] [MainThread]: 
[0m18:24:18.118614 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:24:18.120620 [debug] [MainThread]: Command `dbt run` succeeded at 18:24:18.120620 after 1.81 seconds
[0m18:24:18.121621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF1EF763D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF200334D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF1EF22490>]}
[0m18:24:18.121621 [debug] [MainThread]: Flushing usage events
[0m18:24:18.854246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:35.485277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38E4AE510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38E4AEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38E4AE7D0>]}


============================== 18:26:35.489811 | 31d7f152-14c3-4a5d-a550-736630810459 ==============================
[0m18:26:35.489811 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:26:35.490809 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --select stg_bo', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m18:26:35.730092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31d7f152-14c3-4a5d-a550-736630810459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38E562310>]}
[0m18:26:35.797928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31d7f152-14c3-4a5d-a550-736630810459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38A0F0790>]}
[0m18:26:35.798929 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:26:36.155628 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:26:36.305039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:26:36.305039 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:26:36.306038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:26:36.358837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31d7f152-14c3-4a5d-a550-736630810459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38EB0E810>]}
[0m18:26:36.450139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:26:36.453130 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:26:36.535203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31d7f152-14c3-4a5d-a550-736630810459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38EAF4E90>]}
[0m18:26:36.535729 [info ] [MainThread]: Found 6 models, 1 snapshot, 12 data tests, 1 source, 463 macros
[0m18:26:36.536264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31d7f152-14c3-4a5d-a550-736630810459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38E7FEB50>]}
[0m18:26:36.537323 [warn ] [MainThread]: The selection criterion 'stg_bo' does not match any enabled nodes
[0m18:26:36.538982 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:26:36.540585 [debug] [MainThread]: Command end result
[0m18:26:36.559724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:26:36.562401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:26:36.565618 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m18:26:36.566835 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:36.566835 after 1.17 seconds
[0m18:26:36.567378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3880A8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3880A8150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3880A83D0>]}
[0m18:26:36.567894 [debug] [MainThread]: Flushing usage events
[0m18:26:37.930355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:32.649191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD3435450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD372A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD372BCD0>]}


============================== 18:34:32.653808 | 0f6e360f-d4b3-43bd-b2b1-348cff71df2b ==============================
[0m18:34:32.653808 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:34:32.655031 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'printer_width': '80', 'target_path': 'None'}
[0m18:34:32.671578 [info ] [MainThread]: dbt version: 1.11.2
[0m18:34:32.671578 [info ] [MainThread]: python version: 3.11.9
[0m18:34:32.671578 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m18:34:32.673032 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m18:34:32.721563 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m18:34:32.722564 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m18:34:32.723701 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m18:34:32.723701 [info ] [MainThread]: adapter type: postgres
[0m18:34:32.723701 [info ] [MainThread]: adapter version: 1.10.0
[0m18:34:32.832497 [info ] [MainThread]: Configuration:
[0m18:34:32.833512 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:34:32.835033 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:34:32.835033 [info ] [MainThread]: Required dependencies:
[0m18:34:32.836041 [debug] [MainThread]: Executing "git --help"
[0m18:34:32.878480 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:34:32.878480 [debug] [MainThread]: STDERR: "b''"
[0m18:34:32.879478 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:34:32.879478 [info ] [MainThread]: Connection:
[0m18:34:32.880487 [info ] [MainThread]:   host: localhost
[0m18:34:32.880487 [info ] [MainThread]:   port: 5432
[0m18:34:32.881488 [info ] [MainThread]:   user: amgad
[0m18:34:32.882489 [info ] [MainThread]:   database: web_scraper
[0m18:34:32.882489 [info ] [MainThread]:   schema: books
[0m18:34:32.883953 [info ] [MainThread]:   connect_timeout: 10
[0m18:34:32.883953 [info ] [MainThread]:   role: None
[0m18:34:32.883953 [info ] [MainThread]:   search_path: None
[0m18:34:32.885757 [info ] [MainThread]:   keepalives_idle: 0
[0m18:34:32.885757 [info ] [MainThread]:   sslmode: None
[0m18:34:32.886763 [info ] [MainThread]:   sslcert: None
[0m18:34:32.886763 [info ] [MainThread]:   sslkey: None
[0m18:34:32.887763 [info ] [MainThread]:   sslrootcert: None
[0m18:34:32.888761 [info ] [MainThread]:   application_name: dbt
[0m18:34:32.888761 [info ] [MainThread]:   retries: 1
[0m18:34:32.890267 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:34:33.237414 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:34:33.315203 [debug] [MainThread]: Using postgres connection "debug"
[0m18:34:33.316236 [debug] [MainThread]: On debug: select 1 as id
[0m18:34:33.316236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:33.359908 [debug] [MainThread]: SQL status: SELECT 1 in 0.043 seconds
[0m18:34:33.361075 [debug] [MainThread]: On debug: Close
[0m18:34:33.361075 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:34:33.362079 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:34:33.363217 [debug] [MainThread]: Command `dbt debug` succeeded at 18:34:33.363217 after 0.80 seconds
[0m18:34:33.364640 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:34:33.364640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCD4B6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCAE481D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD36F8FD0>]}
[0m18:34:33.364640 [debug] [MainThread]: Flushing usage events
[0m18:34:35.418380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:36:33.022804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F4FAF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F4FAEC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F4FAF210>]}


============================== 18:36:33.026851 | 3c1c9c85-2beb-40da-8e7a-8f0a072b75c7 ==============================
[0m18:36:33.026851 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:36:33.026851 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m18:36:33.043018 [info ] [MainThread]: dbt version: 1.11.2
[0m18:36:33.044160 [info ] [MainThread]: python version: 3.11.9
[0m18:36:33.044160 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m18:36:33.045164 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m18:36:33.090423 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m18:36:33.091930 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m18:36:33.091930 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m18:36:33.093435 [info ] [MainThread]: adapter type: postgres
[0m18:36:33.094441 [info ] [MainThread]: adapter version: 1.10.0
[0m18:36:33.195455 [info ] [MainThread]: Configuration:
[0m18:36:33.196459 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:36:33.196459 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:36:33.197679 [info ] [MainThread]: Required dependencies:
[0m18:36:33.198679 [debug] [MainThread]: Executing "git --help"
[0m18:36:33.238805 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:36:33.240098 [debug] [MainThread]: STDERR: "b''"
[0m18:36:33.240098 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:36:33.241096 [info ] [MainThread]: Connection:
[0m18:36:33.242098 [info ] [MainThread]:   host: localhost
[0m18:36:33.242098 [info ] [MainThread]:   port: 5432
[0m18:36:33.242098 [info ] [MainThread]:   user: amgad
[0m18:36:33.243605 [info ] [MainThread]:   database: web_scraper
[0m18:36:33.244614 [info ] [MainThread]:   schema: books
[0m18:36:33.244614 [info ] [MainThread]:   connect_timeout: 10
[0m18:36:33.245615 [info ] [MainThread]:   role: None
[0m18:36:33.245615 [info ] [MainThread]:   search_path: None
[0m18:36:33.246619 [info ] [MainThread]:   keepalives_idle: 0
[0m18:36:33.246619 [info ] [MainThread]:   sslmode: None
[0m18:36:33.247613 [info ] [MainThread]:   sslcert: None
[0m18:36:33.247613 [info ] [MainThread]:   sslkey: None
[0m18:36:33.248625 [info ] [MainThread]:   sslrootcert: None
[0m18:36:33.248625 [info ] [MainThread]:   application_name: dbt
[0m18:36:33.249618 [info ] [MainThread]:   retries: 1
[0m18:36:33.250613 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:36:33.595414 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:36:33.674594 [debug] [MainThread]: Using postgres connection "debug"
[0m18:36:33.675594 [debug] [MainThread]: On debug: select 1 as id
[0m18:36:33.675594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:33.720724 [debug] [MainThread]: SQL status: SELECT 1 in 0.044 seconds
[0m18:36:33.721728 [debug] [MainThread]: On debug: Close
[0m18:36:33.721728 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:36:33.722737 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:36:33.723727 [debug] [MainThread]: Command `dbt debug` succeeded at 18:36:33.723727 after 0.79 seconds
[0m18:36:33.723727 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:36:33.724725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F4FA1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F6281150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2F6280A90>]}
[0m18:36:33.724725 [debug] [MainThread]: Flushing usage events
[0m18:36:34.449860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:26.745085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF66AAE550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF66AAE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF66AAE310>]}


============================== 18:40:26.748478 | 80848e2e-8c51-487c-b8ca-89ee7c6ca9f6 ==============================
[0m18:40:26.748478 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:40:26.749990 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'printer_width': '80', 'target_path': 'None'}
[0m18:40:26.765846 [info ] [MainThread]: dbt version: 1.11.2
[0m18:40:26.765846 [info ] [MainThread]: python version: 3.11.9
[0m18:40:26.766845 [info ] [MainThread]: python path: C:\Users\amgad\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m18:40:26.766845 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m18:40:26.813880 [info ] [MainThread]: Using profiles dir at C:\Users\amgad\.dbt
[0m18:40:26.814879 [info ] [MainThread]: Using profiles.yml file at C:\Users\amgad\.dbt\profiles.yml
[0m18:40:26.815879 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\dbt_project.yml
[0m18:40:26.816881 [info ] [MainThread]: adapter type: postgres
[0m18:40:26.816881 [info ] [MainThread]: adapter version: 1.10.0
[0m18:40:26.916553 [info ] [MainThread]: Configuration:
[0m18:40:26.916553 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:40:26.917953 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:40:26.918959 [info ] [MainThread]: Required dependencies:
[0m18:40:26.919959 [debug] [MainThread]: Executing "git --help"
[0m18:40:26.957284 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:40:26.957284 [debug] [MainThread]: STDERR: "b''"
[0m18:40:26.959138 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:40:26.960147 [info ] [MainThread]: Connection:
[0m18:40:26.960147 [info ] [MainThread]:   host: localhost
[0m18:40:26.961146 [info ] [MainThread]:   port: 5432
[0m18:40:26.962393 [info ] [MainThread]:   user: amgad
[0m18:40:26.963399 [info ] [MainThread]:   database: web_scraper
[0m18:40:26.963399 [info ] [MainThread]:   schema: books
[0m18:40:26.964395 [info ] [MainThread]:   connect_timeout: 10
[0m18:40:26.964395 [info ] [MainThread]:   role: None
[0m18:40:26.965392 [info ] [MainThread]:   search_path: None
[0m18:40:26.965392 [info ] [MainThread]:   keepalives_idle: 0
[0m18:40:26.965392 [info ] [MainThread]:   sslmode: None
[0m18:40:26.966392 [info ] [MainThread]:   sslcert: None
[0m18:40:26.966392 [info ] [MainThread]:   sslkey: None
[0m18:40:26.967518 [info ] [MainThread]:   sslrootcert: None
[0m18:40:26.968514 [info ] [MainThread]:   application_name: dbt
[0m18:40:26.968514 [info ] [MainThread]:   retries: 1
[0m18:40:26.970019 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:40:27.327921 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:40:27.407940 [debug] [MainThread]: Using postgres connection "debug"
[0m18:40:27.408948 [debug] [MainThread]: On debug: select 1 as id
[0m18:40:27.409956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:27.452849 [debug] [MainThread]: SQL status: SELECT 1 in 0.043 seconds
[0m18:40:27.453976 [debug] [MainThread]: On debug: Close
[0m18:40:27.453976 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:40:27.454978 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:40:27.456080 [debug] [MainThread]: Command `dbt debug` succeeded at 18:40:27.456080 after 0.80 seconds
[0m18:40:27.457081 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:40:27.457081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF66F64E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF60826890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF60658650>]}
[0m18:40:27.458082 [debug] [MainThread]: Flushing usage events
[0m18:40:28.178743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:46.699259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0803A2F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0803AF410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0803AFC10>]}


============================== 18:41:46.704084 | ff6a1c01-0733-4bc2-b314-ca5db76ae229 ==============================
[0m18:41:46.704084 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:41:46.705085 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_books.sql', 'printer_width': '80', 'write_json': 'True'}
[0m18:41:46.938095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff6a1c01-0733-4bc2-b314-ca5db76ae229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0805D1290>]}
[0m18:41:47.002050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff6a1c01-0733-4bc2-b314-ca5db76ae229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0FAFACD90>]}
[0m18:41:47.004061 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:41:47.348849 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:41:47.511951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:41:47.512960 [debug] [MainThread]: Partial parsing: updated file: dbt_train://models\staging\stg_books.sql
[0m18:41:47.512960 [debug] [MainThread]: Partial parsing: updated file: dbt_train://snapshots\books_price_snapshot.sql
[0m18:41:48.186705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff6a1c01-0733-4bc2-b314-ca5db76ae229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08041C590>]}
[0m18:41:48.272154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:41:48.275161 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:41:48.296183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff6a1c01-0733-4bc2-b314-ca5db76ae229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F080F35690>]}
[0m18:41:48.296183 [info ] [MainThread]: Found 6 models, 12 data tests, 1 snapshot, 1 source, 463 macros
[0m18:41:48.297183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff6a1c01-0733-4bc2-b314-ca5db76ae229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0FAEF4950>]}
[0m18:41:48.299262 [info ] [MainThread]: 
[0m18:41:48.299262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:48.300262 [info ] [MainThread]: 
[0m18:41:48.300262 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:48.302267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m18:41:48.390123 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m18:41:48.391121 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m18:41:48.392124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:48.438235 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.046 seconds
[0m18:41:48.439238 [debug] [ThreadPool]: On list_web_scraper: Close
[0m18:41:48.440240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_books_books_silver)
[0m18:41:48.441237 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books_books_silver"
"
[0m18:41:48.445703 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m18:41:48.446741 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books_books_silver"} */
create schema if not exists "books_books_silver"
[0m18:41:48.446741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:48.490414 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.044 seconds
[0m18:41:48.491917 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m18:41:48.492922 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_silver"
[0m18:41:48.492922 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: COMMIT
[0m18:41:48.493922 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m18:41:48.493922 [debug] [ThreadPool]: On create_web_scraper_books_books_silver: Close
[0m18:41:48.498922 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m18:41:48.503922 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m18:41:48.503922 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m18:41:48.504923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:48.549067 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.045 seconds
[0m18:41:48.550572 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m18:41:48.552078 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m18:41:48.552078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books_gold)
[0m18:41:48.554477 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m18:41:48.554477 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m18:41:48.554477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:48.600424 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.045 seconds
[0m18:41:48.600424 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m18:41:48.601940 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m18:41:48.603177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_snapshots)
[0m18:41:48.605174 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m18:41:48.605174 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:41:48.606182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:48.650120 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.044 seconds
[0m18:41:48.651177 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m18:41:48.651177 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m18:41:48.652173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books)
[0m18:41:48.654165 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m18:41:48.655165 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m18:41:48.655165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:48.698728 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.044 seconds
[0m18:41:48.701241 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m18:41:48.702241 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m18:41:48.707237 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:48.707237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:41:48.708236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:48.753049 [debug] [MainThread]: SQL status: SELECT 0 in 0.045 seconds
[0m18:41:48.755049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff6a1c01-0733-4bc2-b314-ca5db76ae229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0823B5790>]}
[0m18:41:48.755049 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:48.756049 [debug] [MainThread]: On master: COMMIT
[0m18:41:48.757049 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:48.757049 [debug] [MainThread]: On master: COMMIT
[0m18:41:48.758049 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:48.759049 [debug] [MainThread]: On master: Close
[0m18:41:48.763070 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m18:41:48.763070 [info ] [Thread-1 (]: 1 of 1 START sql view model books_books_silver.stg_books ....................... [RUN]
[0m18:41:48.764576 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.stg_books'
[0m18:41:48.764576 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m18:41:48.770620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m18:41:48.772125 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m18:41:48.799132 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.stg_books"
[0m18:41:48.800132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m18:41:48.800132 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */

  create view "web_scraper"."books_books_silver"."stg_books__dbt_tmp"
    
    
  as (
    select
    id as book_id,
    title,
     price,
    case
        when rating = '1' then 'One'
        when rating = '2' then 'Two'
        when rating = '3' then 'Three'
        when rating = '4' then 'Four'
        when rating = '5' then 'Five'
        else null
    end as rating,
    category,
    upc,
    price_excl_tax,
    price_incl_tax,
    available_quantity,
    image_url,
    detail_url,
    description
from "web_scraper"."public"."books"
  );
[0m18:41:48.801561 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:48.847177 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m18:41:48.852237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m18:41:48.853237 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
alter table "web_scraper"."books_books_silver"."stg_books__dbt_tmp" rename to "stg_books"
[0m18:41:48.854237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:41:48.864196 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m18:41:48.865204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m18:41:48.866206 [debug] [Thread-1 (]: On model.dbt_train.stg_books: COMMIT
[0m18:41:48.867717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:41:48.873227 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_silver"."stg_books__dbt_backup"
[0m18:41:48.877230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.stg_books"
[0m18:41:48.877230 [debug] [Thread-1 (]: On model.dbt_train.stg_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.stg_books"} */
drop view if exists "web_scraper"."books_books_silver"."stg_books__dbt_backup" cascade
[0m18:41:48.878236 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m18:41:48.880227 [debug] [Thread-1 (]: On model.dbt_train.stg_books: Close
[0m18:41:48.882229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff6a1c01-0733-4bc2-b314-ca5db76ae229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F080DB01D0>]}
[0m18:41:48.883228 [info ] [Thread-1 (]: 1 of 1 OK created sql view model books_books_silver.stg_books .................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:41:48.883228 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m18:41:48.886011 [debug] [MainThread]: On master: COMMIT
[0m18:41:48.886011 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:48.886011 [debug] [MainThread]: On master: COMMIT
[0m18:41:48.887020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:48.923858 [debug] [MainThread]: SQL status: COMMIT in 0.038 seconds
[0m18:41:48.924859 [debug] [MainThread]: On master: Close
[0m18:41:48.925867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:48.925867 [debug] [MainThread]: Connection 'create_web_scraper_books_books_silver' was properly closed.
[0m18:41:48.925867 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m18:41:48.926861 [debug] [MainThread]: Connection 'model.dbt_train.stg_books' was properly closed.
[0m18:41:48.926861 [info ] [MainThread]: 
[0m18:41:48.927860 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m18:41:48.927860 [debug] [MainThread]: Command end result
[0m18:41:48.947571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:41:48.950565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:41:48.955477 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m18:41:48.955477 [info ] [MainThread]: 
[0m18:41:48.956479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:48.956479 [info ] [MainThread]: 
[0m18:41:48.957476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:41:48.958477 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:48.958477 after 2.35 seconds
[0m18:41:48.959477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0801357D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0801354D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0803A2350>]}
[0m18:41:48.959477 [debug] [MainThread]: Flushing usage events
[0m18:41:49.726755 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:42:50.478238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F18AEA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F18A3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F18A3D50>]}


============================== 18:42:50.481238 | 9131aaf6-20ef-4fe5-88c9-ad782fe2c7b3 ==============================
[0m18:42:50.481238 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:42:50.482244 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_books.sql', 'printer_width': '80', 'target_path': 'None'}
[0m18:42:50.713528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9131aaf6-20ef-4fe5-88c9-ad782fe2c7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F1B2BC50>]}
[0m18:42:50.775568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9131aaf6-20ef-4fe5-88c9-ad782fe2c7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED4EDB90>]}
[0m18:42:50.776562 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:42:51.120484 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:42:51.289843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:42:51.290842 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:42:51.290842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:42:51.343766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9131aaf6-20ef-4fe5-88c9-ad782fe2c7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F1F653D0>]}
[0m18:42:51.430008 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:42:51.432013 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:42:51.510951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9131aaf6-20ef-4fe5-88c9-ad782fe2c7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F1F825D0>]}
[0m18:42:51.511956 [info ] [MainThread]: Found 6 models, 12 data tests, 1 snapshot, 1 source, 463 macros
[0m18:42:51.512950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9131aaf6-20ef-4fe5-88c9-ad782fe2c7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F1F67910>]}
[0m18:42:51.514953 [info ] [MainThread]: 
[0m18:42:51.514953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:42:51.515949 [info ] [MainThread]: 
[0m18:42:51.516951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:42:51.517951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m18:42:51.607927 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m18:42:51.608929 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m18:42:51.608929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:51.657140 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.049 seconds
[0m18:42:51.659522 [debug] [ThreadPool]: On list_web_scraper: Close
[0m18:42:51.660521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_books_books_gold)
[0m18:42:51.660521 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "books_books_gold"
"
[0m18:42:51.664543 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_gold"
[0m18:42:51.665543 [debug] [ThreadPool]: On create_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_books_books_gold"} */
create schema if not exists "books_books_gold"
[0m18:42:51.665543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:51.705895 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.040 seconds
[0m18:42:51.706894 [debug] [ThreadPool]: On create_web_scraper_books_books_gold: COMMIT
[0m18:42:51.707895 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_books_books_gold"
[0m18:42:51.708894 [debug] [ThreadPool]: On create_web_scraper_books_books_gold: COMMIT
[0m18:42:51.711422 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m18:42:51.711422 [debug] [ThreadPool]: On create_web_scraper_books_books_gold: Close
[0m18:42:51.715899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m18:42:51.720352 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m18:42:51.721857 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m18:42:51.721857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:51.766784 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.045 seconds
[0m18:42:51.768873 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m18:42:51.768873 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m18:42:51.769866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_gold)
[0m18:42:51.771866 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m18:42:51.771866 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m18:42:51.772870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:51.821141 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m18:42:51.822741 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m18:42:51.822741 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m18:42:51.823751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_books_books_silver)
[0m18:42:51.826758 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m18:42:51.826758 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m18:42:51.826758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:51.868491 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.042 seconds
[0m18:42:51.870970 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m18:42:51.870970 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m18:42:51.870970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m18:42:51.874981 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m18:42:51.875981 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:42:51.875981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:51.921940 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.046 seconds
[0m18:42:51.922953 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m18:42:51.923952 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m18:42:51.928538 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:51.928538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:42:51.929543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:42:51.970874 [debug] [MainThread]: SQL status: SELECT 1 in 0.042 seconds
[0m18:42:51.972995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9131aaf6-20ef-4fe5-88c9-ad782fe2c7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F198C110>]}
[0m18:42:51.972995 [debug] [MainThread]: On master: ROLLBACK
[0m18:42:51.973989 [debug] [MainThread]: On master: COMMIT
[0m18:42:51.973989 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:51.975001 [debug] [MainThread]: On master: COMMIT
[0m18:42:51.975001 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:42:51.976007 [debug] [MainThread]: On master: Close
[0m18:42:51.979000 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m18:42:51.979000 [info ] [Thread-1 (]: 1 of 1 START sql view model books_books_gold.dim_books ......................... [RUN]
[0m18:42:51.980395 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.dim_books'
[0m18:42:51.981907 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m18:42:51.987442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m18:42:51.988439 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m18:42:52.015237 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.dim_books"
[0m18:42:52.016239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m18:42:52.017237 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */

  create view "web_scraper"."books_books_gold"."dim_books__dbt_tmp"
    
    
  as (
    select
    book_id,
    title,
    category,
    rating,
    price,
    price_excl_tax,
    price_incl_tax,
    available_quantity
from "web_scraper"."books_books_silver"."stg_books"
  );
[0m18:42:52.017237 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:42:52.061845 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m18:42:52.067285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m18:42:52.067285 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
alter table "web_scraper"."books_books_gold"."dim_books__dbt_tmp" rename to "dim_books"
[0m18:42:52.068279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:42:52.078229 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m18:42:52.079226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m18:42:52.079226 [debug] [Thread-1 (]: On model.dbt_train.dim_books: COMMIT
[0m18:42:52.082328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:42:52.088274 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_gold"."dim_books__dbt_backup"
[0m18:42:52.092269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.dim_books"
[0m18:42:52.092269 [debug] [Thread-1 (]: On model.dbt_train.dim_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.dim_books"} */
drop view if exists "web_scraper"."books_books_gold"."dim_books__dbt_backup" cascade
[0m18:42:52.093780 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:42:52.095838 [debug] [Thread-1 (]: On model.dbt_train.dim_books: Close
[0m18:42:52.098008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9131aaf6-20ef-4fe5-88c9-ad782fe2c7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED6AC5D0>]}
[0m18:42:52.099005 [info ] [Thread-1 (]: 1 of 1 OK created sql view model books_books_gold.dim_books .................... [[32mCREATE VIEW[0m in 0.12s]
[0m18:42:52.100012 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m18:42:52.101005 [debug] [MainThread]: On master: COMMIT
[0m18:42:52.102009 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:52.103009 [debug] [MainThread]: On master: COMMIT
[0m18:42:52.103009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:42:52.140745 [debug] [MainThread]: SQL status: COMMIT in 0.039 seconds
[0m18:42:52.142253 [debug] [MainThread]: On master: Close
[0m18:42:52.142253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:52.143759 [debug] [MainThread]: Connection 'create_web_scraper_books_books_gold' was properly closed.
[0m18:42:52.143759 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m18:42:52.143759 [debug] [MainThread]: Connection 'model.dbt_train.dim_books' was properly closed.
[0m18:42:52.145119 [info ] [MainThread]: 
[0m18:42:52.145119 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m18:42:52.146135 [debug] [MainThread]: Command end result
[0m18:42:52.165713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:42:52.167718 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:42:52.172889 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m18:42:52.172889 [info ] [MainThread]: 
[0m18:42:52.174226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:42:52.174226 [info ] [MainThread]: 
[0m18:42:52.175241 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:42:52.176420 [debug] [MainThread]: Command `dbt run` succeeded at 18:42:52.176420 after 1.78 seconds
[0m18:42:52.177447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F18F4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F18A2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F18A3090>]}
[0m18:42:52.177447 [debug] [MainThread]: Flushing usage events
[0m18:42:52.902843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:57.355694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2A9AE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2AA25ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2AA25D90>]}


============================== 18:43:57.359727 | 091548e5-48bd-4cbd-b2c0-617af97ec50d ==============================
[0m18:43:57.359727 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:43:57.360730 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_books_inventory.sql', 'printer_width': '80', 'target_path': 'None'}
[0m18:43:57.592437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '091548e5-48bd-4cbd-b2c0-617af97ec50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2A9AE810>]}
[0m18:43:57.655676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '091548e5-48bd-4cbd-b2c0-617af97ec50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2562D8D0>]}
[0m18:43:57.657691 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:43:58.002433 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:43:58.152299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:58.152299 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:43:58.153809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:58.203754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '091548e5-48bd-4cbd-b2c0-617af97ec50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2AF44C50>]}
[0m18:43:58.292453 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:43:58.294455 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:43:58.372076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '091548e5-48bd-4cbd-b2c0-617af97ec50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E258BFB50>]}
[0m18:43:58.373585 [info ] [MainThread]: Found 6 models, 12 data tests, 1 snapshot, 1 source, 463 macros
[0m18:43:58.373585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091548e5-48bd-4cbd-b2c0-617af97ec50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E255BAC10>]}
[0m18:43:58.375814 [info ] [MainThread]: 
[0m18:43:58.375814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:58.377128 [info ] [MainThread]: 
[0m18:43:58.377128 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:58.378572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m18:43:58.466615 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m18:43:58.467617 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m18:43:58.467617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:58.519948 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.052 seconds
[0m18:43:58.520984 [debug] [ThreadPool]: On list_web_scraper: Close
[0m18:43:58.525633 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_gold'
[0m18:43:58.530666 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m18:43:58.531669 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m18:43:58.531669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:58.578288 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m18:43:58.580287 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m18:43:58.581285 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m18:43:58.582327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_books)
[0m18:43:58.583822 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m18:43:58.585326 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m18:43:58.585830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:58.629922 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.044 seconds
[0m18:43:58.630924 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m18:43:58.631930 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m18:43:58.632926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m18:43:58.633926 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m18:43:58.633926 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m18:43:58.633926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:58.681985 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m18:43:58.682984 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m18:43:58.682984 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m18:43:58.683992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m18:43:58.686997 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m18:43:58.688012 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:43:58.688012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:58.739068 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.051 seconds
[0m18:43:58.741066 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m18:43:58.741066 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m18:43:58.747072 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:58.747613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:43:58.747613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:58.794917 [debug] [MainThread]: SQL status: SELECT 2 in 0.047 seconds
[0m18:43:58.796979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091548e5-48bd-4cbd-b2c0-617af97ec50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2AB97D10>]}
[0m18:43:58.796979 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:58.798014 [debug] [MainThread]: On master: COMMIT
[0m18:43:58.798014 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:58.799015 [debug] [MainThread]: On master: COMMIT
[0m18:43:58.800014 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:43:58.800014 [debug] [MainThread]: On master: Close
[0m18:43:58.804095 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m18:43:58.804095 [info ] [Thread-1 (]: 1 of 1 START sql view model books_books_gold.fact_books_inventory .............. [RUN]
[0m18:43:58.805604 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.fact_books_inventory'
[0m18:43:58.805604 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m18:43:58.811635 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m18:43:58.812639 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m18:43:58.838514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_train.fact_books_inventory"
[0m18:43:58.840537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m18:43:58.840537 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */

  create view "web_scraper"."books_books_gold"."fact_books_inventory__dbt_tmp"
    
    
  as (
    select
    category,
    count(book_id) as total_books,
    sum(available_quantity) as total_available_quantity,
    avg(price) as avg_price
from "web_scraper"."books_books_gold"."dim_books"
group by category
  );
[0m18:43:58.840537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:43:58.883710 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m18:43:58.889942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m18:43:58.889942 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
alter table "web_scraper"."books_books_gold"."fact_books_inventory__dbt_tmp" rename to "fact_books_inventory"
[0m18:43:58.891133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:43:58.901759 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m18:43:58.902761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m18:43:58.902761 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: COMMIT
[0m18:43:58.905129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:43:58.909186 [debug] [Thread-1 (]: Applying DROP to: "web_scraper"."books_books_gold"."fact_books_inventory__dbt_backup"
[0m18:43:58.913984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_train.fact_books_inventory"
[0m18:43:58.913984 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "model.dbt_train.fact_books_inventory"} */
drop view if exists "web_scraper"."books_books_gold"."fact_books_inventory__dbt_backup" cascade
[0m18:43:58.915489 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:43:58.917498 [debug] [Thread-1 (]: On model.dbt_train.fact_books_inventory: Close
[0m18:43:58.919498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '091548e5-48bd-4cbd-b2c0-617af97ec50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2C468490>]}
[0m18:43:58.919498 [info ] [Thread-1 (]: 1 of 1 OK created sql view model books_books_gold.fact_books_inventory ......... [[32mCREATE VIEW[0m in 0.11s]
[0m18:43:58.920498 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m18:43:58.922750 [debug] [MainThread]: On master: COMMIT
[0m18:43:58.922750 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:58.922750 [debug] [MainThread]: On master: COMMIT
[0m18:43:58.922750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:58.962351 [debug] [MainThread]: SQL status: COMMIT in 0.039 seconds
[0m18:43:58.963351 [debug] [MainThread]: On master: Close
[0m18:43:58.963351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:58.964821 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m18:43:58.964821 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m18:43:58.965913 [debug] [MainThread]: Connection 'model.dbt_train.fact_books_inventory' was properly closed.
[0m18:43:58.965913 [info ] [MainThread]: 
[0m18:43:58.966913 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m18:43:58.967919 [debug] [MainThread]: Command end result
[0m18:43:58.988439 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:43:58.990439 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:43:58.995960 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m18:43:58.995960 [info ] [MainThread]: 
[0m18:43:58.996960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:58.996960 [info ] [MainThread]: 
[0m18:43:58.996960 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:43:58.998413 [debug] [MainThread]: Command `dbt run` succeeded at 18:43:58.998413 after 1.73 seconds
[0m18:43:58.999512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2A7352D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E24825D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2A9A36D0>]}
[0m18:43:58.999512 [debug] [MainThread]: Flushing usage events
[0m18:43:59.773843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:25.634420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DF9AEDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DF9ADD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DF9AE9D0>]}


============================== 18:46:25.637931 | 66b8f38a-0c83-49c8-be47-3356017b80fa ==============================
[0m18:46:25.637931 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:46:25.639437 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'no_print': 'None', 'invocation_command': 'dbt snapshot --select books_price_snapshot.sql', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m18:46:25.867934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66b8f38a-0c83-49c8-be47-3356017b80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DFA63410>]}
[0m18:46:25.930503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66b8f38a-0c83-49c8-be47-3356017b80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DA62D210>]}
[0m18:46:25.931503 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:46:26.272406 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:46:26.419563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:46:26.419563 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:46:26.420565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:46:26.469588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66b8f38a-0c83-49c8-be47-3356017b80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DFF20910>]}
[0m18:46:26.556643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:46:26.558641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:46:26.635653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66b8f38a-0c83-49c8-be47-3356017b80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E10C3890>]}
[0m18:46:26.635653 [info ] [MainThread]: Found 6 models, 12 data tests, 1 snapshot, 1 source, 463 macros
[0m18:46:26.636650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b8f38a-0c83-49c8-be47-3356017b80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DFD20290>]}
[0m18:46:26.638667 [info ] [MainThread]: 
[0m18:46:26.639654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:46:26.639654 [info ] [MainThread]: 
[0m18:46:26.640652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:46:26.641654 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m18:46:26.730559 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m18:46:26.730559 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m18:46:26.731555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:26.786537 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.055 seconds
[0m18:46:26.787537 [debug] [ThreadPool]: On list_web_scraper: Close
[0m18:46:26.788537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper, now create_web_scraper_snapshots)
[0m18:46:26.788537 [debug] [ThreadPool]: Creating schema "database: "web_scraper"
schema: "snapshots"
"
[0m18:46:26.792724 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_snapshots"
[0m18:46:26.793723 [debug] [ThreadPool]: On create_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "create_web_scraper_snapshots"} */
create schema if not exists "snapshots"
[0m18:46:26.793723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:26.834307 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.040 seconds
[0m18:46:26.835307 [debug] [ThreadPool]: On create_web_scraper_snapshots: COMMIT
[0m18:46:26.835307 [debug] [ThreadPool]: Using postgres connection "create_web_scraper_snapshots"
[0m18:46:26.836312 [debug] [ThreadPool]: On create_web_scraper_snapshots: COMMIT
[0m18:46:26.837816 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m18:46:26.837816 [debug] [ThreadPool]: On create_web_scraper_snapshots: Close
[0m18:46:26.841641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_silver'
[0m18:46:26.846820 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m18:46:26.847827 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m18:46:26.847827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:26.891293 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.043 seconds
[0m18:46:26.892293 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m18:46:26.893274 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m18:46:26.894274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books)
[0m18:46:26.896270 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m18:46:26.896270 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m18:46:26.896270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:26.940412 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.043 seconds
[0m18:46:26.941408 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m18:46:26.942409 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m18:46:26.943413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m18:46:26.944762 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m18:46:26.945776 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:46:26.945776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:26.993380 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.047 seconds
[0m18:46:26.995380 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m18:46:26.996380 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m18:46:26.996380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_gold)
[0m18:46:27.000404 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m18:46:27.000404 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m18:46:27.001452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:27.044471 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.043 seconds
[0m18:46:27.045470 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m18:46:27.045470 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m18:46:27.050875 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:27.050875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:46:27.052066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:27.100300 [debug] [MainThread]: SQL status: SELECT 3 in 0.048 seconds
[0m18:46:27.102300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b8f38a-0c83-49c8-be47-3356017b80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DF8C7B90>]}
[0m18:46:27.102300 [debug] [MainThread]: On master: ROLLBACK
[0m18:46:27.103304 [debug] [MainThread]: On master: COMMIT
[0m18:46:27.103304 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:27.103304 [debug] [MainThread]: On master: COMMIT
[0m18:46:27.104305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:46:27.105300 [debug] [MainThread]: On master: Close
[0m18:46:27.109318 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m18:46:27.109825 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m18:46:27.110832 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m18:46:27.110832 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m18:46:27.117834 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m18:46:27.172609 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:46:27.172609 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    id,
    title,
     price,
    category
from "web_scraper"."public"."books"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m18:46:27.173606 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:46:27.214193 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.041 seconds
[0m18:46:27.217696 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:46:27.217696 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m18:46:27.218704 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m18:46:27.218704 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m18:46:27.219704 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:46:27.220705 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      
  
    

  create  table "web_scraper"."snapshots"."books_price_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
    id,
    title,
     price,
    category
from "web_scraper"."public"."books"

    ) sbq



  );
  
  
[0m18:46:27.238530 [debug] [Thread-1 (]: SQL status: SELECT 1057 in 0.017 seconds
[0m18:46:27.252113 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m18:46:27.253119 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:46:27.253119 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m18:46:27.255348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:46:27.256595 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m18:46:27.257608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b8f38a-0c83-49c8-be47-3356017b80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DFBB6790>]}
[0m18:46:27.259077 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mSELECT 1057[0m in 0.15s]
[0m18:46:27.260092 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m18:46:27.261132 [debug] [MainThread]: On master: COMMIT
[0m18:46:27.261132 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:27.262136 [debug] [MainThread]: On master: COMMIT
[0m18:46:27.262136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:27.301667 [debug] [MainThread]: SQL status: COMMIT in 0.039 seconds
[0m18:46:27.301667 [debug] [MainThread]: On master: Close
[0m18:46:27.302670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:27.302670 [debug] [MainThread]: Connection 'create_web_scraper_snapshots' was properly closed.
[0m18:46:27.303716 [debug] [MainThread]: Connection 'list_web_scraper_books_books_gold' was properly closed.
[0m18:46:27.303716 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m18:46:27.303716 [info ] [MainThread]: 
[0m18:46:27.304711 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m18:46:27.304711 [debug] [MainThread]: Command end result
[0m18:46:27.324888 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:46:27.326885 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:46:27.332415 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m18:46:27.332415 [info ] [MainThread]: 
[0m18:46:27.333412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:27.334414 [info ] [MainThread]: 
[0m18:46:27.335429 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:46:27.336570 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:46:27.336570 after 1.79 seconds
[0m18:46:27.336570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DF9F7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DF9F5C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DF7352D0>]}
[0m18:46:27.337604 [debug] [MainThread]: Flushing usage events
[0m18:46:28.726177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:47:14.092886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C86AEC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C86AEC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C86AF210>]}


============================== 18:47:14.096428 | c1cec3ff-0046-466f-ab66-bdf7209fdc23 ==============================
[0m18:47:14.096428 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:47:14.097432 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot --select books_price_snapshot.sql', 'printer_width': '80', 'target_path': 'None'}
[0m18:47:14.329046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1cec3ff-0046-466f-ab66-bdf7209fdc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C429FAD0>]}
[0m18:47:14.390827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1cec3ff-0046-466f-ab66-bdf7209fdc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C43ED210>]}
[0m18:47:14.392828 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:47:14.746495 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:47:14.898183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:47:14.898183 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:47:14.899183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:47:14.949016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1cec3ff-0046-466f-ab66-bdf7209fdc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C8C18890>]}
[0m18:47:15.037491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:47:15.040502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:47:15.119181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1cec3ff-0046-466f-ab66-bdf7209fdc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C8CE4890>]}
[0m18:47:15.119181 [info ] [MainThread]: Found 6 models, 12 data tests, 1 snapshot, 1 source, 463 macros
[0m18:47:15.120684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cec3ff-0046-466f-ab66-bdf7209fdc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C8E77C90>]}
[0m18:47:15.123252 [info ] [MainThread]: 
[0m18:47:15.124249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:47:15.125252 [info ] [MainThread]: 
[0m18:47:15.126253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:47:15.127262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper'
[0m18:47:15.215679 [debug] [ThreadPool]: Using postgres connection "list_web_scraper"
[0m18:47:15.215679 [debug] [ThreadPool]: On list_web_scraper: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper"} */

    select distinct nspname from pg_namespace
  
[0m18:47:15.216687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:15.266801 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.050 seconds
[0m18:47:15.267800 [debug] [ThreadPool]: On list_web_scraper: Close
[0m18:47:15.273090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_gold'
[0m18:47:15.277098 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m18:47:15.278101 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m18:47:15.278101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:15.324725 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.046 seconds
[0m18:47:15.325725 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m18:47:15.326728 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m18:47:15.327727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_books)
[0m18:47:15.329232 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m18:47:15.329232 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m18:47:15.330744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:15.371808 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.041 seconds
[0m18:47:15.372808 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m18:47:15.373818 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m18:47:15.374809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_snapshots)
[0m18:47:15.376808 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m18:47:15.376808 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:47:15.377808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:15.423886 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m18:47:15.424887 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m18:47:15.425881 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m18:47:15.426884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m18:47:15.428883 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m18:47:15.428883 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m18:47:15.429882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:15.475002 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.045 seconds
[0m18:47:15.476005 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m18:47:15.477002 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m18:47:15.483002 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:15.483002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:47:15.484007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:47:15.531078 [debug] [MainThread]: SQL status: SELECT 3 in 0.047 seconds
[0m18:47:15.533126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cec3ff-0046-466f-ab66-bdf7209fdc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C86EF7D0>]}
[0m18:47:15.533126 [debug] [MainThread]: On master: ROLLBACK
[0m18:47:15.534126 [debug] [MainThread]: On master: COMMIT
[0m18:47:15.535127 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:15.535127 [debug] [MainThread]: On master: COMMIT
[0m18:47:15.536139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:47:15.536139 [debug] [MainThread]: On master: Close
[0m18:47:15.539789 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m18:47:15.540796 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.books_price_snapshot ........................... [RUN]
[0m18:47:15.541795 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_train.books_price_snapshot'
[0m18:47:15.542799 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m18:47:15.548811 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m18:47:15.592979 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.592979 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select price from (
                



select
    id,
    title,
     price,
    category
from "web_scraper"."public"."books"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m18:47:15.594004 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:47:15.630632 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.037 seconds
[0m18:47:15.641826 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.641826 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:47:15.657949 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.015 seconds
[0m18:47:15.664949 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.665948 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:47:15.669028 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m18:47:15.706845 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.706845 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

        
  
    

  create temporary table "books_price_snapshot__dbt_tmp184715700845"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        



select
    id,
    title,
     price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:47:15.719042 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m18:47:15.722561 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.722561 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp184715700845'
        
      order by ordinal_position

  
[0m18:47:15.727559 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m18:47:15.731578 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.732576 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:47:15.735576 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m18:47:15.739086 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.739086 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp184715700845'
        
      order by ordinal_position

  
[0m18:47:15.744137 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m18:47:15.746145 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.747145 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "web_scraper".INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:47:15.750656 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m18:47:15.757056 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.757056 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'books_price_snapshot__dbt_tmp184715700845'
        
      order by ordinal_position

  
[0m18:47:15.760806 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m18:47:15.772075 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.773198 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



select
    id,
    title,
     price,
    category
from "web_scraper"."public"."books"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "web_scraper"."snapshots"."books_price_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."price" != source_data."price"
        or
        (
            ((snapshotted_data."price" is null) and not (source_data."price" is null))
            or
            ((not snapshotted_data."price" is null) and (source_data."price" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m18:47:15.774223 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m18:47:15.777268 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.778269 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m18:47:15.779270 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m18:47:15.779270 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.780779 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.780779 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "snapshot.dbt_train.books_price_snapshot"} */

      update "web_scraper"."snapshots"."books_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "books_price_snapshot__dbt_tmp184715700845" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "web_scraper"."snapshots"."books_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "web_scraper"."snapshots"."books_price_snapshot".dbt_valid_to is null;
      


    insert into "web_scraper"."snapshots"."books_price_snapshot" ("id", "title", "price", "category", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "books_price_snapshot__dbt_tmp184715700845" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:47:15.783785 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.002 seconds
[0m18:47:15.794812 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m18:47:15.794812 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_train.books_price_snapshot"
[0m18:47:15.796318 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: COMMIT
[0m18:47:15.802636 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m18:47:15.806688 [debug] [Thread-1 (]: On snapshot.dbt_train.books_price_snapshot: Close
[0m18:47:15.807700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1cec3ff-0046-466f-ab66-bdf7209fdc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C449D250>]}
[0m18:47:15.809207 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.books_price_snapshot ........................... [[32mINSERT 0 1[0m in 0.26s]
[0m18:47:15.809714 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m18:47:15.810720 [debug] [MainThread]: On master: COMMIT
[0m18:47:15.811919 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:15.811919 [debug] [MainThread]: On master: COMMIT
[0m18:47:15.812920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:47:15.853355 [debug] [MainThread]: SQL status: COMMIT in 0.041 seconds
[0m18:47:15.853355 [debug] [MainThread]: On master: Close
[0m18:47:15.854512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:15.854512 [debug] [MainThread]: Connection 'list_web_scraper' was properly closed.
[0m18:47:15.855513 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m18:47:15.855513 [debug] [MainThread]: Connection 'snapshot.dbt_train.books_price_snapshot' was properly closed.
[0m18:47:15.855513 [info ] [MainThread]: 
[0m18:47:15.856514 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m18:47:15.857517 [debug] [MainThread]: Command end result
[0m18:47:15.876533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:47:15.879039 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:47:15.884555 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m18:47:15.884555 [info ] [MainThread]: 
[0m18:47:15.885555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:47:15.886555 [info ] [MainThread]: 
[0m18:47:15.887555 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:47:15.889557 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:47:15.888554 after 1.88 seconds
[0m18:47:15.889557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C86F5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C86F5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147BFF13D50>]}
[0m18:47:15.890556 [debug] [MainThread]: Flushing usage events
[0m18:47:17.067570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:45.124161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E181AF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E181D0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E181AD950>]}


============================== 18:48:45.127162 | f8c85df2-0e82-4c50-9159-54d2cde4acef ==============================
[0m18:48:45.127162 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:48:45.128164 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select price_should_be_positive.sql', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m18:48:45.362317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8c85df2-0e82-4c50-9159-54d2cde4acef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E18226850>]}
[0m18:48:45.425228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8c85df2-0e82-4c50-9159-54d2cde4acef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E12DDD9D0>]}
[0m18:48:45.426229 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:48:45.776062 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:48:45.926353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:45.927352 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:48:45.927352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:45.978178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8c85df2-0e82-4c50-9159-54d2cde4acef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E18871450>]}
[0m18:48:46.066201 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:48:46.068202 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:48:46.155685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8c85df2-0e82-4c50-9159-54d2cde4acef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1871F490>]}
[0m18:48:46.156682 [info ] [MainThread]: Found 6 models, 12 data tests, 1 snapshot, 1 source, 463 macros
[0m18:48:46.156682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c85df2-0e82-4c50-9159-54d2cde4acef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E184F5DD0>]}
[0m18:48:46.158996 [info ] [MainThread]: 
[0m18:48:46.159997 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:46.159997 [info ] [MainThread]: 
[0m18:48:46.161504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:46.165021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_snapshots'
[0m18:48:46.253842 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m18:48:46.255265 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:48:46.255265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:46.305631 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.049 seconds
[0m18:48:46.305631 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m18:48:46.307063 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m18:48:46.308209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m18:48:46.310201 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m18:48:46.310201 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m18:48:46.311708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:46.355346 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.043 seconds
[0m18:48:46.356350 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m18:48:46.357347 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m18:48:46.358348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books_gold)
[0m18:48:46.360556 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m18:48:46.360556 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m18:48:46.361557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:46.404937 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.044 seconds
[0m18:48:46.406977 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m18:48:46.406977 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m18:48:46.408002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_books)
[0m18:48:46.409979 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m18:48:46.409979 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m18:48:46.411498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:46.455289 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.044 seconds
[0m18:48:46.457293 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m18:48:46.458287 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m18:48:46.463358 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:46.464359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:48:46.464359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:46.511681 [debug] [MainThread]: SQL status: SELECT 3 in 0.046 seconds
[0m18:48:46.513191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c85df2-0e82-4c50-9159-54d2cde4acef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E18A1E6D0>]}
[0m18:48:46.513191 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:46.514201 [debug] [MainThread]: On master: COMMIT
[0m18:48:46.514201 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:46.515197 [debug] [MainThread]: On master: COMMIT
[0m18:48:46.515197 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:46.516197 [debug] [MainThread]: On master: Close
[0m18:48:46.519199 [debug] [Thread-1 (]: Began running node test.dbt_train.price_should_be_positive
[0m18:48:46.520197 [info ] [Thread-1 (]: 1 of 1 START test price_should_be_positive ..................................... [RUN]
[0m18:48:46.520197 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_train.price_should_be_positive'
[0m18:48:46.521706 [debug] [Thread-1 (]: Began compiling node test.dbt_train.price_should_be_positive
[0m18:48:46.528220 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.price_should_be_positive"
[0m18:48:46.529218 [debug] [Thread-1 (]: Began executing node test.dbt_train.price_should_be_positive
[0m18:48:46.543088 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_train.price_should_be_positive"
[0m18:48:46.544544 [debug] [Thread-1 (]: Using postgres connection "test.dbt_train.price_should_be_positive"
[0m18:48:46.545897 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "node_id": "test.dbt_train.price_should_be_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "web_scraper"."books_books_gold"."dim_books"
where price <= 0
  
  
      
    ) dbt_internal_test
[0m18:48:46.545897 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:48:46.589460 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m18:48:46.593274 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: ROLLBACK
[0m18:48:46.594282 [debug] [Thread-1 (]: On test.dbt_train.price_should_be_positive: Close
[0m18:48:46.594282 [info ] [Thread-1 (]: 1 of 1 PASS price_should_be_positive ........................................... [[32mPASS[0m in 0.07s]
[0m18:48:46.595286 [debug] [Thread-1 (]: Finished running node test.dbt_train.price_should_be_positive
[0m18:48:46.596791 [debug] [MainThread]: On master: COMMIT
[0m18:48:46.597836 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:46.597836 [debug] [MainThread]: On master: COMMIT
[0m18:48:46.597836 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:46.637132 [debug] [MainThread]: SQL status: COMMIT in 0.038 seconds
[0m18:48:46.637132 [debug] [MainThread]: On master: Close
[0m18:48:46.638124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:46.638124 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m18:48:46.639394 [debug] [MainThread]: Connection 'test.dbt_train.price_should_be_positive' was properly closed.
[0m18:48:46.639394 [info ] [MainThread]: 
[0m18:48:46.640392 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m18:48:46.640392 [debug] [MainThread]: Command end result
[0m18:48:46.660183 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m18:48:46.664204 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m18:48:46.670207 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m18:48:46.670207 [info ] [MainThread]: 
[0m18:48:46.671717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:46.671717 [info ] [MainThread]: 
[0m18:48:46.673224 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:48:46.674228 [debug] [MainThread]: Command `dbt test` succeeded at 18:48:46.674228 after 1.64 seconds
[0m18:48:46.674228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E16ED52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E16DF8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E11F95D90>]}
[0m18:48:46.675229 [debug] [MainThread]: Flushing usage events
[0m18:48:48.026073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:37.800529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECEBDADE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECEBE26050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECEBE27DD0>]}


============================== 19:10:37.804740 | f16057c0-a8d6-450a-9b65-ba69df871404 ==============================
[0m19:10:37.804740 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:10:37.805128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m19:10:38.077713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f16057c0-a8d6-450a-9b65-ba69df871404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECEBFD5DD0>]}
[0m19:10:38.146568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f16057c0-a8d6-450a-9b65-ba69df871404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE69AD790>]}
[0m19:10:38.148568 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:10:38.532725 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:10:38.705647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:10:38.705647 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:10:38.706624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:10:38.762797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f16057c0-a8d6-450a-9b65-ba69df871404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECEBDADE90>]}
[0m19:10:38.855217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f16057c0-a8d6-450a-9b65-ba69df871404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECEC5E3D90>]}
[0m19:10:38.856218 [info ] [MainThread]: Found 6 models, 12 data tests, 1 snapshot, 1 source, 463 macros
[0m19:10:38.857218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f16057c0-a8d6-450a-9b65-ba69df871404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECEC367D10>]}
[0m19:10:38.859723 [info ] [MainThread]: 
[0m19:10:38.859723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:10:38.860724 [info ] [MainThread]: 
[0m19:10:38.861850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:10:38.865850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m19:10:39.063153 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m19:10:39.064141 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m19:10:39.064141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:39.114487 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.050 seconds
[0m19:10:39.116485 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m19:10:39.117756 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m19:10:39.118946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_silver)
[0m19:10:39.120945 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m19:10:39.120945 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m19:10:39.121946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:39.294407 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.173 seconds
[0m19:10:39.296413 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m19:10:39.297414 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m19:10:39.298411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_books_books_gold)
[0m19:10:39.303136 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m19:10:39.304154 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m19:10:39.304154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:39.374155 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.069 seconds
[0m19:10:39.376134 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m19:10:39.377151 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m19:10:39.378151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_snapshots)
[0m19:10:39.381144 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m19:10:39.382163 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:10:39.383178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:39.452108 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.069 seconds
[0m19:10:39.455168 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m19:10:39.456166 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m19:10:39.464215 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:39.465216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:10:39.466215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:10:39.543364 [debug] [MainThread]: SQL status: SELECT 3 in 0.077 seconds
[0m19:10:39.545609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f16057c0-a8d6-450a-9b65-ba69df871404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECEB73CA10>]}
[0m19:10:39.546601 [debug] [MainThread]: On master: ROLLBACK
[0m19:10:39.547619 [debug] [MainThread]: On master: Close
[0m19:10:39.553867 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m19:10:39.554865 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.my_first_dbt_model'
[0m19:10:39.555865 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m19:10:39.566323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m19:10:39.568810 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m19:10:39.569811 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m19:10:39.570809 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m19:10:39.571811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m19:10:39.572805 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m19:10:39.576839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m19:10:39.577835 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m19:10:39.579320 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m19:10:39.579320 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m19:10:39.580512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now snapshot.dbt_train.books_price_snapshot)
[0m19:10:39.581881 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m19:10:39.586772 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m19:10:39.587796 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m19:10:39.588778 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:10:39.589775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_train.books_price_snapshot, now test.dbt_train.source_not_null_public_books_category.6ec115d14f)
[0m19:10:39.590776 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:10:39.606136 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m19:10:39.608135 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:10:39.609137 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:10:39.610135 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:10:39.610135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_category.6ec115d14f, now test.dbt_train.source_not_null_public_books_id.39867b96d1)
[0m19:10:39.611137 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:10:39.616137 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m19:10:39.618757 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:10:39.619766 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:10:39.619766 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:10:39.621300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_id.39867b96d1, now test.dbt_train.source_not_null_public_books_price.9e3bad0890)
[0m19:10:39.621300 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:10:39.627289 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m19:10:39.628862 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:10:39.628862 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:10:39.630391 [debug] [Thread-1 (]: Began running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:10:39.630391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_price.9e3bad0890, now test.dbt_train.source_unique_public_books_id.dbdeae80c5)
[0m19:10:39.631986 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:10:39.639823 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m19:10:39.642396 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:10:39.642903 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:10:39.644233 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m19:10:39.644233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_unique_public_books_id.dbdeae80c5, now model.dbt_train.my_second_dbt_model)
[0m19:10:39.645803 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m19:10:39.649136 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m19:10:39.650894 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m19:10:39.652432 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m19:10:39.652432 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m19:10:39.653994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m19:10:39.653994 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m19:10:39.658536 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m19:10:39.659549 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m19:10:39.660536 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m19:10:39.661536 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:10:39.662556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5)
[0m19:10:39.663556 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:10:39.675638 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m19:10:39.677638 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:10:39.679133 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:10:39.679133 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:10:39.680360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1)
[0m19:10:39.681360 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:10:39.688376 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m19:10:39.690376 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:10:39.691374 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:10:39.692377 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:10:39.692377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m19:10:39.693377 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:10:39.698376 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m19:10:39.700376 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:10:39.701622 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:10:39.701622 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:10:39.702648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m19:10:39.703648 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:10:39.708648 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m19:10:39.709648 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:10:39.711003 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:10:39.712010 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m19:10:39.713007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_stg_books_book_id.ca28902f83, now model.dbt_train.dim_books_price_history)
[0m19:10:39.713007 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m19:10:39.717008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m19:10:39.718009 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m19:10:39.720009 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m19:10:39.720009 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:10:39.721083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa)
[0m19:10:39.722123 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:10:39.727108 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m19:10:39.728110 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:10:39.729125 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:10:39.730125 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:10:39.731125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa, now test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf)
[0m19:10:39.731125 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:10:39.736124 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m19:10:39.738125 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:10:39.739126 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:10:39.740125 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:10:39.740125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf, now test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7)
[0m19:10:39.741125 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:10:39.745964 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m19:10:39.747960 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:10:39.748965 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:10:39.749965 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m19:10:39.749965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7, now model.dbt_train.fact_books_inventory)
[0m19:10:39.750965 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m19:10:39.755056 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m19:10:39.756057 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m19:10:39.757057 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m19:10:39.758056 [debug] [Thread-1 (]: Began running node test.dbt_train.price_should_be_positive
[0m19:10:39.759054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.fact_books_inventory, now test.dbt_train.price_should_be_positive)
[0m19:10:39.759054 [debug] [Thread-1 (]: Began compiling node test.dbt_train.price_should_be_positive
[0m19:10:39.763125 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.price_should_be_positive"
[0m19:10:39.764126 [debug] [Thread-1 (]: Began executing node test.dbt_train.price_should_be_positive
[0m19:10:39.766122 [debug] [Thread-1 (]: Finished running node test.dbt_train.price_should_be_positive
[0m19:10:39.767133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:39.768584 [debug] [MainThread]: Connection 'list_web_scraper_snapshots' was properly closed.
[0m19:10:39.768584 [debug] [MainThread]: Connection 'test.dbt_train.price_should_be_positive' was properly closed.
[0m19:10:39.771983 [debug] [MainThread]: Command end result
[0m19:10:39.941328 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m19:10:39.946338 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m19:10:39.955635 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m19:10:40.671796 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:10:40.671796 [info ] [MainThread]: Building catalog
[0m19:10:40.686081 [debug] [ThreadPool]: Acquiring new postgres connection 'web_scraper.information_schema'
[0m19:10:40.695837 [debug] [ThreadPool]: Using postgres connection "web_scraper.information_schema"
[0m19:10:40.696875 [debug] [ThreadPool]: On web_scraper.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "web_scraper.information_schema"} */

    
    

    select
        'web_scraper' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('books_books_gold') and
           upper(tbl.relname) = upper('fact_books_inventory')) or (upper(sch.nspname) = upper('books_books_gold') and
           upper(tbl.relname) = upper('dim_books_price_history')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('books_books_silver') and
           upper(tbl.relname) = upper('stg_books')) or (upper(sch.nspname) = upper('books_books_gold') and
           upper(tbl.relname) = upper('dim_books')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('books_price_snapshot')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('books')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_second_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:10:40.696875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:40.813816 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.117 seconds
[0m19:10:40.819870 [debug] [ThreadPool]: On web_scraper.information_schema: ROLLBACK
[0m19:10:40.820870 [debug] [ThreadPool]: On web_scraper.information_schema: Close
[0m19:10:40.837290 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m19:10:40.869528 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m19:10:40.873541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m19:10:40.874530 [info ] [MainThread]: Catalog written to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m19:10:40.876532 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:10:40.876532 after 3.17 seconds
[0m19:10:40.877529 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:10:40.877529 [debug] [MainThread]: Connection 'web_scraper.information_schema' was properly closed.
[0m19:10:40.878877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECEBA580D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE5993F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE9D8E610>]}
[0m19:10:40.879893 [debug] [MainThread]: Flushing usage events
[0m19:10:43.098515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:55.852719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA2F3F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA4026050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA4024FD0>]}


============================== 19:10:55.856261 | 37e5e9ae-fab2-47e6-9861-8dc369c40b62 ==============================
[0m19:10:55.856261 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:10:55.857277 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m19:10:56.117767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37e5e9ae-fab2-47e6-9861-8dc369c40b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA4030150>]}
[0m19:10:56.187970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37e5e9ae-fab2-47e6-9861-8dc369c40b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B9EBCDE90>]}
[0m19:12:32.061223 [error] [MainThread]: Encountered an error:

[0m19:12:32.129581 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:12:32.132511 [debug] [MainThread]: Command `dbt docs serve` failed at 19:12:32.132511 after 96.37 seconds
[0m19:12:32.133511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA2F44250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA211B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA2F3FC90>]}
[0m19:12:32.134609 [debug] [MainThread]: Flushing usage events
[0m19:12:32.845660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:45.194248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDDFACD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDDD35D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDDEC7F50>]}


============================== 19:14:45.199381 | ada1541c-9fac-4908-9687-bbd17b266649 ==============================
[0m19:14:45.199381 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:14:45.200397 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs generate', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m19:14:45.524030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ada1541c-9fac-4908-9687-bbd17b266649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDD1E8710>]}
[0m19:14:45.607765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ada1541c-9fac-4908-9687-bbd17b266649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDF076710>]}
[0m19:14:45.608799 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:14:46.040263 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:14:46.212496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:46.212496 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:14:46.212496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:46.271457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ada1541c-9fac-4908-9687-bbd17b266649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDF603A90>]}
[0m19:14:46.296063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ada1541c-9fac-4908-9687-bbd17b266649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDF7E1110>]}
[0m19:14:46.297064 [info ] [MainThread]: Found 6 models, 12 data tests, 1 snapshot, 1 source, 463 macros
[0m19:14:46.297064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ada1541c-9fac-4908-9687-bbd17b266649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDDFAFBD0>]}
[0m19:14:46.300263 [info ] [MainThread]: 
[0m19:14:46.300263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:46.301560 [info ] [MainThread]: 
[0m19:14:46.301560 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:46.305846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books_books_gold'
[0m19:14:46.473821 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m19:14:46.474830 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m19:14:46.475830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:46.530383 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.055 seconds
[0m19:14:46.532383 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m19:14:46.533889 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m19:14:46.534899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_books_books_silver)
[0m19:14:46.539090 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m19:14:46.539090 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m19:14:46.540142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:46.586687 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.048 seconds
[0m19:14:46.588839 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m19:14:46.588839 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m19:14:46.590347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_silver, now list_web_scraper_snapshots)
[0m19:14:46.592355 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m19:14:46.593860 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:14:46.593860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:46.640213 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.047 seconds
[0m19:14:46.642263 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m19:14:46.643773 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m19:14:46.644133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books)
[0m19:14:46.646460 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m19:14:46.647748 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m19:14:46.647748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:46.697134 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.049 seconds
[0m19:14:46.698682 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m19:14:46.698682 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m19:14:46.704195 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:46.705216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:14:46.705216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:46.753332 [debug] [MainThread]: SQL status: SELECT 3 in 0.048 seconds
[0m19:14:46.755352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ada1541c-9fac-4908-9687-bbd17b266649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDFAFDF90>]}
[0m19:14:46.756349 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:46.756349 [debug] [MainThread]: On master: Close
[0m19:14:46.760598 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m19:14:46.762726 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.my_first_dbt_model'
[0m19:14:46.762726 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m19:14:46.770294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m19:14:46.771389 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m19:14:46.772416 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m19:14:46.772416 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m19:14:46.773922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m19:14:46.773922 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m19:14:46.776933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m19:14:46.778069 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m19:14:46.779143 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m19:14:46.779143 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m19:14:46.780156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now snapshot.dbt_train.books_price_snapshot)
[0m19:14:46.780156 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m19:14:46.783216 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m19:14:46.784236 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m19:14:46.785214 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:14:46.786094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_train.books_price_snapshot, now test.dbt_train.source_not_null_public_books_category.6ec115d14f)
[0m19:14:46.786094 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:14:46.796425 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m19:14:46.797408 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:14:46.798401 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:14:46.799403 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:14:46.799403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_category.6ec115d14f, now test.dbt_train.source_not_null_public_books_id.39867b96d1)
[0m19:14:46.800396 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:14:46.803959 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m19:14:46.804969 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:14:46.804969 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:14:46.806116 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:14:46.806116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_id.39867b96d1, now test.dbt_train.source_not_null_public_books_price.9e3bad0890)
[0m19:14:46.807158 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:14:46.810151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m19:14:46.811177 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:14:46.812157 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:14:46.813153 [debug] [Thread-1 (]: Began running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:14:46.813153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_price.9e3bad0890, now test.dbt_train.source_unique_public_books_id.dbdeae80c5)
[0m19:14:46.813153 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:14:46.819352 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m19:14:46.820363 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:14:46.821393 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:14:46.821393 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m19:14:46.822394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_unique_public_books_id.dbdeae80c5, now model.dbt_train.my_second_dbt_model)
[0m19:14:46.822394 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m19:14:46.825933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m19:14:46.826940 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m19:14:46.827924 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m19:14:46.827924 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m19:14:46.828916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m19:14:46.828916 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m19:14:46.831931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m19:14:46.832930 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m19:14:46.833930 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m19:14:46.833930 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:14:46.834931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5)
[0m19:14:46.834931 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:14:46.842482 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m19:14:46.844013 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:14:46.845398 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:14:46.845398 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:14:46.845398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1)
[0m19:14:46.846648 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:14:46.852205 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m19:14:46.853183 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:14:46.853183 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:14:46.853183 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:14:46.855168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m19:14:46.855168 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:14:46.859380 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m19:14:46.860380 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:14:46.860380 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:14:46.861403 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:14:46.861403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m19:14:46.861403 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:14:46.865162 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m19:14:46.867171 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:14:46.867171 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:14:46.868329 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m19:14:46.868329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_stg_books_book_id.ca28902f83, now model.dbt_train.dim_books_price_history)
[0m19:14:46.869364 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m19:14:46.871450 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m19:14:46.872488 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m19:14:46.872488 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m19:14:46.874000 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:14:46.874000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa)
[0m19:14:46.875291 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:14:46.878391 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m19:14:46.879370 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:14:46.879370 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:14:46.880555 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:14:46.880555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa, now test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf)
[0m19:14:46.882556 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:14:46.885116 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m19:14:46.886116 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:14:46.887277 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:14:46.888272 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:14:46.888272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf, now test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7)
[0m19:14:46.889408 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:14:46.892449 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m19:14:46.892449 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:14:46.893964 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:14:46.893964 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m19:14:46.894968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7, now model.dbt_train.fact_books_inventory)
[0m19:14:46.894968 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m19:14:46.897999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m19:14:46.899183 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m19:14:46.900559 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m19:14:46.900559 [debug] [Thread-1 (]: Began running node test.dbt_train.price_should_be_positive
[0m19:14:46.901573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.fact_books_inventory, now test.dbt_train.price_should_be_positive)
[0m19:14:46.901573 [debug] [Thread-1 (]: Began compiling node test.dbt_train.price_should_be_positive
[0m19:14:46.904184 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.price_should_be_positive"
[0m19:14:46.905201 [debug] [Thread-1 (]: Began executing node test.dbt_train.price_should_be_positive
[0m19:14:46.905201 [debug] [Thread-1 (]: Finished running node test.dbt_train.price_should_be_positive
[0m19:14:46.906510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:46.906510 [debug] [MainThread]: Connection 'list_web_scraper_books' was properly closed.
[0m19:14:46.907873 [debug] [MainThread]: Connection 'test.dbt_train.price_should_be_positive' was properly closed.
[0m19:14:46.910399 [debug] [MainThread]: Command end result
[0m19:14:47.007163 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m19:14:47.010134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m19:14:47.017474 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m19:14:47.019979 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:14:47.020988 [info ] [MainThread]: Building catalog
[0m19:14:47.029224 [debug] [ThreadPool]: Acquiring new postgres connection 'web_scraper.information_schema'
[0m19:14:47.037155 [debug] [ThreadPool]: Using postgres connection "web_scraper.information_schema"
[0m19:14:47.037155 [debug] [ThreadPool]: On web_scraper.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "web_scraper.information_schema"} */

    
    

    select
        'web_scraper' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('books_books_gold') and
           upper(tbl.relname) = upper('fact_books_inventory')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('books_price_snapshot')) or (upper(sch.nspname) = upper('books_books_silver') and
           upper(tbl.relname) = upper('stg_books')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('books')) or (upper(sch.nspname) = upper('books_books_gold') and
           upper(tbl.relname) = upper('dim_books')) or (upper(sch.nspname) = upper('books_books_gold') and
           upper(tbl.relname) = upper('dim_books_price_history')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_second_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:14:47.038154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:47.092734 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.055 seconds
[0m19:14:47.095759 [debug] [ThreadPool]: On web_scraper.information_schema: ROLLBACK
[0m19:14:47.096940 [debug] [ThreadPool]: On web_scraper.information_schema: Close
[0m19:14:47.108714 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m19:14:47.133038 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m19:14:47.136179 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m19:14:47.137186 [info ] [MainThread]: Catalog written to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m19:14:47.139188 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:14:47.138188 after 2.05 seconds
[0m19:14:47.139188 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:14:47.139188 [debug] [MainThread]: Connection 'web_scraper.information_schema' was properly closed.
[0m19:14:47.140188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD9BAA190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD8BD3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDD12CE10>]}
[0m19:14:47.140188 [debug] [MainThread]: Flushing usage events
[0m19:14:47.887261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:15:09.384972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF266AC350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF266ADF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF266ACAD0>]}


============================== 19:15:09.390029 | da26c3da-74b6-4064-a911-2b467bed616c ==============================
[0m19:15:09.390029 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:15:09.390888 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'invocation_command': 'dbt docs serve', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m19:15:09.705721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da26c3da-74b6-4064-a911-2b467bed616c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2692F390>]}
[0m19:15:09.788650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da26c3da-74b6-4064-a911-2b467bed616c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF223EC690>]}
[0m19:17:44.874014 [error] [MainThread]: Encountered an error:

[0m19:17:44.879512 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\amgad\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:17:44.883152 [debug] [MainThread]: Command `dbt docs serve` failed at 19:17:44.883152 after 155.61 seconds
[0m19:17:44.884614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF264352D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF266AFB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF266AFCD0>]}
[0m19:17:44.885123 [debug] [MainThread]: Flushing usage events
[0m19:17:46.287700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:11.867778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192468AC950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192449EFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192468AD310>]}


============================== 19:18:11.873342 | d6b2fe80-5c21-4555-afd4-1d4ebd1bbe7a ==============================
[0m19:18:11.873342 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:18:11.875318 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m19:18:12.190254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b2fe80-5c21-4555-afd4-1d4ebd1bbe7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924697A250>]}
[0m19:18:12.274958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6b2fe80-5c21-4555-afd4-1d4ebd1bbe7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192424EC610>]}
[0m19:18:12.275967 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:18:12.709861 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:18:12.884347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:12.885347 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:18:12.885347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:12.943300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6b2fe80-5c21-4555-afd4-1d4ebd1bbe7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019246B618D0>]}
[0m19:18:12.967272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6b2fe80-5c21-4555-afd4-1d4ebd1bbe7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192480E0F50>]}
[0m19:18:12.968269 [info ] [MainThread]: Found 6 models, 12 data tests, 1 snapshot, 1 source, 463 macros
[0m19:18:12.968269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b2fe80-5c21-4555-afd4-1d4ebd1bbe7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019246FAEF10>]}
[0m19:18:12.971444 [info ] [MainThread]: 
[0m19:18:12.972440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:12.972440 [info ] [MainThread]: 
[0m19:18:12.973446 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:12.977184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_web_scraper_books'
[0m19:18:13.138062 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books"
[0m19:18:13.138062 [debug] [ThreadPool]: On list_web_scraper_books: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books'
  
[0m19:18:13.139568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:13.190877 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.052 seconds
[0m19:18:13.193542 [debug] [ThreadPool]: On list_web_scraper_books: ROLLBACK
[0m19:18:13.193542 [debug] [ThreadPool]: On list_web_scraper_books: Close
[0m19:18:13.194567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books, now list_web_scraper_books_books_gold)
[0m19:18:13.196554 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_gold"
[0m19:18:13.197554 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_gold"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_gold'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_gold'
  
[0m19:18:13.198555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:13.246659 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.049 seconds
[0m19:18:13.248663 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: ROLLBACK
[0m19:18:13.249662 [debug] [ThreadPool]: On list_web_scraper_books_books_gold: Close
[0m19:18:13.249662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_books_books_gold, now list_web_scraper_snapshots)
[0m19:18:13.251662 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_snapshots"
[0m19:18:13.253168 [debug] [ThreadPool]: On list_web_scraper_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_snapshots"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:18:13.253168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:13.299920 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.047 seconds
[0m19:18:13.302208 [debug] [ThreadPool]: On list_web_scraper_snapshots: ROLLBACK
[0m19:18:13.302208 [debug] [ThreadPool]: On list_web_scraper_snapshots: Close
[0m19:18:13.303234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_web_scraper_snapshots, now list_web_scraper_books_books_silver)
[0m19:18:13.305759 [debug] [ThreadPool]: Using postgres connection "list_web_scraper_books_books_silver"
[0m19:18:13.305759 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "list_web_scraper_books_books_silver"} */
select
      'web_scraper' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'books_books_silver'
    union all
    select
      'web_scraper' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'books_books_silver'
  
[0m19:18:13.306891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:13.356031 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.049 seconds
[0m19:18:13.357616 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: ROLLBACK
[0m19:18:13.358147 [debug] [ThreadPool]: On list_web_scraper_books_books_silver: Close
[0m19:18:13.363053 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:13.363583 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:18:13.364498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:13.415472 [debug] [MainThread]: SQL status: SELECT 3 in 0.052 seconds
[0m19:18:13.417999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b2fe80-5c21-4555-afd4-1d4ebd1bbe7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019246978C10>]}
[0m19:18:13.417999 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:13.419510 [debug] [MainThread]: On master: Close
[0m19:18:13.423424 [debug] [Thread-1 (]: Began running node model.dbt_train.my_first_dbt_model
[0m19:18:13.424872 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_train.my_first_dbt_model'
[0m19:18:13.424872 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_first_dbt_model
[0m19:18:13.433386 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_first_dbt_model"
[0m19:18:13.434391 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_first_dbt_model
[0m19:18:13.435393 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_first_dbt_model
[0m19:18:13.435393 [debug] [Thread-1 (]: Began running node model.dbt_train.stg_books
[0m19:18:13.436391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_first_dbt_model, now model.dbt_train.stg_books)
[0m19:18:13.436391 [debug] [Thread-1 (]: Began compiling node model.dbt_train.stg_books
[0m19:18:13.439433 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.stg_books"
[0m19:18:13.440432 [debug] [Thread-1 (]: Began executing node model.dbt_train.stg_books
[0m19:18:13.441433 [debug] [Thread-1 (]: Finished running node model.dbt_train.stg_books
[0m19:18:13.441433 [debug] [Thread-1 (]: Began running node snapshot.dbt_train.books_price_snapshot
[0m19:18:13.442448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.stg_books, now snapshot.dbt_train.books_price_snapshot)
[0m19:18:13.442448 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_train.books_price_snapshot
[0m19:18:13.445784 [debug] [Thread-1 (]: Began executing node snapshot.dbt_train.books_price_snapshot
[0m19:18:13.447291 [debug] [Thread-1 (]: Finished running node snapshot.dbt_train.books_price_snapshot
[0m19:18:13.448305 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:18:13.449315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_train.books_price_snapshot, now test.dbt_train.source_not_null_public_books_category.6ec115d14f)
[0m19:18:13.449315 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:18:13.459439 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_category.6ec115d14f"
[0m19:18:13.461447 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:18:13.461447 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_category.6ec115d14f
[0m19:18:13.462455 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:18:13.462455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_category.6ec115d14f, now test.dbt_train.source_not_null_public_books_id.39867b96d1)
[0m19:18:13.463461 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:18:13.467484 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_id.39867b96d1"
[0m19:18:13.467484 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:18:13.468527 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_id.39867b96d1
[0m19:18:13.468527 [debug] [Thread-1 (]: Began running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:18:13.469842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_id.39867b96d1, now test.dbt_train.source_not_null_public_books_price.9e3bad0890)
[0m19:18:13.469842 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:18:13.474152 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_not_null_public_books_price.9e3bad0890"
[0m19:18:13.475152 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:18:13.476152 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_not_null_public_books_price.9e3bad0890
[0m19:18:13.476152 [debug] [Thread-1 (]: Began running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:18:13.477151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_not_null_public_books_price.9e3bad0890, now test.dbt_train.source_unique_public_books_id.dbdeae80c5)
[0m19:18:13.477151 [debug] [Thread-1 (]: Began compiling node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:18:13.483172 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.source_unique_public_books_id.dbdeae80c5"
[0m19:18:13.484181 [debug] [Thread-1 (]: Began executing node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:18:13.485181 [debug] [Thread-1 (]: Finished running node test.dbt_train.source_unique_public_books_id.dbdeae80c5
[0m19:18:13.485181 [debug] [Thread-1 (]: Began running node model.dbt_train.my_second_dbt_model
[0m19:18:13.486181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.source_unique_public_books_id.dbdeae80c5, now model.dbt_train.my_second_dbt_model)
[0m19:18:13.486181 [debug] [Thread-1 (]: Began compiling node model.dbt_train.my_second_dbt_model
[0m19:18:13.488181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.my_second_dbt_model"
[0m19:18:13.489687 [debug] [Thread-1 (]: Began executing node model.dbt_train.my_second_dbt_model
[0m19:18:13.490697 [debug] [Thread-1 (]: Finished running node model.dbt_train.my_second_dbt_model
[0m19:18:13.491696 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books
[0m19:18:13.491696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.my_second_dbt_model, now model.dbt_train.dim_books)
[0m19:18:13.491696 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books
[0m19:18:13.494210 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books"
[0m19:18:13.495210 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books
[0m19:18:13.496210 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books
[0m19:18:13.496210 [debug] [Thread-1 (]: Began running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:18:13.497716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books, now test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5)
[0m19:18:13.498809 [debug] [Thread-1 (]: Began compiling node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:18:13.507730 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5"
[0m19:18:13.540895 [debug] [Thread-1 (]: Began executing node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:18:13.541895 [debug] [Thread-1 (]: Finished running node test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5
[0m19:18:13.541895 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:18:13.543405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.accepted_values_stg_books_rating__One__Two__Three__Four__Five.063587cbc5, now test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1)
[0m19:18:13.543722 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:18:13.549720 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1"
[0m19:18:13.550721 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:18:13.551723 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1
[0m19:18:13.551723 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:18:13.553228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_available_quantity.19901bcdb1, now test.dbt_train.not_null_stg_books_book_id.7e166e33a6)
[0m19:18:13.553228 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:18:13.557246 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_stg_books_book_id.7e166e33a6"
[0m19:18:13.558248 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:18:13.558248 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_stg_books_book_id.7e166e33a6
[0m19:18:13.559538 [debug] [Thread-1 (]: Began running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:18:13.559538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_stg_books_book_id.7e166e33a6, now test.dbt_train.unique_stg_books_book_id.ca28902f83)
[0m19:18:13.559538 [debug] [Thread-1 (]: Began compiling node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:18:13.563553 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.unique_stg_books_book_id.ca28902f83"
[0m19:18:13.564566 [debug] [Thread-1 (]: Began executing node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:18:13.565567 [debug] [Thread-1 (]: Finished running node test.dbt_train.unique_stg_books_book_id.ca28902f83
[0m19:18:13.566566 [debug] [Thread-1 (]: Began running node model.dbt_train.dim_books_price_history
[0m19:18:13.566566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.unique_stg_books_book_id.ca28902f83, now model.dbt_train.dim_books_price_history)
[0m19:18:13.567566 [debug] [Thread-1 (]: Began compiling node model.dbt_train.dim_books_price_history
[0m19:18:13.569610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.dim_books_price_history"
[0m19:18:13.570619 [debug] [Thread-1 (]: Began executing node model.dbt_train.dim_books_price_history
[0m19:18:13.571623 [debug] [Thread-1 (]: Finished running node model.dbt_train.dim_books_price_history
[0m19:18:13.571623 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:18:13.571623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.dim_books_price_history, now test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa)
[0m19:18:13.573367 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:18:13.576628 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa"
[0m19:18:13.577629 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:18:13.578637 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa
[0m19:18:13.578637 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:18:13.579958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_dbt_valid_from.0d6f85f2aa, now test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf)
[0m19:18:13.579958 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:18:13.583475 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf"
[0m19:18:13.584480 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:18:13.585481 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf
[0m19:18:13.586478 [debug] [Thread-1 (]: Began running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:18:13.586478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_id.b3f1f7a1cf, now test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7)
[0m19:18:13.587478 [debug] [Thread-1 (]: Began compiling node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:18:13.590480 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7"
[0m19:18:13.591480 [debug] [Thread-1 (]: Began executing node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:18:13.592480 [debug] [Thread-1 (]: Finished running node test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7
[0m19:18:13.592480 [debug] [Thread-1 (]: Began running node model.dbt_train.fact_books_inventory
[0m19:18:13.593478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_train.not_null_books_price_snapshot_price.dfb286fcd7, now model.dbt_train.fact_books_inventory)
[0m19:18:13.593478 [debug] [Thread-1 (]: Began compiling node model.dbt_train.fact_books_inventory
[0m19:18:13.596480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_train.fact_books_inventory"
[0m19:18:13.597477 [debug] [Thread-1 (]: Began executing node model.dbt_train.fact_books_inventory
[0m19:18:13.598477 [debug] [Thread-1 (]: Finished running node model.dbt_train.fact_books_inventory
[0m19:18:13.598477 [debug] [Thread-1 (]: Began running node test.dbt_train.price_should_be_positive
[0m19:18:13.598477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_train.fact_books_inventory, now test.dbt_train.price_should_be_positive)
[0m19:18:13.599791 [debug] [Thread-1 (]: Began compiling node test.dbt_train.price_should_be_positive
[0m19:18:13.601791 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_train.price_should_be_positive"
[0m19:18:13.601791 [debug] [Thread-1 (]: Began executing node test.dbt_train.price_should_be_positive
[0m19:18:13.603296 [debug] [Thread-1 (]: Finished running node test.dbt_train.price_should_be_positive
[0m19:18:13.604803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:13.604803 [debug] [MainThread]: Connection 'list_web_scraper_books_books_silver' was properly closed.
[0m19:18:13.605896 [debug] [MainThread]: Connection 'test.dbt_train.price_should_be_positive' was properly closed.
[0m19:18:13.607897 [debug] [MainThread]: Command end result
[0m19:18:13.706580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m19:18:13.709584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m19:18:13.716100 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\run_results.json
[0m19:18:13.718102 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:18:13.719607 [info ] [MainThread]: Building catalog
[0m19:18:13.729761 [debug] [ThreadPool]: Acquiring new postgres connection 'web_scraper.information_schema'
[0m19:18:13.736284 [debug] [ThreadPool]: Using postgres connection "web_scraper.information_schema"
[0m19:18:13.737284 [debug] [ThreadPool]: On web_scraper.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_train", "target_name": "dev", "connection_name": "web_scraper.information_schema"} */

    
    

    select
        'web_scraper' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('books_price_snapshot')) or (upper(sch.nspname) = upper('books_books_silver') and
           upper(tbl.relname) = upper('stg_books')) or (upper(sch.nspname) = upper('books_books_gold') and
           upper(tbl.relname) = upper('dim_books_price_history')) or (upper(sch.nspname) = upper('books_books_gold') and
           upper(tbl.relname) = upper('dim_books')) or (upper(sch.nspname) = upper('books_books_gold') and
           upper(tbl.relname) = upper('fact_books_inventory')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('books')) or (upper(sch.nspname) = upper('books') and
           upper(tbl.relname) = upper('my_second_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:18:13.737284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:13.794742 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.057 seconds
[0m19:18:13.798171 [debug] [ThreadPool]: On web_scraper.information_schema: ROLLBACK
[0m19:18:13.799680 [debug] [ThreadPool]: On web_scraper.information_schema: Close
[0m19:18:13.810353 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m19:18:13.833391 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\manifest.json
[0m19:18:13.836378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\semantic_manifest.json
[0m19:18:13.837377 [info ] [MainThread]: Catalog written to C:\Users\amgad\Desktop\dbt-cyshield\dbt_train\target\catalog.json
[0m19:18:13.838374 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:18:13.838374 after 2.09 seconds
[0m19:18:13.839387 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:18:13.839387 [debug] [MainThread]: Connection 'web_scraper.information_schema' was properly closed.
[0m19:18:13.840377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192406D1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192404F3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192469EE310>]}
[0m19:18:13.840377 [debug] [MainThread]: Flushing usage events
[0m19:18:15.068169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:26.936071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161031AD6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161031F4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016103206310>]}


============================== 19:18:26.941070 | f176f6ca-a358-476f-a14a-6b630d9f1432 ==============================
[0m19:18:26.941070 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:18:26.942072 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt docs serve', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\amgad\\Desktop\\dbt-cyshield\\dbt_train\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amgad\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m19:18:27.260086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f176f6ca-a358-476f-a14a-6b630d9f1432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016103407AD0>]}
[0m19:18:27.344620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f176f6ca-a358-476f-a14a-6b630d9f1432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160FDDFDF90>]}
